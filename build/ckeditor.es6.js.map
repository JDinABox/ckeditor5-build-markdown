{"version":3,"file":"ckeditor.es6.js","sources":["webpack:///ckeditor.es6.js"],"sourcesContent":["var _NumberPOSITIVE_INFINITY=Number.POSITIVE_INFINITY,_Mathfloor=Math.floor,_Mathmax=Math.max,_Mathmin=Math.min;(function(r,s){'object'==typeof exports&&'object'==typeof module?module.exports=s():'function'==typeof define&&define.amd?define([],s):'object'==typeof exports?exports.ClassicEditor=s():r.ClassicEditor=s()})(this,function(){return function(o){function r(d){if(s[d])return s[d].exports;var u=s[d]={i:d,l:!1,exports:{}};return o[d].call(u.exports,u,u.exports,r),u.l=!0,u.exports}var s={};return r.m=o,r.c=s,r.i=function(d){return d},r.d=function(d,u,f){r.o(d,u)||Object.defineProperty(d,u,{configurable:!1,enumerable:!0,get:f})},r.n=function(d){var u=d&&d.__esModule?function(){return d['default']}:function(){return d};return r.d(u,'a',u),u},r.o=function(d,u){return Object.prototype.hasOwnProperty.call(d,u)},r.p='',r(r.s=499)}([function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class d extends Error{constructor(u,f){f&&(u+=' '+JSON.stringify(f)),super(u),this.name='CKEditorError',this.data=f}static isCKEditorError(u){return u instanceof d}}r.a=d},function(o,r,s){'use strict';var d=s(33),u=s(18),f=s(49),h=s(0),w=s(24);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C{constructor(P,T){if(!P.is('element')&&!P.is('documentFragment'))throw new h.a('model-position-root-invalid: Position root invalid.');if(!(T instanceof Array)||0===T.length)throw new h.a('model-position-path-incorrect: Position path must be an Array with at least one item.',{path:T});T=P.getPath().concat(T),P=P.root,this.root=P,this.path=T}get offset(){return s.i(u.a)(this.path)}set offset(P){this.path[this.path.length-1]=P}get parent(){let P=this.root;for(let T=0;T<this.path.length-1;T++)P=P.getChild(P.offsetToIndex(this.path[T]));return P}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){let P=this.parent.getChild(this.index);return P instanceof w.a&&P.startOffset<this.offset?P:null}get nodeAfter(){return null===this.textNode?this.parent.getChild(this.index):null}get nodeBefore(){return null===this.textNode?this.parent.getChild(this.index-1):null}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(P){if(this.root!=P.root)return'different';const T=s.i(f.a)(this.path,P.path);return'same'===T?'same':'prefix'===T?'before':'extension'===T?'after':this.path[T]<P.path[T]?'before':'after'}getLastMatchingPosition(P,T={}){T.startPosition=this;const E=new d.a(T);return E.skip(P),E.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){return this.parent.is('documentFragment')?[this.parent]:this.parent.getAncestors({includeNode:!0})}getCommonPath(P){if(this.root!=P.root)return[];let T=s.i(f.a)(this.path,P.path),E='string'==typeof T?_Mathmin(this.path.length,P.path.length):T;return this.path.slice(0,E)}getShiftedBy(P){let T=C.createFromPosition(this),E=T.offset+P;return T.offset=0>E?0:E,T}isAfter(P){return'after'==this.compareWith(P)}isBefore(P){return'before'==this.compareWith(P)}isEqual(P){return'same'==this.compareWith(P)}isTouching(P){let T=null,E=null,S=this.compareWith(P);switch(S){case'same':return!0;case'before':T=C.createFromPosition(this),E=C.createFromPosition(P);break;case'after':T=C.createFromPosition(P),E=C.createFromPosition(this);break;default:return!1;}for(let O=T.parent;T.path.length+E.path.length;){if(T.isEqual(E))return!0;if(T.path.length>E.path.length){if(T.offset!==O.maxOffset)return!1;T.path=T.path.slice(0,-1),O=O.parent,T.offset++}else{if(0!==E.offset)return!1;E.path=E.path.slice(0,-1)}}}_getTransformedByDeletion(P,T){let E=C.createFromPosition(this);if(this.root!=P.root)return E;if('same'==s.i(f.a)(P.getParentPath(),this.getParentPath())){if(P.offset<this.offset){if(P.offset+T>this.offset)return null;E.offset-=T}}else if('prefix'==s.i(f.a)(P.getParentPath(),this.getParentPath())){const S=P.path.length-1;if(P.offset<=this.path[S]){if(P.offset+T>this.path[S])return null;E.path[S]-=T}}return E}_getTransformedByInsertion(P,T,E){let S=C.createFromPosition(this);if(this.root!=P.root)return S;if('same'==s.i(f.a)(P.getParentPath(),this.getParentPath()))(P.offset<this.offset||P.offset==this.offset&&E)&&(S.offset+=T);else if('prefix'==s.i(f.a)(P.getParentPath(),this.getParentPath())){const O=P.path.length-1;P.offset<=this.path[O]&&(S.path[O]+=T)}return S}_getTransformedByMove(P,T,E,S,O){let V=this._getTransformedByDeletion(P,E);return T=T._getTransformedByDeletion(P,E),V=null===V||O&&V.isEqual(P)?this._getCombined(P,T):V._getTransformedByInsertion(T,E,S),V}_getCombined(P,T){const E=P.path.length-1;let S=C.createFromPosition(T);return S.offset=S.offset+this.path[E]-P.offset,S.path=S.path.concat(this.path.slice(E+1)),S}static createAt(P,T){if(P instanceof C)return this.createFromPosition(P);const E=P;if('end'==T)T=E.maxOffset;else{if('before'==T)return this.createBefore(E);if('after'==T)return this.createAfter(E);T||(T=0)}return this.createFromParentAndOffset(E,T)}static createAfter(P){if(!P.parent)throw new h.a('model-position-after-root: You can not make position after root.',{root:P});return this.createFromParentAndOffset(P.parent,P.endOffset)}static createBefore(P){if(!P.parent)throw new h.a('model-position-before-root: You can not make position before root.',{root:P});return this.createFromParentAndOffset(P.parent,P.startOffset)}static createFromParentAndOffset(P,T){if(!P.is('element')&&!P.is('documentFragment'))throw new h.a('model-position-parent-incorrect: Position parent have to be a element or document fragment.');const E=P.getPath();return E.push(T),new this(P.root,E)}static createFromPosition(P){return new this(P.root,P.path.slice())}static fromJSON(P,T){if('$graveyard'===P.root)return new C(T.graveyard,P.path);if(!T.hasRoot(P.root))throw new h.a('model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.',{rootName:P.root});return new C(T.getRoot(P.root),P.path)}}r.a=C},function(o,r,s){'use strict';var d=s(31),u=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f{constructor(h){this.editor=h}init(){}afterInit(){}destroy(){}}r.a=f,s.i(u.a)(f,d.a)},function(o,r,s){'use strict';var d=s(1),u=s(33),f=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h{constructor(w,C=null){this.start=d.a.createFromPosition(w),this.end=C?d.a.createFromPosition(C):d.a.createFromPosition(w)}*[Symbol.iterator](){yield*new u.a({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}containsPosition(w){return w.isAfter(this.start)&&w.isBefore(this.end)}containsRange(w){return this.containsPosition(w.start)&&this.containsPosition(w.end)}isEqual(w){return this.start.isEqual(w.start)&&this.end.isEqual(w.end)}isIntersecting(w){return this.start.isBefore(w.end)&&this.end.isAfter(w.start)}getDifference(w){const C=[];return this.isIntersecting(w)?(this.containsPosition(w.start)&&C.push(new h(this.start,w.start)),this.containsPosition(w.end)&&C.push(new h(w.end,this.end))):C.push(h.createFromRange(this)),C}getIntersection(w){if(this.isIntersecting(w)){let C=this.start,P=this.end;return this.containsPosition(w.start)&&(C=w.start),this.containsPosition(w.end)&&(P=w.end),new h(C,P)}return null}getMinimalFlatRanges(){const w=[],C=this.start.getCommonPath(this.end).length;let P=d.a.createFromPosition(this.start),T=P.parent;for(;P.path.length>C+1;){let E=T.maxOffset-P.offset;0!=E&&w.push(new h(P,P.getShiftedBy(E))),P.path=P.path.slice(0,-1),P.offset++,T=T.parent}for(;P.path.length<=this.end.path.length;){let E=this.end.path[P.path.length-1],S=E-P.offset;0!=S&&w.push(new h(P,P.getShiftedBy(S))),P.offset=E,P.path.push(0)}return w}getWalker(w={}){return w.boundaries=this,new u.a(w)}*getItems(w={}){w.boundaries=this,w.ignoreElementEnd=!0;const C=new u.a(w);for(let P of C)yield P.item}*getPositions(w={}){w.boundaries=this;const C=new u.a(w);yield C.position;for(let P of C)yield P.nextPosition}getTransformedByDelta(w){let C=[h.createFromRange(this)];const P=new Set(['insert','move','remove','reinsert']);for(let T of w.operations)if(P.has(T.type))for(let E=0;E<C.length;E++){const S=C[E]._getTransformedByDocumentChange(T.type,w.type,T.targetPosition||T.position,T.howMany||T.nodes.maxOffset,T.sourcePosition);C.splice(E,1,...S),E+=S.length-1}return C}getTransformedByDeltas(w){let C=[h.createFromRange(this)];for(let P of w)for(let T=0,E;T<C.length;T++)E=C[T].getTransformedByDelta(P),C.splice(T,1,...E),T+=E.length-1;for(let P=0;P<C.length;P++){const T=C[P];for(let E=P+1;E<C.length;E++){const S=C[E];(T.containsRange(S)||S.containsRange(T)||T.isEqual(S))&&C.splice(E,1)}}return C}_getTransformedByDocumentChange(w,C,P,T,E){if('insert'==w)return this._getTransformedByInsertion(P,T,!1,!1);const S=this._getTransformedByMove(E,P,T);if('move'==w){const O=h.createFromPositionAndShift(E,T);if('split'==C&&this.containsPosition(E))return[new h(S[0].start,S[1].end)];if('merge'==C&&this.isCollapsed&&S[0].start.isEqual(E))return[new h(P.getShiftedBy(this.start.offset))];if('wrap'==C){if(O.containsPosition(this.start)&&this.containsPosition(O.end))return[new h(S[2].start,S[1].end)];if(O.containsPosition(this.end)&&this.containsPosition(O.start))return[new h(S[0].start,S[1].end)]}else if('unwrap'==C){if(O.containsPosition(this.start)&&this.containsPosition(O.end))return[new h(S[1].start,S[0].end)];if(O.containsPosition(this.end)&&this.containsPosition(O.start))return[new h(S[0].start,S[2].end)]}}return S}_getTransformedByInsertion(w,C,P=!1,T=!1){if(P&&this.containsPosition(w))return[new h(this.start,w),new h(w._getTransformedByInsertion(w,C,!0),this.end._getTransformedByInsertion(w,C,this.isCollapsed))];const E=h.createFromRange(this);let S=!!E.isCollapsed||!T,O=!!E.isCollapsed||T;return E.start=E.start._getTransformedByInsertion(w,C,S),E.end=E.end._getTransformedByInsertion(w,C,O),[E]}_getTransformedByMove(w,C,P){if(this.isCollapsed){const F=this.start._getTransformedByMove(w,C,P,!0,!1);return[new h(F)]}let T;const E=new h(w,w.getShiftedBy(P)),S=this.getDifference(E);let O=null;const V=this.getIntersection(E);1==S.length?O=new h(S[0].start._getTransformedByDeletion(w,P),S[0].end._getTransformedByDeletion(w,P)):2==S.length&&(O=new h(this.start,this.end._getTransformedByDeletion(w,P)));const R=C._getTransformedByDeletion(w,P);return T=O?O._getTransformedByInsertion(R,P,null!==V):[],V&&T.push(new h(V.start._getCombined(E.start,R),V.end._getCombined(E.start,R))),T}static createFromPositionAndShift(w,C){const P=w,T=w.getShiftedBy(C);return 0<C?new this(P,T):new this(T,P)}static createFromParentsAndOffsets(w,C,P,T){return new this(d.a.createFromParentAndOffset(w,C),d.a.createFromParentAndOffset(P,T))}static createFromRange(w){return new this(w.start,w.end)}static createIn(w){return this.createFromParentsAndOffsets(w,0,w,w.maxOffset)}static createOn(w){return this.createFromPositionAndShift(d.a.createBefore(w),w.offsetSize)}static createFromRanges(w){if(0===w.length)throw new f.a('range-create-from-ranges-empty-array: At least one range has to be passed.');else if(1==w.length)return this.createFromRange(w[0]);const C=w[0];w.sort((E,S)=>E.start.isAfter(S.start));const P=w.indexOf(C),T=new this(C.start,C.end);for(let E=P-1;0<=E&&w[E].end.isEqual(T.start);E++)T.start=d.a.createFromPosition(w[E].start);for(let E=P+1;E<w.length&&w[E].start.isEqual(T.end);E++)T.end=d.a.createFromPosition(w[E].end);return T}static fromJSON(w,C){return new this(d.a.fromJSON(w.start,C),d.a.fromJSON(w.end,C))}}r.a=h},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u,...f){f.forEach((h)=>{Object.getOwnPropertyNames(h).concat(Object.getOwnPropertySymbols(h)).forEach((w)=>{if(!(w in u.prototype)){const C=Object.getOwnPropertyDescriptor(h,w);C.enumerable=!1,Object.defineProperty(u.prototype,w,C)}})})}},function(o,r,s){'use strict';function d(P){return'string'==typeof P?[new h.a(P)]:(s.i(w.a)(P)||(P=[P]),Array.from(P).map((T)=>'string'==typeof T?new h.a(T):T))}var u=s(56),f=s(67),h=s(24),w=s(41);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends u.a{constructor(P,T,E){super(T),this.name=P,this._children=new f.a,E&&this.insertChildren(0,E)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(P,T=null){return T?'element'==P&&T==this.name:'element'==P||P==this.name}getChild(P){return this._children.getNode(P)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(P){return this._children.getNodeIndex(P)}getChildStartOffset(P){return this._children.getNodeStartOffset(P)}clone(P=!1){const T=P?Array.from(this._children).map((E)=>E.clone()):Array.from(this._children);return new C(this.name,this.getAttributes(),T)}offsetToIndex(P){return this._children.offsetToIndex(P)}appendChildren(P){this.insertChildren(this.childCount,P)}insertChildren(P,T){T=d(T);for(let E of T)E.parent=this;this._children.insertNodes(P,T)}removeChildren(P,T=1){const E=this._children.removeNodes(P,T);for(let S of E)S.parent=null;return E}getNodeByPath(P){let T=this;for(const E of P)T=T.getChild(E);return T}toJSON(){let P=super.toJSON();if(P.name=this.name,0<this._children.length){P.children=[];for(let T of this._children)P.children.push(T.toJSON())}return P}static fromJSON(P){let T=null;if(P.children){T=[];for(let E of P.children)E.name?T.push(C.fromJSON(E)):T.push(h.a.fromJSON(E))}return new C(P.name,P.attributes,T)}}r.a=C},function(o,r,s){'use strict';function d(ie){return!!ie&&((ie.value&&(ie=ie.value),Array.isArray(ie))?ie.some(d):!!(ie instanceof te))}function u(ie,oe){return ie.map((re)=>{return re instanceof te?re.getValue(oe):re})}function f(ie,oe,{node:re}){let se=u(ie,re);se=1==ie.length&&ie[0]instanceof ne?se[0]:se.reduce(F,''),M(se)?oe.remove():oe.set(se)}function h(ie){return{set(oe){ie.textContent=oe},remove(){ie.textContent=''}}}function w(ie,oe,re){return{set(se){ie.setAttributeNS(re,oe,se)},remove(){ie.removeAttributeNS(re,oe)}}}function C(ie,oe){return{set(re){ie.style[oe]=re},remove(){ie.style[oe]=null}}}function P(ie){const oe=s.i(Y.a)(ie,(re)=>{if(re&&(re instanceof te||L(re)||D(re)||q(re)))return re});return oe}function T(ie){if('string'==typeof ie?ie=O(ie):ie.text&&V(ie),ie.on&&(ie.eventListeners=S(ie.on),delete ie.on),!ie.text){ie.attributes&&E(ie.attributes);const oe=new U.a;if(ie.children)if(q(ie.children))oe.add(ie.children);else for(let re of ie.children)L(re)||D(re)?oe.add(re):oe.add(new ee(re));ie.children=oe}return ie}function E(ie){for(let oe in ie)ie[oe].value&&(ie[oe].value=[].concat(ie[oe].value)),R(ie,oe)}function S(ie){for(let oe in ie)R(ie,oe);return ie}function O(ie){return{text:[ie]}}function V(ie){Array.isArray(ie.text)||(ie.text=[ie.text])}function R(ie,oe){Array.isArray(ie[oe])||(ie[oe]=[ie[oe]])}function F(ie,oe){return M(oe)?ie:M(ie)?oe:`${ie} ${oe}`}function N(ie,oe){for(let re in oe)ie[re]?ie[re].push(...oe[re]):ie[re]=oe[re]}function I(ie,oe){if(oe.attributes&&(!ie.attributes&&(ie.attributes={}),N(ie.attributes,oe.attributes)),oe.eventListeners&&(!ie.eventListeners&&(ie.eventListeners={}),N(ie.eventListeners,oe.eventListeners)),oe.text&&ie.text.push(...oe.text),oe.children&&oe.children.length){if(ie.children.length!=oe.children.length)throw new $.a('ui-template-extend-children-mismatch: The number of children in extended definition does not match.');let re=0;for(let se of oe.children)I(ie.children.get(re++),se)}}function M(ie){return!ie&&0!==ie}function D(ie){return ie instanceof J.a}function L(ie){return ie instanceof ee}function q(ie){return ie instanceof G.a}function z(){return{children:[],bindings:[],attributes:{}}}function K(ie){return'class'==ie||'style'==ie}var $=s(0),H=s(4),W=s(7),U=s(76),J=s(9),G=s(116),Y=s(477),X=s(14),Z=s(55);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class ee{constructor(ie){Object.assign(this,T(P(ie))),this._isRendered=!1,this._revertData=null}render(){const ie=this._renderNode({intoFragment:!0});return this._isRendered=!0,ie}apply(ie){return this._revertData=z(),this._renderNode({node:ie,isApplying:!0,revertData:this._revertData}),ie}revert(ie){if(!this._revertData)throw new $.a('ui-template-revert-not-applied: Attempting reverting a template which has not been applied yet.');this._revertTemplateFromNode(ie,this._revertData)}static bind(ie,oe){return{to(re,se){return new ae({eventNameOrFunction:re,attribute:re,observable:ie,emitter:oe,callback:se})},if(re,se,le){return new ne({observable:ie,emitter:oe,attribute:re,valueIfTrue:se,callback:le})}}}static extend(ie,oe){ie._isRendered&&Z.a.warn('template-extend-render: Attempting to extend a template which has already been rendered.'),I(ie,T(P(oe)))}_renderNode(ie){let oe;if(oe=ie.node?this.tag&&this.text:this.tag?this.text:!this.text,oe)throw new $.a('ui-template-wrong-syntax: Node definition must have either \"tag\" or \"text\" when rendering new Node.');return this.text?this._renderText(ie):this._renderElement(ie)}_renderElement(ie){let oe=ie.node;return oe||(oe=ie.node=document.createElementNS(this.ns||'http://www.w3.org/1999/xhtml',this.tag)),this._renderAttributes(ie),this._renderElementChildren(ie),this._setUpListeners(ie),oe}_renderText(ie){let oe=ie.node;return oe?ie.revertData.text=oe.textContent:oe=ie.node=document.createTextNode(''),d(this.text)?this._bindToObservable({schema:this.text,updater:h(oe),data:ie}):oe.textContent=this.text.join(''),oe}_renderAttributes(ie){let oe,re,se,le;if(this.attributes){const de=ie.node,ce=ie.revertData;for(oe in this.attributes)if(se=de.getAttribute(oe),re=this.attributes[oe],ce&&(ce.attributes[oe]=se),le=s.i(X.a)(re[0])&&re[0].ns?re[0].ns:null,d(re)){const ue=le?re[0].value:re;ce&&K(oe)&&ue.unshift(se),this._bindToObservable({schema:ue,updater:w(de,oe,le),data:ie})}else'style'==oe&&'string'!=typeof re[0]?this._renderStyleAttribute(re[0],ie):(ce&&se&&K(oe)&&re.unshift(se),re=re.map((ue)=>ue?ue.value||ue:ue).reduce((ue,me)=>ue.concat(me),[]).reduce(F,''),M(re)||de.setAttributeNS(le,oe,re))}}_renderStyleAttribute(ie,oe){const re=oe.node;for(let se in ie){const le=ie[se];d(le)?this._bindToObservable({schema:[le],updater:C(re,se),data:oe}):re.style[se]=le}}_renderElementChildren(ie){const oe=ie.node,re=ie.intoFragment?document.createDocumentFragment():oe,se=ie.isApplying;let le=0;for(let de of this.children)if(q(de)){if(!se){de.setParent(oe);for(let ce of de)re.appendChild(ce.element)}}else if(D(de))se||re.appendChild(de.element);else if(se){const ce=ie.revertData,ue=z();ce.children.push(ue),de._renderNode({node:re.childNodes[le++],isApplying:!0,revertData:ue})}else re.appendChild(de.render());ie.intoFragment&&oe.appendChild(re)}_setUpListeners(ie){if(this.eventListeners)for(let oe in this.eventListeners){const re=this.eventListeners[oe].map((se)=>{const[le,de]=oe.split('@');return se.activateDomEventListener(le,de,ie)});ie.revertData&&ie.revertData.bindings.push(re)}}_bindToObservable({schema:ie,updater:oe,data:re}){const se=re.revertData;f(ie,oe,re);const le=ie.filter((de)=>!M(de)).filter((de)=>de.observable).map((de)=>de.activateAttributeListener(ie,oe,re));se&&se.bindings.push(le)}_revertTemplateFromNode(ie,oe){for(let re of oe.bindings)for(let se of re)se();if(oe.text)return void(ie.textContent=oe.text);for(let re in oe.attributes){const se=oe.attributes[re];null===se?ie.removeAttribute(re):ie.setAttribute(re,se)}for(let re=0;re<oe.children.length;++re)this._revertTemplateFromNode(ie.childNodes[re],oe.children[re])}}r.a=ee,s.i(H.a)(ee,W.a);class te{constructor(ie){Object.assign(this,ie)}getValue(ie){const oe=this.observable[this.attribute];return this.callback?this.callback(oe,ie):oe}activateAttributeListener(ie,oe,re){const se=()=>f(ie,oe,re);return this.emitter.listenTo(this.observable,'change:'+this.attribute,se),()=>{this.emitter.stopListening(this.observable,'change:'+this.attribute,se)}}}class ae extends te{activateDomEventListener(ie,oe,re){const se=(le,de)=>{(!oe||de.target.matches(oe))&&('function'==typeof this.eventNameOrFunction?this.eventNameOrFunction(de):this.observable.fire(this.eventNameOrFunction,de))};return this.emitter.listenTo(re.node,ie,se),()=>{this.emitter.stopListening(re.node,ie,se)}}}class ne extends te{getValue(ie){const oe=super.getValue(ie);return!M(oe)&&(this.valueIfTrue||!0)}}},function(o,r,s){'use strict';function u(I,M){I[F]||(I[F]=M||s.i(O.a)())}function f(I){return I[F]}function h(I){return I._events||Object.defineProperty(I,'_events',{value:{}}),I._events}function w(){return{callbacks:[],childEvents:[]}}function C(I,M){const D=h(I);if(D[M])return;let L=M,q=null;const z=[];for(;''!==L&&!D[L];)D[L]=w(),z.push(D[L]),q&&D[L].childEvents.push(q),q=L,L=L.substr(0,L.lastIndexOf(':'));if(''!==L){for(let K of z)K.callbacks=D[L].callbacks.slice();D[L].childEvents.push(q)}}function P(I,M){const D=h(I)[M];if(!D)return[];let L=[D.callbacks];for(let q=0,z;q<D.childEvents.length;q++)z=P(I,D.childEvents[q]),L=L.concat(z);return L}function T(I,M){let D;return I._events&&(D=I._events[M])&&D.callbacks.length?D.callbacks:-1<M.indexOf(':')?T(I,M.substr(0,M.lastIndexOf(':'))):null}function E(I,M,D){for(let[L,q]of I){q?'function'==typeof q&&(q=q(M.name)):q=M.name;const z=new S.a(M.source,q);z.path=[...M.path],L.fire(z,...D)}}var S=s(395),O=s(66),V=s(496);r.b=function(I,M){return I[R]&&I[R][M]?I[R][M].emitter:null},r.c=u;/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const R=Symbol('listeningTo'),F=Symbol('emitterId'),N={on(I,M,D={}){C(this,I);const L=P(this,I),q=V.a.get(D.priority);M={callback:M,context:D.context||this,priority:q};for(let z of L){let K=!1;for(let $=0;$<z.length;$++)if(z[$].priority<q){z.splice($,0,M),K=!0;break}K||z.push(M)}},once(I,M,D){this.on(I,function(q){q.off(),M.apply(this,arguments)},D)},off(I,M,D){const L=P(this,I);for(let q of L)for(let z=0;z<q.length;z++)q[z].callback==M&&(D&&D!=q[z].context||(q.splice(z,1),z--))},listenTo(I,M,D,L){let q,z,K,$;this[R]||(this[R]={}),q=this[R],f(I)||u(I),z=f(I),(K=q[z])||(K=q[z]={emitter:I,callbacks:{}}),($=K.callbacks[M])||($=K.callbacks[M]=[]),$.push(D),I.on(M,D,L)},stopListening(I,M,D){let L=this[R],q=I&&f(I),z=L&&q&&L[q],K=z&&M&&z.callbacks[M];if(L&&(!I||z)&&(!M||K))if(D)I.off(M,D);else if(K){for(;D=K.pop();)I.off(M,D);delete z.callbacks[M]}else if(z){for(M in z.callbacks)this.stopListening(I,M);delete L[q]}else{for(q in L)this.stopListening(L[q].emitter);delete this[R]}},fire(I,...M){const D=I instanceof S.a?I:new S.a(this,I),L=D.name;let q=T(this,L);if(D.path.push(this),q){const z=[D,...M];q=Array.from(q);for(let K=0;K<q.length&&(q[K].callback.apply(q[K].context,z),D.off.called&&(delete D.off.called,this.off(L,q[K].callback,q[K].context)),!D.stop.called);K++);}if(this._delegations){const z=this._delegations.get(L),K=this._delegations.get('*');z&&E(z,D,M),K&&E(K,D,M)}},delegate(...I){return{to:(M,D)=>{this._delegations||(this._delegations=new Map);for(let L of I){let q=this._delegations.get(L);q?q.set(M,D):this._delegations.set(L,new Map([[M,D]]))}}}},stopDelegating(I,M){if(this._delegations)if(!I)this._delegations.clear();else if(!M)this._delegations.delete(I);else{const D=this._delegations.get(I);D&&D.delete(M)}}};r.a=N},function(o,r,s){'use strict';var u=s(189),f=s(15),w=_Mathmax;r.a=function(C,P){if('function'!=typeof C)throw new TypeError('Expected a function');return P=w(void 0===P?C.length-1:s.i(f.a)(P),0),function(){for(var T=arguments,E=-1,S=w(T.length-P,0),O=Array(S);++E<S;)O[E]=T[P+E];switch(P){case 0:return C.call(this,O);case 1:return C.call(this,T[0],O);case 2:return C.call(this,T[0],T[1],O);}var V=Array(P+1);for(E=-1;++E<P;)V[E]=T[E];return V[P]=O,s.i(u.a)(C,this,V)}}},function(o,r,s){'use strict';var d=s(0),u=s(116),f=s(6),h=s(77),w=s(31),C=s(76),P=s(4),T=s(41);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class E{constructor(S){this.locale=S,this.t=S&&S.t,this.set('ready',!1),this._viewCollections=new C.a,this._unboundChildren=this.createCollection(),this._viewCollections.on('add',(O,V)=>{V.locale=S})}get element(){return this._element?this._element:this.template?(this._addTemplateChildren(),this._element=this.template.render()):null}set element(S){this._element=S}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=f.a.bind(this,this)}createCollection(){const S=new u.a;return this._viewCollections.add(S),S}addChildren(S){s.i(T.a)(S)||(S=[S]);for(let O of S)this._unboundChildren.add(O)}init(){if(this.ready)throw new d.a('ui-view-init-reinit: This View has already been initialized.');return Promise.resolve().then(()=>{return Promise.all(this._viewCollections.map((S)=>S.init()))}).then(()=>{this.ready=!0})}destroy(){this.stopListening();const S=this._viewCollections.map((O)=>O.destroy());return this._unboundChildren.clear(),this._viewCollections.clear(),this.element=this.template=this.locale=this.t=this._viewCollections=this._unboundChildren=null,Promise.all(S)}_addTemplateChildren(){const S=(O)=>{if(O.children)for(let V of O.children)V instanceof E?this.addChildren(V):S(V)};S(this.template)}}r.a=E,s.i(P.a)(E,h.a),s.i(P.a)(E,w.a)},function(o,r,s){'use strict';var u=s(417),f=s(418),h=s(223),w=s(11),C=s(488);r.a=function(P){return'function'==typeof P?P:null==P?h.a:'object'==typeof P?s.i(w.a)(P)?s.i(f.a)(P[0],P[1]):s.i(u.a)(P):s.i(C.a)(P)}},function(o,r){'use strict';var d=Array.isArray;r.a=d},function(o,r,s){'use strict';function d(w,C){C.isEnabled=!1}var u=s(31),f=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h{constructor(w){this.editor=w,this.set('isEnabled',!0),this._checkEnabled&&this.on('refreshState',(C,P)=>{P.isEnabled=this._checkEnabled()})}destroy(){this.stopListening()}refreshState(){const w={isEnabled:!0};this.fire('refreshState',w),this.isEnabled=w.isEnabled}_execute(w){this.isEnabled&&this._doExecute(w)}_disable(){this.on('refreshState',d),this.refreshState()}_enable(){this.off('refreshState',d),this.refreshState()}_doExecute(){}}r.a=h,s.i(f.a)(h,u.a)},function(o,r,s){'use strict';var u=s(93),f=s(43);r.a=function(h){return s.i(f.a)(h)&&s.i(u.a)(h)}},function(o,r){'use strict';r.a=function(u){var f=typeof u;return!!u&&('object'==f||'function'==f)}},function(o,r,s){'use strict';var u=s(490);r.a=function(f){var h=s.i(u.a)(f),w=h%1;return h===h?w?h-w:h:0}},function(o,r,s){'use strict';var u=s(0);r.b=function(h,w){if(f.prototype[h])throw new u.a('model-batch-register-taken: This batch method name is already taken.',{name:h});f.prototype[h]=w};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f{constructor(h,w='default'){this.document=h,this.deltas=[],this.type=w}get baseVersion(){return 0<this.deltas.length?this.deltas[0].baseVersion:null}addDelta(h){return h.batch=this,this.deltas.push(h),h}*getOperations(){for(let h of this.deltas)yield*h.operations}}r.a=f},function(o,r,s){'use strict';var d=s(0),u=s(307);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const f=new Map;r.a=class{static fromJSON(w,C){if(!f.has(w.__className))throw new d.a('delta-fromjson-no-deserializer: This delta has no defined deserializer',{name:w.__className});let P=f.get(w.__className),T=new P;for(let E of w.operations)T.addOperation(u.a.fromJSON(E,C));return T}static register(w){f.set(w.className,w)}}},function(o,r){'use strict';r.a=function(u){var f=u?u.length:0;return f?u[f-1]:void 0}},function(o,r,s){'use strict';var d=s(92),u=s(17);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f{constructor(){this.batch=null,this.operations=[]}get baseVersion(){return 0<this.operations.length?this.operations[0].baseVersion:null}set baseVersion(h){for(let w of this.operations)w.baseVersion=h++}get _reverseDeltaClass(){return f}addOperation(h){return h.delta=this,this.operations.push(h),h}clone(){let h=new this.constructor;for(let w of this.operations)h.addOperation(w.clone());return h}getReversed(){let h=new this._reverseDeltaClass;for(let w of this.operations)h.addOperation(w.getReversed());h.operations.reverse();for(let w=0;w<h.operations.length;w++)h.operations[w].baseVersion=this.operations[this.operations.length-1].baseVersion+w+1;return h}toJSON(){let h=s.i(d.a)(this);return h.__className=this.constructor.className,delete h.batch,h}static get className(){return'engine.model.delta.Delta'}static get _priority(){return 0}}r.a=f,u.a.register(f)},function(o,r,s){'use strict';function u(D){if(!D.isFlat)throw new I.a('model-writer-remove-range-not-flat: Trying to remove a range that starts and ends in different element.');const L=D.start.parent;T(D.start),T(D.end);const q=L.removeChildren(D.start.index,D.end.index-D.start.index);return P(L,D.start.index),q}function C(D){const L=[];D instanceof Array||(D=[D]);for(let q=0;q<D.length;q++)if('string'==typeof D[q])L.push(new O.a(D[q]));else if(D[q]instanceof V.a)L.push(new O.a(D[q].data,D[q].getAttributes()));else if(D[q]instanceof F.a||D[q]instanceof N.a)for(let z of D[q])L.push(z);else D[q]instanceof S.a&&L.push(D[q]);for(let q=1;q<L.length;q++){const z=L[q],K=L[q-1];z instanceof O.a&&K instanceof O.a&&E(z,K)&&(L.splice(q-1,2,new O.a(K.data+z.data,K.getAttributes())),q--)}return L}function P(D,L){const q=D.getChild(L-1),z=D.getChild(L);if(q&&z&&q.is('text')&&z.is('text')&&E(q,z)){const K=new O.a(q.data+z.data,q.getAttributes());D.removeChildren(L-1,2),D.insertChildren(L-1,K)}}function T(D){const L=D.textNode,q=D.parent;if(L){const z=D.offset-L.startOffset,K=L.index;q.removeChildren(K,1);const $=new O.a(L.data.substr(0,z),L.getAttributes()),H=new O.a(L.data.substr(z),L.getAttributes());q.insertChildren(K,[$,H])}}function E(D,L){const q=D.getAttributes(),z=L.getAttributes();for(let K of q){if(K[1]!==L.getAttribute(K[0]))return!1;z.next()}return z.next().done}var S=s(56),O=s(24),V=s(70),R=s(3),F=s(47),N=s(67),I=s(0);r.c=u,r.b=C;/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a={insert:function(D,L){L=C(L);const q=L.reduce(($,H)=>$+H.offsetSize,0),z=D.parent;T(D);const K=D.index;return z.insertChildren(K,L),P(z,K+L.length),P(z,K),new R.a(D,D.getShiftedBy(q))},remove:u,move:function(D,L){if(!D.isFlat)throw new I.a('model-writer-move-range-not-flat: Trying to move a range that starts and ends in different element.');const q=this.remove(D);return L=L._getTransformedByDeletion(D.start,D.end.offset-D.start.offset),this.insert(L,q)},setAttribute:function(D,L,q){T(D.start),T(D.end);for(let z of D.getItems()){let K=z.is('textProxy')?z.textNode:z;null===q?K.removeAttribute(L):K.setAttribute(L,q),P(K.parent,K.index)}P(D.end.parent,D.end.index)},removeAttribute:function(D,L){this.setAttribute(D,L,null)},normalizeNodes:C}},function(o,r,s){'use strict';function d(O,V){const R=/\\s*([^:;\\s]+)\\s*:\\s*([^;]+)\\s*(?=;|$)/g;let F;for(O.clear();null!==(F=R.exec(V));)O.set(F[1],F[2].trim())}function u(O,V){const R=V.split(/\\s+/);O.clear(),R.forEach((F)=>O.add(F))}function f(O){return'string'==typeof O?[new w.a(O)]:(s.i(P.a)(O)||(O=[O]),Array.from(O).map((V)=>'string'==typeof V?new w.a(V):V))}var h=s(72),w=s(29),C=s(268),P=s(41),T=s(95),E=s(164);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class S extends h.a{constructor(O,V,R){if(super(),this.name=O,this._attrs=s.i(T.a)(V)?s.i(C.a)(V):new Map(V),this._children=[],R&&this.insertChildren(0,R),this._classes=new Set,this._attrs.has('class')){const F=this._attrs.get('class');u(this._classes,F),this._attrs.delete('class')}this._styles=new Map,this._attrs.has('style')&&(d(this._styles,this._attrs.get('style')),this._attrs.delete('style')),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(O,V=null){return V?'element'==O&&V==this.name:'element'==O||O==this.name}clone(O){const V=[];if(O)for(let F of this.getChildren())V.push(F.clone(O));const R=new this.constructor(this.name,this._attrs,V);return R._classes=new Set(this._classes),R._styles=new Map(this._styles),R._customProperties=new Map(this._customProperties),R.getFillerOffset=this.getFillerOffset,R}appendChildren(O){return this.insertChildren(this.childCount,O)}getChild(O){return this._children[O]}getChildIndex(O){return this._children.indexOf(O)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){0<this._classes.size&&(yield'class'),0<this._styles.size&&(yield'style');for(let O of this._attrs.keys())yield O}*getAttributes(){yield*this._attrs.entries(),0<this._classes.size&&(yield['class',this.getAttribute('class')]),0<this._styles.size&&(yield['style',this.getAttribute('style')])}getAttribute(O){if('class'==O)return 0<this._classes.size?[...this._classes].join(' '):void 0;if('style'==O){if(0<this._styles.size){let V='';for(let[R,F]of this._styles)V+=`${R}:${F};`;return V}return}return this._attrs.get(O)}hasAttribute(O){return'class'==O?0<this._classes.size:'style'==O?0<this._styles.size:this._attrs.has(O)}setAttribute(O,V){this._fireChange('attributes',this),'class'==O?u(this._classes,V):'style'==O?d(this._styles,V):this._attrs.set(O,V)}insertChildren(O,V){this._fireChange('children',this);let R=0;V=f(V);for(let F of V)F.parent=this,this._children.splice(O,0,F),O++,R++;return R}removeAttribute(O){return this._fireChange('attributes',this),'class'==O?!!(0<this._classes.size)&&(this._classes.clear(),!0):'style'==O?!!(0<this._styles.size)&&(this._styles.clear(),!0):this._attrs.delete(O)}removeChildren(O,V=1){this._fireChange('children',this);for(let R=O;R<O+V;R++)this._children[R].parent=null;return this._children.splice(O,V)}isSimilar(O){if(!(O instanceof S))return!1;if(this===O)return!0;if(this.name!=O.name)return!1;if(this._attrs.size!==O._attrs.size||this._classes.size!==O._classes.size||this._styles.size!==O._styles.size)return!1;for(let[V,R]of this._attrs)if(!O._attrs.has(V)||O._attrs.get(V)!==R)return!1;for(let V of this._classes)if(!O._classes.has(V))return!1;for(let[V,R]of this._styles)if(!O._styles.has(V)||O._styles.get(V)!==R)return!1;return!0}addClass(...O){this._fireChange('attributes',this),O.forEach((V)=>this._classes.add(V))}removeClass(...O){this._fireChange('attributes',this),O.forEach((V)=>this._classes.delete(V))}hasClass(...O){for(let V of O)if(!this._classes.has(V))return!1;return!0}getClassNames(){return this._classes.keys()}setStyle(O,V){if(this._fireChange('attributes',this),s.i(T.a)(O)){const R=Object.keys(O);for(let F of R)this._styles.set(F,O[F])}else this._styles.set(O,V)}getStyle(O){return this._styles.get(O)}getStyleNames(){return this._styles.keys()}hasStyle(...O){for(let V of O)if(!this._styles.has(V))return!1;return!0}removeStyle(...O){this._fireChange('attributes',this),O.forEach((V)=>this._styles.delete(V))}findAncestor(...O){const V=new E.a(...O);for(let R=this.parent;R;){if(V.match(R))return R;R=R.parent}return null}setCustomProperty(O,V){this._customProperties.set(O,V)}getCustomProperty(O){return this._customProperties.get(O)}removeCustomProperty(O){return this._customProperties.delete(O)}*getCustomProperties(){yield*this._customProperties.entries()}}r.a=S},function(o,r,s){'use strict';function d(E){let S;if('string'!=typeof E)S=E.keyCode+(E.altKey?T.alt:0)+(E.ctrlKey?T.ctrl:0)+(E.shiftKey?T.shift:0);else if(S=T[E.toLowerCase()],!S)throw new C.a('keyboard-unknown-key: Unknown key name.',{key:E});return S}function w(E){return E.split(/\\s*\\+\\s*/)}var C=s(0),P=s(394);r.c=d,r.a=function(E){return'string'==typeof E&&(E=w(E)),E.map((S)=>'string'==typeof S?d(S):S).reduce((S,O)=>O+S,0)},r.b=function(E){const S=w(E);return P.a.mac&&'ctrl'==S[0].toLowerCase()?'\\u2318'+(S[1]||''):E};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const T=function(){const E={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let S=65;90>=S;S++){const O=String.fromCharCode(S);E[O.toLowerCase()]=S}for(let S=48;57>=S;S++)E[S-48]=S;for(let S=112;123>=S;S++)E['f'+(S-111)]=S;return E}();r.d=T},function(o,r,s){'use strict';function d(h,w,C,P,T){var E=-1,S=h.length;for(C||(C=f.a),T||(T=[]);++E<S;){var O=h[E];0<w&&C(O)?1<w?d(O,w-1,C,P,T):s.i(u.a)(T,O):!P&&(T[T.length]=O)}return T}var u=s(81),f=s(451);r.a=d},function(o,r,s){'use strict';var d=s(56);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{constructor(f,h){super(h),this.data=f||''}get offsetSize(){return this.data.length}is(f){return'text'==f}clone(){return new u(this.data,this.getAttributes())}toJSON(){let f=super.toJSON();return f.data=this.data,f}static fromJSON(f){return new u(f.data,f.attributes)}}r.a=u},function(o,r,s){'use strict';var d=s(74),u=s(49),f=s(0),h=s(71);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w{constructor(C,P){this.parent=C,this.offset=P}get nodeAfter(){return this.parent.is('text')?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is('text')?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const C=this.parent.is('text')?this.parent.data.length:this.parent.childCount;return this.offset===C}get root(){return this.parent.root}get editableElement(){let C=this.parent;for(;!(C instanceof h.a);)if(C.parent)C=C.parent;else return null;return C}getShiftedBy(C){let P=w.createFromPosition(this),T=P.offset+C;return P.offset=0>T?0:T,P}getLastMatchingPosition(C,P={}){P.startPosition=this;const T=new d.a(P);return T.skip(C),T.position}getAncestors(){return this.parent.is('documentFragment')?[this.parent]:this.parent.getAncestors({includeNode:!0})}isEqual(C){return this.parent==C.parent&&this.offset==C.offset}isBefore(C){return'before'==this.compareWith(C)}isAfter(C){return'after'==this.compareWith(C)}compareWith(C){if(this.isEqual(C))return'same';if(this.parent===C.parent)return 0>this.offset-C.offset?'before':'after';const P=this.getAncestors(),T=C.getAncestors(),E=s.i(u.a)(P,T);let S;switch(E){case 0:return'different';case'prefix':S=P.length-1;break;case'extension':S=T.length-1;break;default:S=E-1;}const O=P[S],V=P[S+1],R=T[S+1];if(O===this.parent){const N=this.offset-R.index;return 0>=N?'before':'after'}if(O===C.parent){const N=V.index-C.offset;return 0>N?'before':'after'}const F=V.index-R.index;return 0>F?'before':'after'}static createAt(C,P){if(C instanceof w)return this.createFromPosition(C);let T=C;if('end'==P)P=T.is('text')?T.data.length:T.childCount;else{if('before'==P)return this.createBefore(T);if('after'==P)return this.createAfter(T);P||(P=0)}return new w(T,P)}static createAfter(C){if(C.is('textProxy'))return new w(C.textNode,C.offsetInText+C.data.length);if(!C.parent)throw new f.a('view-position-after-root: You can not make position after root.',{root:C});return new w(C.parent,C.index+1)}static createBefore(C){if(C.is('textProxy'))return new w(C.textNode,C.offsetInText);if(!C.parent)throw new f.a('view-position-before-root: You can not make position before root.',{root:C});return new w(C.parent,C.index)}static createFromPosition(C){return new this(C.parent,C.offset)}}r.a=w},function(o,r,s){'use strict';var d=s(9),u=s(6),f=s(369),h=s(22);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends d.a{constructor(C){super(C),this.set('label'),this.set('keystroke'),this.set('tooltip'),this.set('type','button'),this.set('isOn',!1),this.set('isEnabled',!0),this.set('withText',!1),this.set('icon'),this.set('tabindex',-1),this.bind('_tooltipString').to(this,'tooltip',this,'label',this,'keystroke',this._getTooltipString.bind(this));const P=this.bindTemplate;this.template=new u.a({tag:'button',attributes:{class:['ck-button',P.if('_tooltipString','ck-tooltip_s'),P.to('isEnabled',(T)=>T?'ck-enabled':'ck-disabled'),P.to('isOn',(T)=>T?'ck-on':'ck-off'),P.if('withText','ck-button_with-text')],type:P.to('type',(T)=>T?T:'button'),'data-ck-tooltip':[P.to('_tooltipString')],tabindex:P.to('tabindex')},children:[{tag:'span',attributes:{class:['ck-button__label']},children:[{text:P.to('label')}]}],on:{mousedown:P.to((T)=>{T.preventDefault()}),click:P.to((T)=>{this.isEnabled?this.fire('execute'):T.preventDefault()})}})}init(){let C=Promise.resolve();if(this.icon&&!this.iconView){const P=this.iconView=new f.a;P.bind('content').to(this,'icon'),this.element.insertBefore(P.element,this.element.firstChild),C=C.then(()=>this.addChildren(P))}return C.then(()=>super.init())}focus(){this.element.focus()}_getTooltipString(C,P,T){if(C){if('string'==typeof C)return C;if(T&&(T=s.i(h.b)(T)),C instanceof Function)return C(P,T);if(!0===C)return`${P}${T?` (${T})`:''}`}return!1}}r.a=w},function(o,r){'use strict';r.a=function(u,f){for(var h=-1,w=u.length,C=Array(w);++h<w;)C[h]=f(u[h],h,u);return C}},function(o,r,s){'use strict';var d=s(32),u=s(1),f=s(3),h=s(0),w=s(49),C=s(20);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P extends d.a{constructor(T,E,S,O){super(O),this.sourcePosition=u.a.createFromPosition(T),this.howMany=E,this.targetPosition=u.a.createFromPosition(S),this.isSticky=!1}get type(){return'move'}clone(){const T=new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion);return T.isSticky=this.isSticky,T}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){let T=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);const E=new this.constructor(this.getMovedRangeStart(),this.howMany,T,this.baseVersion+1);return E.isSticky=this.isSticky,E}_execute(){let T=this.sourcePosition.parent,E=this.targetPosition.parent,S=this.sourcePosition.offset,O=this.targetPosition.offset;if(!T||!E)throw new h.a('move-operation-position-invalid: Source position or target position is invalid.');else if(S+this.howMany>T.maxOffset)throw new h.a('move-operation-nodes-do-not-exist: The nodes which should be moved do not exist.');else if(T===E&&S<O&&O<S+this.howMany)throw new h.a('move-operation-range-into-itself: Trying to move a range of nodes to the inside of that range.');else if(this.sourcePosition.root==this.targetPosition.root&&'prefix'==s.i(w.a)(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){let R=this.sourcePosition.path.length-1;if(this.targetPosition.path[R]>=S&&this.targetPosition.path[R]<S+this.howMany)throw new h.a('move-operation-node-into-itself: Trying to move a range of nodes into one of nodes from that range.')}const V=C.a.move(f.a.createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition);return{sourcePosition:this.sourcePosition,range:V}}static get className(){return'engine.model.operation.MoveOperation'}static fromJSON(T,E){let S=u.a.fromJSON(T.sourcePosition,E),O=u.a.fromJSON(T.targetPosition,E);const V=new this(S,T.howMany,O,T.baseVersion);return T.isSticky&&(V.isSticky=!0),V}}r.a=P},function(o,r,s){'use strict';var d=s(72);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{constructor(f){super(),this._data=f}clone(){return new u(this.data)}is(f){return'text'==f}get data(){return this._data}set data(f){this._fireChange('text',this),this._data=f}isSimilar(f){return!!(f instanceof u)&&(this===f||this.data===f.data)}}r.a=u},function(o,r,s){'use strict';(function(d,u){var f=s(424),h={'function':!0,object:!0},w=h[typeof exports]&&exports&&!exports.nodeType?exports:void 0,C=h[typeof d]&&d&&!d.nodeType?d:void 0,P=s.i(f.a)(w&&C&&'object'==typeof u&&u),T=s.i(f.a)(h[typeof self]&&self),E=s.i(f.a)(h[typeof window]&&window),S=s.i(f.a)(h[typeof this]&&this),O=P||E!==(S&&S.window)&&E||T||S||Function('return this')();r.a=O}).call(r,s(149)(o),s(272))},function(o,r,s){'use strict';function d(M){R in M||(Object.defineProperty(M,R,{value:new Map}),Object.defineProperty(M,F,{value:new Map}),Object.defineProperty(M,N,{value:new Map}))}function u(...M){const D=h(...M),L=Array.from(this._bindings.keys()),q=L.length;if(!D.callback&&1<D.to.length)throw new S.a('observable-bind-to-no-callback: Binding multiple observables only possible with callback.');if(1<q&&D.callback)throw new S.a('observable-bind-to-extra-callback: Cannot bind multiple attributes and use a callback in one binding.');D.to.forEach((z)=>{if(z.attrs.length&&z.attrs.length!==q)throw new S.a('observable-bind-to-attrs-length: The number of attributes must match.');z.attrs.length||(z.attrs=this._bindAttrs)}),this._to=D.to,D.callback&&(this._bindings.get(L[0]).callback=D.callback),T(this._observable,this._to),C(this),this._bindAttrs.forEach((z)=>{P(this._observable,z)})}function f(M){return M.every((D)=>'string'==typeof D)}function h(...M){if(!M.length)throw new S.a('observable-bind-to-parse-error: Invalid argument syntax in `to()`.');const D={to:[]};let L;return'function'==typeof M[M.length-1]&&(D.callback=M.pop()),M.forEach((q)=>{if('string'==typeof q)L.attrs.push(q);else if('object'==typeof q)L={observable:q,attrs:[]},D.to.push(L);else throw new S.a('observable-bind-to-parse-error: Invalid argument syntax in `to()`.')}),D}function w(M,D,L,q){const z=M[F],K=z.get(L),$=K||{};$[q]||($[q]=new Set),$[q].add(D),K||z.set(L,$)}function C(M){let D;M._bindings.forEach((L,q)=>{M._to.forEach((z)=>{D=z.attrs[L.callback?0:M._bindAttrs.indexOf(q)],L.to.push([z.observable,D]),w(M._observable,L,z.observable,D)})})}function P(M,D){const L=M[N],q=L.get(D);let z;q.callback?z=q.callback.apply(M,q.to.map((K)=>K[0][K[1]])):(z=q.to[0],z=z[0][z[1]]),M.hasOwnProperty(D)?M[D]=z:M.set(D,z)}function T(M,D){D.forEach((L)=>{const q=M[F];let z;q.get(L.observable)||M.listenTo(L.observable,'change',(K,$)=>{z=q.get(L.observable)[$],z&&z.forEach((H)=>{P(M,H.attr)})})})}var E=s(7),S=s(0),O=s(54),V=s(14);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const R=Symbol('attributes'),F=Symbol('boundObservables'),N=Symbol('boundAttributes'),I={set(M,D){if(s.i(V.a)(M))return void Object.keys(M).forEach((q)=>{this.set(q,M[q])},this);d(this);const L=this[R];if(M in this&&!L.has(M))throw new S.a('observable-set-cannot-override: Cannot override an existing property.');Object.defineProperty(this,M,{enumerable:!0,configurable:!0,get(){return L.get(M)},set(q){const z=L.get(M);z===q&&L.has(M)||(L.set(M,q),this.fire('change:'+M,M,q,z))}}),this[M]=D},bind(...M){if(!M.length||!f(M))throw new S.a('observable-bind-wrong-attrs: All attributes must be strings.');if(new Set(M).size!==M.length)throw new S.a('observable-bind-duplicate-attrs: Attributes must be unique.');d(this);const D=this[N];M.forEach((q)=>{if(D.has(q))throw new S.a('observable-bind-rebind: Cannot bind the same attribute more that once.')});const L=new Map;return M.forEach((q)=>{const z={attr:q,to:[]};D.set(q,z),L.set(q,z)}),{to:u,_observable:this,_bindAttrs:M,_to:[],_bindings:L}},unbind(...M){if(!(R in this))return;const D=this[N],L=this[F];if(M.length){if(!f(M))throw new S.a('observable-unbind-wrong-attrs: Attributes must be strings.');M.forEach((q)=>{const z=D.get(q);let K,$,H,W;z.to.forEach((U)=>{K=U[0],$=U[1],H=L.get(K),W=H[$],W.delete(z),W.size||delete H[$],Object.keys(H).length||(L.delete(K),this.stopListening(K,'change'))}),D.delete(q)})}else L.forEach((q,z)=>{this.stopListening(z,'change')}),L.clear(),D.clear()}};r.a=I,s.i(O.a)(I,E.a)},function(o,r,s){'use strict';var d=s(92);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u{constructor(f){this.baseVersion=f}toJSON(){const f=s.i(d.a)(this,!0);return f.__className=this.constructor.className,delete f.delta,f}static get className(){return'engine.model.operation.Operation'}static fromJSON(f){return new this(f.baseVersion)}}r.a=u},function(o,r,s){'use strict';function d(T,E,S,O,V){return{done:!1,value:{type:T,item:E,previousPosition:S,nextPosition:O,length:V}}}var u=s(24),f=s(70),h=s(5),w=s(1),C=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P{constructor(T={}){if(!T.boundaries&&!T.startPosition)throw new C.a('model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.');const E=T.direction||'forward';if('forward'!=E&&'backward'!=E)throw new C.a('model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.',{direction:E});this.direction=E,this.boundaries=T.boundaries||null,this.position=T.startPosition?w.a.createFromPosition(T.startPosition):w.a.createFromPosition(this.boundaries['backward'==this.direction?'end':'start']),this.singleCharacters=!!T.singleCharacters,this.shallow=!!T.shallow,this.ignoreElementEnd=!!T.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(T){let E,S,O,V;do O=this.position,V=this._visitedParent,({done:E,value:S}=this.next());while(!E&&T(S));E||(this.position=O,this._visitedParent=V)}next(){return'forward'==this.direction?this._next():this._previous()}_next(){const T=this.position,E=w.a.createFromPosition(this.position),S=this._visitedParent;if(null===S.parent&&E.offset===S.maxOffset)return{done:!0};if(S===this._boundaryEndParent&&E.offset==this.boundaries.end.offset)return{done:!0};const O=E.textNode?E.textNode:E.nodeAfter;if(O instanceof h.a)return this.shallow?E.offset++:(E.path.push(0),this._visitedParent=O),this.position=E,d('elementStart',O,T,E,1);if(O instanceof u.a){let V,R;if(this.singleCharacters)V=1;else{let N=O.endOffset;this._boundaryEndParent==S&&this.boundaries.end.offset<N&&(N=this.boundaries.end.offset),V=N-E.offset}R=E.offset-O.startOffset;const F=new f.a(O,R,V);return E.offset+=V,this.position=E,d('text',F,T,E,V)}return E.path.pop(),E.offset++,this.position=E,this._visitedParent=S.parent,this.ignoreElementEnd?this._next():d('elementEnd',S,T,E)}_previous(){const T=this.position,E=w.a.createFromPosition(this.position),S=this._visitedParent;if(null===S.parent&&0===E.offset)return{done:!0};if(S==this._boundaryStartParent&&E.offset==this.boundaries.start.offset)return{done:!0};const O=E.textNode?E.textNode:E.nodeBefore;if(O instanceof h.a)return E.offset--,this.shallow?(this.position=E,d('elementStart',O,T,E,1)):(E.path.push(O.maxOffset),this.position=E,this._visitedParent=O,this.ignoreElementEnd?this._previous():d('elementEnd',O,T,E));if(O instanceof u.a){let V,R;if(this.singleCharacters)V=1;else{let N=O.startOffset;this._boundaryStartParent==S&&this.boundaries.start.offset>N&&(N=this.boundaries.start.offset),V=E.offset-N}R=E.offset-O.startOffset;const F=new f.a(O,R-V,V);return E.offset-=V,this.position=E,d('text',F,T,E,V)}return E.path.pop(),this.position=E,this._visitedParent=S.parent,d('elementStart',S,T,E,1)}}r.a=P},function(o,r,s){'use strict';function d(w){return w.item.is('attributeElement')||w.item.is('uiElement')}var u=s(25),f=s(74);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h{constructor(w,C=null){this.start=u.a.createFromPosition(w),this.end=C?u.a.createFromPosition(C):u.a.createFromPosition(w)}*[Symbol.iterator](){yield*new f.a({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let w=this.start.getLastMatchingPosition(d,{direction:'backward'}),C=this.end.getLastMatchingPosition(d);return w.parent.is('text')&&w.isAtStart&&(w=u.a.createBefore(w.parent)),C.parent.is('text')&&C.isAtEnd&&(C=u.a.createAfter(C.parent)),new h(w,C)}getTrimmed(){let w=this.start.getLastMatchingPosition(d),C=this.end.getLastMatchingPosition(d,{direction:'backward'}),P=w.nodeAfter,T=C.nodeBefore;return P&&P.is('text')&&(w=new u.a(P,0)),T&&T.is('text')&&(C=new u.a(T,T.data.length)),new h(w,C)}isEqual(w){return this==w||this.start.isEqual(w.start)&&this.end.isEqual(w.end)}containsPosition(w){return w.isAfter(this.start)&&w.isBefore(this.end)}containsRange(w){return this.containsPosition(w.start)&&this.containsPosition(w.end)}getDifference(w){const C=[];return this.isIntersecting(w)?(this.containsPosition(w.start)&&C.push(new h(this.start,w.start)),this.containsPosition(w.end)&&C.push(new h(w.end,this.end))):C.push(h.createFromRange(this)),C}getIntersection(w){if(this.isIntersecting(w)){let C=this.start,P=this.end;return this.containsPosition(w.start)&&(C=w.start),this.containsPosition(w.end)&&(P=w.end),new h(C,P)}return null}getWalker(w={}){return w.boundaries=this,new f.a(w)}*getItems(w={}){w.boundaries=this,w.ignoreElementEnd=!0;const C=new f.a(w);for(let P of C)yield P.item}*getPositions(w={}){w.boundaries=this;const C=new f.a(w);yield C.position;for(let P of C)yield P.nextPosition}isIntersecting(w){return this.start.isBefore(w.end)&&this.end.isAfter(w.start)}static createFromParentsAndOffsets(w,C,P,T){return new this(new u.a(w,C),new u.a(P,T))}static createFromRange(w){return new this(w.start,w.end)}static createFromPositionAndShift(w,C){const P=w,T=w.getShiftedBy(C);return 0<C?new this(P,T):new this(T,P)}static createIn(w){return this.createFromParentsAndOffsets(w,0,w,w.childCount)}static createOn(w){return this.createFromPositionAndShift(u.a.createBefore(w),1)}}r.a=h},function(o,r){'use strict';r.a=function(u,f,h){var w=-1,C=u.length;0>f&&(f=-f>C?0:C+f),h=h>C?C:h,0>h&&(h+=C),C=f>h?0:h-f>>>0,f>>>=0;for(var P=Array(C);++w<C;)P[w]=u[w+f];return P}},function(o,r){'use strict';var f=/^(?:0|[1-9]\\d*)$/;r.a=function(h,w){return w=null==w?9007199254740991:w,!!w&&('number'==typeof h||f.test(h))&&-1<h&&0==h%1&&h<w}},function(o,r,s){'use strict';var d=s(32),u=s(1),f=s(67),h=s(38),w=s(20),C=s(24),P=s(5);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class T extends d.a{constructor(E,S,O){super(O),this.position=u.a.createFromPosition(E),this.nodes=new f.a(s.i(w.b)(S))}get type(){return'insert'}clone(){const E=new f.a([...this.nodes].map((S)=>S.clone(!0)));return new T(this.position,E,this.baseVersion)}getReversed(){return new h.a(this.position,this.nodes.maxOffset,this.baseVersion+1)}_execute(){const E=this.nodes;this.nodes=new f.a([...E].map((O)=>O.clone(!0)));const S=w.a.insert(this.position,E);return{range:S}}static get className(){return'engine.model.operation.InsertOperation'}static fromJSON(E,S){let O=[];for(let V of E.nodes)V.name?O.push(P.a.fromJSON(V)):O.push(C.a.fromJSON(V));return new T(u.a.fromJSON(E.position,S),O,E.baseVersion)}}r.a=T},function(o,r,s){'use strict';var d=s(28),u=s(1),f=s(5),h=s(107);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends d.a{constructor(C,P,T){const E=C.root.document.graveyard,S=new u.a(E,[E.maxOffset,0]);super(C,P,S,T)}get type(){return'remove'}get _holderElementOffset(){return this.targetPosition.path[0]}set _holderElementOffset(C){this.targetPosition.path[0]=C}get _needsHolderElement(){if(this.delta)for(let C of this.delta.operations)if(C instanceof w){if(C==this)return!0;if(C._holderElementOffset==this._holderElementOffset)return!1}return!0}getReversed(){return new h.a(this.targetPosition,this.howMany,this.sourcePosition,this.baseVersion+1)}clone(){let C=new w(this.sourcePosition,this.howMany,this.baseVersion);return C.targetPosition=u.a.createFromPosition(this.targetPosition),C}_execute(){if(this._needsHolderElement){const C=this.targetPosition.root,P=new f.a('$graveyardHolder');C.insertChildren(this._holderElementOffset,P),this.sourcePosition.root==C&&this.sourcePosition.path[0]>=this._holderElementOffset&&this.sourcePosition.path[0]++}return super._execute()}static get className(){return'engine.model.operation.RemoveOperation'}static fromJSON(C,P){let T=u.a.fromJSON(C.sourcePosition,P);const E=new w(T,C.howMany,C.baseVersion);return E.targetPosition=u.a.fromJSON(C.targetPosition,P),E}}r.a=w},function(o,r,s){'use strict';function d(){return 0===this.childCount?0:null}var u=s(21);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends u.a{constructor(h,w,C){super(h,w,C),this.getFillerOffset=d}is(h,w=null){return w?'containerElement'==h&&w==this.name||super.is(h,w):'containerElement'==h||super.is(h)}}r.a=f},function(o,r,s){'use strict';var h=s(113),w=s(5);r.c=function(P,T){return P.setCustomProperty(C,!0),s.i(h.a)(P,{label:function(){const S=P.getChild(0),O=S.getAttribute('alt');return O?`${O} ${T}`:T}})},r.a=function(P){return!!P.getCustomProperty(C)&&s.i(h.b)(P)},r.b=function(P){return P instanceof w.a&&'image'==P.name};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const C=Symbol('isImage')},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){return!!(u&&u[Symbol.iterator])}},function(o,r,s){'use strict';var u=s(79),f=s(121),h=s(122),w=s(132),C=s(435),P=s(91);r.a=function(E,S,O){var V=-1,R=f.a,F=E.length,N=!0,I=[],M=I;if(O)N=!1,R=h.a;else if(F>=200){var D=S?null:s.i(C.a)(E);if(D)return s.i(P.a)(D);N=!1,R=w.a,M=new u.a}else M=S?[]:I;outer:for(;++V<F;){var L=E[V],q=S?S(L):L;if(L=O||0!==L?L:0,N&&q===q){for(var z=M.length;z--;)if(M[z]===q)continue outer;S&&M.push(q),I.push(L)}else R(M,q,O)||(M!==I&&M.push(q),I.push(L))}return I}},function(o,r){'use strict';r.a=function(u){return!!u&&'object'==typeof u}},function(o,r,s){'use strict';var u=s(43),h=Object.prototype,w=h.toString;r.a=function(C){return'symbol'==typeof C||s.i(u.a)(C)&&w.call(C)=='[object Symbol]'}},function(o,r,s){'use strict';var u=s(97),f=s(154),h=s(110),w=s(39),C=s(167),P=s(0);r.a=function(){return new T};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class T{constructor(){this._dispatchers=[],this._from=null}for(...E){return this._dispatchers=E,this}fromElement(E){return this._from={type:'element',name:E,priority:null},this}fromAttribute(E){return this._from={type:'attribute',key:E,priority:null},this}fromMarker(E){return this._from={type:'marker',name:E,priority:null},this}withPriority(E){return this._from.priority=E,this}toElement(E){const S=null===this._from.priority?'normal':this._from.priority;for(let O of this._dispatchers)'element'==this._from.type?(E='string'==typeof E?new w.a(E):E,O.on('insert:'+this._from.name,s.i(u.a)(E),{priority:S})):'attribute'==this._from.type?(E='string'==typeof E?new h.a(E):E,O.on('addAttribute:'+this._from.key,s.i(u.b)(E),{priority:S}),O.on('changeAttribute:'+this._from.key,s.i(u.b)(E),{priority:S}),O.on('removeAttribute:'+this._from.key,s.i(u.c)(E),{priority:S}),O.on('selectionAttribute:'+this._from.key,s.i(f.a)(E),{priority:S})):(E='string'==typeof E?new h.a(E):E,O.on('addMarker:'+this._from.name,s.i(u.d)(E),{priority:S}),O.on('removeMarker:'+this._from.name,s.i(u.e)(E),{priority:S}),O.on('selectionMarker:'+this._from.name,s.i(f.b)(E),{priority:S}))}toStamp(E){for(let S of this._dispatchers){if('marker'!=this._from.type)throw new P.a('build-model-converter-non-marker-to-stamp: To-stamp conversion is supported only from model markers.');const O=null===this._from.priority?'normal':this._from.priority;E='string'==typeof E?new C.a(E):E,S.on('addMarker:'+this._from.name,s.i(u.f)(E),{priority:O}),S.on('removeMarker:'+this._from.name,s.i(u.g)(E),{priority:O})}}toAttribute(E,S){if('attribute'!=this._from.type)throw new P.a('build-model-converter-non-attribute-to-attribute: To-attribute conversion is supported only from model attributes.');let O=E?'string'==typeof E?S?function(){return{key:E,value:S}}:function(V){return{key:E,value:V}}:E:void 0;for(let V of this._dispatchers){const R={priority:this._from.priority||'normal'};V.on('addAttribute:'+this._from.key,s.i(u.h)(O),R),V.on('changeAttribute:'+this._from.key,s.i(u.h)(O),R),V.on('removeAttribute:'+this._from.key,s.i(u.i)(O),R)}}}},function(o,r,s){'use strict';function d(S,O,V,R){if(s.i(T.a)(S)){for(let I of S)d(I,O,V,R);return}const F=Array.from(S.getAttributeKeys());F.push(O.key);const N={name:S.name||'$text',attributes:F,inside:V.context};R.schema.check(N)&&S.setAttribute(O.key,O.value)}var f=s(164),h=s(5),w=s(1),C=s(20),P=s(0),T=s(41);r.a=function(){return new E};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class E{constructor(){this._dispatchers=[],this._from=[]}for(...S){return this._dispatchers=S,this}fromElement(S){return this.from({name:S})}fromAttribute(S,O=/.*/){let V={};return V[S]=O,this.from(V)}from(S){return S instanceof f.a||(S=new f.a(S)),this._from.push({matcher:S,consume:!1,priority:null}),this}consuming(S){let O=this._from[this._from.length-1];return O.consume=S,this}withPriority(S){let O=this._from[this._from.length-1];return O.priority=S,this}toElement(S){this._setCallback(function(V){return(R,F,N,I)=>{let M=V.matcher.matchAll(F.input);if(M)for(let D of M){const L=S instanceof Function?S(F.input):new h.a(S),q=Array.from(L.getAttributeKeys());if(!I.schema.check({name:L.name,attributes:q,inside:F.context}))continue;if(!N.consume(F.input,V.consume||D.match))continue;F.context.push(L);const z=I.convertChildren(F.input,N,F),K=w.a.createAt(L,'end');C.a.insert(K,z),F.context.pop(),F.output=L;break}}},'normal')}toAttribute(S,O){this._setCallback(function(R){return(F,N,I,M)=>{let D=R.matcher.matchAll(N.input);if(D)for(let L of D){if(!I.consume(N.input,R.consume||L.match))continue;N.output||(N.output=M.convertChildren(N.input,I,N));let q=S instanceof Function?S(N.input):{key:S,value:O};d(N.output,q,N,M);break}}},'low')}toMarker(S){this._setCallback(function(V){return(R,F,N)=>{const I=V.matcher.matchAll(F.input);if(!I)return;let M;if(M=S instanceof Function?S(F.input):new h.a('$marker',{'data-name':F.input.getAttribute('data-name')}),'$marker'!=M.name||'string'!=typeof M.getAttribute('data-name'))throw new P.a('build-view-converter-invalid-marker: Invalid model element to mark marker range.');for(const D of I)if(N.consume(F.input,V.consume||D.match)){F.output=M;break}}},'normal')}_setCallback(S,O){for(let V of this._from){const R=V.matcher.getElementName(),F=R?'element:'+R:'element',N=S(V),I=null===V.priority?O:V.priority;for(let M of this._dispatchers)M.on(F,N,{priority:I})}}}},function(o,r,s){'use strict';function d(P){return'string'==typeof P?[new h.a(P)]:(s.i(w.a)(P)||(P=[P]),Array.from(P).map((T)=>'string'==typeof T?new h.a(T):T))}var u=s(67),f=s(5),h=s(24),w=s(41);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C{constructor(P){this.markers=new Map,this._children=new u.a,P&&this.insertChildren(0,P)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(P){return'documentFragment'==P}getChild(P){return this._children.getNode(P)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(P){return this._children.getNodeIndex(P)}getChildStartOffset(P){return this._children.getNodeStartOffset(P)}getPath(){return[]}offsetToIndex(P){return this._children.offsetToIndex(P)}appendChildren(P){this.insertChildren(this.childCount,P)}insertChildren(P,T){T=d(T);for(let E of T)E.parent=this;this._children.insertNodes(P,T)}removeChildren(P,T=1){const E=this._children.removeNodes(P,T);for(let S of E)S.parent=null;return E}toJSON(){let P=[];for(let T of this._children)P.push(T.toJSON());return P}static fromJSON(P){let T=[];for(let E of P)E.name?T.push(f.a.fromJSON(E)):T.push(h.a.fromJSON(E));return new C(T)}}r.a=C},function(o,r,s){'use strict';var d=s(77),u=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f{constructor(h){this.document=h,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}r.a=f,s.i(u.a)(f,d.a)},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u,f){const h=_Mathmin(u.length,f.length);for(let w=0;w<h;w++)if(u[w]!=f[w])return w;return u.length==f.length?'same':u.length<f.length?'prefix':'extension'}},function(o,r,s){'use strict';var u=s(229);r.a=function(f,h){var w=f[h];return s.i(u.a)(w)?w:void 0}},function(o,r,s){'use strict';var u=s(11),f=s(44),h=/\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,w=/^\\w*$/;r.a=function(C,P){if(s.i(u.a)(C))return!1;var T=typeof C;return'number'==T||'symbol'==T||'boolean'==T||null==C||s.i(f.a)(C)||w.test(C)||!h.test(C)||null!=P&&C in Object(P)}},function(o,r,s){'use strict';var u=s(44);r.a=function(h){if('string'==typeof h||s.i(u.a)(h))return h;var w=h+'';return'0'==w&&1/h==-(1/0)?'-0':w}},function(o,r){'use strict';r.a=function(u,f){return u===f||u!==u&&f!==f}},function(o,r,s){'use strict';var d=s(476);s.d(r,'a',function(){return d.a})},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const d={error(u,f){console.error(u,f)},warn(u,f){console.warn(u,f)}};r.a=d},function(o,r,s){'use strict';var d=s(148),u=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f{constructor(h){this.parent=null,this._attrs=s.i(d.a)(h)}get index(){let h;if(!this.parent)return null;if(null===(h=this.parent.getChildIndex(this)))throw new u.a('model-node-not-found-in-parent: The node\\'s parent does not contain this node.');return h}get startOffset(){let h;if(!this.parent)return null;if(null===(h=this.parent.getChildStartOffset(this)))throw new u.a('model-node-not-found-in-parent: The node\\'s parent does not contain this node.');return h}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const h=this.index;return null!==h&&this.parent.getChild(h+1)||null}get previousSibling(){const h=this.index;return null!==h&&this.parent.getChild(h-1)||null}get root(){let h=this;for(;h.parent;)h=h.parent;return h}get document(){return this.root==this?null:this.root.document||null}clone(){return new f(this._attrs)}getPath(){const h=[];for(let w=this;w.parent;)h.unshift(w.startOffset),w=w.parent;return h}getAncestors(h={includeNode:!1,parentFirst:!1}){const w=[];for(let C=h.includeNode?this:this.parent;C;)w[h.parentFirst?'push':'unshift'](C),C=C.parent;return w}remove(){this.parent.removeChildren(this.index)}hasAttribute(h){return this._attrs.has(h)}getAttribute(h){return this._attrs.get(h)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}setAttribute(h,w){this._attrs.set(h,w)}setAttributesTo(h){this._attrs=s.i(d.a)(h)}removeAttribute(h){return this._attrs.delete(h)}clearAttributes(){this._attrs.clear()}toJSON(){let h={};return this._attrs.size&&(h.attributes=[...this._attrs]),h}}r.a=f},function(o,r,s){'use strict';function d(V,R){return!R.has(V)&&(R.add(V),V.document.schema.itemExtends(V.name,'$block')&&V.parent)}function u(V,R){const F=V.parent.getAncestors({parentFirst:!0,includeNode:!0}),N=F.find((I)=>d(I,R));return F.forEach((I)=>R.add(I)),N}var f=s(1),h=s(5),w=s(3),C=s(7),P=s(0),T=s(4),E=s(148),S=s(495);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class O{constructor(){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map}get anchor(){if(0<this._ranges.length){const V=this._ranges[this._ranges.length-1];return this._lastRangeBackward?V.end:V.start}return null}get focus(){if(0<this._ranges.length){const V=this._ranges[this._ranges.length-1];return this._lastRangeBackward?V.start:V.end}return null}get isCollapsed(){const V=this._ranges.length;return!(1!==V)&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(V){if(this.rangeCount!=V.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(V.anchor)||!this.focus.isEqual(V.focus))return!1;for(let R of this._ranges){let F=!1;for(let N of V._ranges)if(R.isEqual(N)){F=!0;break}if(!F)return!1}return!0}*getRanges(){for(let V of this._ranges)yield w.a.createFromRange(V)}getFirstRange(){let V=null;for(let R of this._ranges)(!V||R.start.isBefore(V.start))&&(V=R);return V?w.a.createFromRange(V):null}getLastRange(){let V=null;for(let R of this._ranges)(!V||R.end.isAfter(V.end))&&(V=R);return V?w.a.createFromRange(V):null}getFirstPosition(){const V=this.getFirstRange();return V?f.a.createFromPosition(V.start):null}getLastPosition(){const V=this.getLastRange();return V?f.a.createFromPosition(V.end):null}addRange(V,R=!1){this._pushRange(V),this._lastRangeBackward=!!R,this.fire('change:range',{directChange:!0})}removeAllRanges(){0<this._ranges.length&&(this._removeAllRanges(),this.fire('change:range',{directChange:!0}))}setRanges(V,R=!1){V=Array.from(V);const F=V.some((N)=>{if(!(N instanceof w.a))throw new P.a('model-selection-added-not-range: Trying to add an object that is not an instance of Range.');return this._ranges.every((I)=>{return!I.isEqual(N)})});if(V.length!==this._ranges.length||F){this._removeAllRanges();for(let N of V)this._pushRange(N);this._lastRangeBackward=!!R,this.fire('change:range',{directChange:!0})}}setTo(V){this.setRanges(V.getRanges(),V.isBackward)}collapse(V,R){const F=f.a.createAt(V,R),N=new w.a(F,F);this.setRanges([N])}collapseToStart(){const V=this.getFirstPosition();null!==V&&this.setRanges([new w.a(V,V)])}collapseToEnd(){const V=this.getLastPosition();null!==V&&this.setRanges([new w.a(V,V)])}setFocus(V,R){if(null===this.anchor)throw new P.a('model-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.');const F=f.a.createAt(V,R);if('same'!=F.compareWith(this.focus)){const N=this.anchor;this._ranges.length&&this._popRange(),'before'==F.compareWith(N)?this.addRange(new w.a(F,N),!0):this.addRange(new w.a(N,F))}}getAttribute(V){return this._attrs.get(V)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(V){return this._attrs.has(V)}clearAttributes(){if(0<this._attrs.size){const V=Array.from(this._attrs.keys());this._attrs.clear(),this.fire('change:attribute',{attributeKeys:V,directChange:!0})}}removeAttribute(V){this.hasAttribute(V)&&(this._attrs.delete(V),this.fire('change:attribute',{attributeKeys:[V],directChange:!0}))}setAttribute(V,R){this.getAttribute(V)!==R&&(this._attrs.set(V,R),this.fire('change:attribute',{attributeKeys:[V],directChange:!0}))}setAttributesTo(V){if(V=s.i(E.a)(V),!s.i(S.a)(V,this._attrs)){const R=new Set(Array.from(V.keys()).concat(Array.from(this._attrs.keys())));for(let[F,N]of V)this._attrs.get(F)===N&&R.delete(F);this._attrs=V,this.fire('change:attribute',{attributeKeys:Array.from(R),directChange:!0})}}getSelectedElement(){if(1!==this.rangeCount)return null;const V=this.getFirstRange(),R=V.start.nodeAfter,F=V.end.nodeBefore;return R instanceof h.a&&R==F?R:null}*getSelectedBlocks(){const V=new WeakSet;for(const R of this.getRanges()){const F=u(R.start,V);F&&(yield F);for(const I of R.getWalker())'elementEnd'==I.type&&d(I.item,V)&&(yield I.item);const N=u(R.end,V);N&&(yield N)}}static createFromSelection(V){const R=new this;return R.setTo(V),R}_pushRange(V){if(!(V instanceof w.a))throw new P.a('model-selection-added-not-range: Trying to add an object that is not an instance of Range.');this._checkRange(V),this._ranges.push(w.a.createFromRange(V))}_checkRange(V){for(let R=0;R<this._ranges.length;R++)if(V.isIntersecting(this._ranges[R]))throw new P.a('model-selection-range-intersects: Trying to add a range that intersects with another range from selection.',{addedRange:V,intersectingRange:this._ranges[R]})}_popRange(){this._ranges.pop()}_removeAllRanges(){for(;0<this._ranges.length;)this._popRange()}}r.a=O,s.i(T.a)(O,C.a)},function(o,r,s){'use strict';function d(R){return R instanceof Text&&R.data.substr(0,S)===O}function C(R,F){if(F.keyCode==P.d.arrowleft){const N=F.domTarget.ownerDocument.defaultView.getSelection();if(1==N.rangeCount&&N.getRangeAt(0).collapsed){const I=N.getRangeAt(0).startContainer,M=N.getRangeAt(0).startOffset;if(d(I)&&M<=S){const D=new Range;D.setStart(I,0),D.collapse(!0),N.removeAllRanges(),N.addRange(D)}}}}var P=s(22);s.d(r,'i',function(){return O}),r.c=d,r.f=function(R){return R.data.length==S&&d(R)},r.g=function(R){return d(R)?R.data.slice(S):R.data},r.e=function(R,F){let N=V.get(F);return N||(N=F(window.document),V.set(F,N)),R.isEqualNode(N)},r.h=function(R){R.on('keydown',C)};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.b=(R)=>{const F=R.createElement('br');return F.dataset.ckeFiller=!0,F};r.a=(R)=>R.createTextNode('\\xA0');const S=7;r.d=S;let O='';for(let R=0;R<S;R++)O+='\\u200B';const V=new WeakMap},function(o,r,s){'use strict';var d=s(48),u=s(112);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.useCapture=!1}observe(h){const w='string'==typeof this.domEventType?[this.domEventType]:this.domEventType;w.forEach((C)=>{this.listenTo(h,C,(P,T)=>{this.isEnabled&&this.onDomEvent(T)},{useCapture:this.useCapture})})}fire(h,w,C){this.isEnabled&&this.document.fire(h,new u.a(this.document,w,C))}}r.a=f},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a={window,document}},function(o,r,s){'use strict';var d=s(77),u=s(31),f=s(0),h=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w{constructor(){this.set('isFocused',!1),this.focusedElement=null,this._elements=new Set,this._nextEventLoopTimeout=null}add(C){if(this._elements.has(C))throw new f.a('focusTracker-add-element-already-exist');this.listenTo(C,'focus',()=>this._focus(C),{useCapture:!0}),this.listenTo(C,'blur',()=>this._blur(),{useCapture:!0}),this._elements.add(C)}remove(C){C===this.focusedElement&&this._blur(C),this._elements.has(C)&&(this.stopListening(C),this._elements.delete(C))}_focus(C){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=C,this.isFocused=!0}_blur(){this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}r.a=w,s.i(h.a)(w,d.a),s.i(h.a)(w,u.a)},function(o,r,s){'use strict';var d=s(77),u=s(22);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(){this._listener=Object.create(d.a),this._keystrokes=new Map}listenTo(h){this._listener.listenTo(h,'keydown',(w,C)=>{this.press(C)})}set(h,w){const C=s.i(u.a)(h),P=this._keystrokes.get(C);P?P.push(w):this._keystrokes.set(C,[w])}press(h){const w=s.i(u.c)(h),C=this._keystrokes.get(w);if(!C)return!1;for(let P of C)P(h,()=>{h.preventDefault(),h.stopPropagation()});return!0}destroy(){this._keystrokes=new Map,this._listener.stopListening()}}},function(o,r,s){'use strict';var u=s(53),f=Object.prototype,h=f.hasOwnProperty;r.a=function(w,C,P){var T=w[C];h.call(w,C)&&s.i(u.a)(T,P)&&(P!==void 0||C in w)||(w[C]=P)}},function(o,r,s){'use strict';var u=s(79),f=s(121),h=s(122),w=s(27),C=s(130),P=s(132);r.a=function(E,S,O,V){var R=-1,F=f.a,N=!0,I=E.length,M=[],D=S.length;if(!I)return M;O&&(S=s.i(w.a)(S,s.i(C.a)(O))),V?(F=h.a,N=!1):S.length>=200&&(F=P.a,N=!1,S=new u.a(S));outer:for(;++R<I;){var L=E[R],q=O?O(L):L;if(L=V||0!==L?L:0,N&&q===q){for(var z=D;z--;)if(S[z]===q)continue outer;M.push(L)}else F(S,q,V)||M.push(L)}return M}},function(o,r,s){'use strict';var u=s(193),f=s(415),h=s(201),w=s(93),C=s(36),P=s(89);r.a=function(T){var E=s.i(P.a)(T);if(!(E||s.i(w.a)(T)))return s.i(f.a)(T);var S=s.i(h.a)(T),V=S||[],R=V.length;for(var F in T)!s.i(u.a)(T,F)||!!S&&('length'==F||s.i(C.a)(F,R))||E&&'constructor'==F||V.push(F);return V}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(){let u='e';for(let f=0;8>f;f++)u+=_Mathfloor(65536*(1+Math.random())).toString(16).substring(1);return u}},function(o,r,s){'use strict';var d=s(56),u=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f{constructor(h){this._nodes=[],h&&this.insertNodes(0,h)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((h,w)=>h+w.offsetSize,0)}getNode(h){return this._nodes[h]||null}getNodeIndex(h){const w=this._nodes.indexOf(h);return-1==w?null:w}getNodeStartOffset(h){const w=this.getNodeIndex(h);return null===w?null:this._nodes.slice(0,w).reduce((C,P)=>C+P.offsetSize,0)}indexToOffset(h){if(h==this._nodes.length)return this.maxOffset;const w=this._nodes[h];if(!w)throw new u.a('model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.');return this.getNodeStartOffset(w)}offsetToIndex(h){let w=0;for(let C of this._nodes){if(h>=w&&h<w+C.offsetSize)return this.getNodeIndex(C);w+=C.offsetSize}if(w!=h)throw new u.a('model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.');return this.length}insertNodes(h,w){for(let C of w)if(!(C instanceof d.a))throw new u.a('model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.');this._nodes.splice(h,0,...w)}removeNodes(h,w=1){return this._nodes.splice(h,w)}toJSON(){return this._nodes.map((h)=>h.toJSON())}}r.a=f},function(o,r,s){'use strict';var d=s(32),u=s(3),f=s(0),h=s(20),w=s(482);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends d.a{constructor(P,T,E,S,O){super(O),this.range=u.a.createFromRange(P),this.key=T,this.oldValue=E===void 0?null:E,this.newValue=S===void 0?null:S}get type(){return null===this.oldValue?'addAttribute':null===this.newValue?'removeAttribute':'changeAttribute'}clone(){return new C(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new C(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_execute(){for(let P of this.range.getItems()){if(null!==this.oldValue&&!s.i(w.a)(P.getAttribute(this.key),this.oldValue))throw new f.a('attribute-operation-wrong-old-value: Changed node has different attribute value than operation\\'s old attribute value.',{item:P,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&P.hasAttribute(this.key))throw new f.a('attribute-operation-attribute-exists: The attribute with given key already exists.',{node:P,key:this.key});if(s.i(w.a)(this.oldValue,this.newValue))return}return h.a.setAttribute(this.range,this.key,this.newValue),{range:this.range,key:this.key,oldValue:this.oldValue,newValue:this.newValue}}static get className(){return'engine.model.operation.AttributeOperation'}static fromJSON(P,T){return new C(u.a.fromJSON(P.range,T),P.key,P.oldValue,P.newValue,P.baseVersion)}}r.a=C},function(o,r,s){'use strict';var d=s(32);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{clone(){return new u(this.baseVersion)}getReversed(){return new u(this.baseVersion+1)}_execute(){}static get className(){return'engine.model.operation.NoOperation'}}r.a=u},function(o,r,s){'use strict';var d=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u{constructor(f,h,w){if(this.textNode=f,0>h||h>f.offsetSize)throw new d.a('model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.');if(0>w||h+w>f.offsetSize)throw new d.a('model-textproxy-wrong-length: Given length value is incorrect.');this.data=f.data.substring(h,h+w),this.offsetInText=h}get startOffset(){return null===this.textNode.startOffset?null:this.textNode.startOffset+this.offsetInText}get offsetSize(){return this.data.length}get endOffset(){return null===this.startOffset?null:this.startOffset+this.offsetSize}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(f){return'textProxy'==f}getPath(){const f=this.textNode.getPath();return 0<f.length&&(f[f.length-1]+=this.offsetInText),f}getAncestors(f={includeNode:!1,parentFirst:!1}){const h=[];for(let w=f.includeNode?this:this.parent;w;)h[f.parentFirst?'push':'unshift'](w),w=w.parent;return h}hasAttribute(f){return this.textNode.hasAttribute(f)}getAttribute(f){return this.textNode.getAttribute(f)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}r.a=u},function(o,r,s){'use strict';var d=s(39),u=s(0),f=s(4),h=s(31);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const w=Symbol('document');class C extends d.a{constructor(P,T,E){super(P,T,E),this.set('isReadOnly',!1),this.set('isFocused',!1)}get document(){return this.getCustomProperty(w)}set document(P){if(this.getCustomProperty(w))throw new u.a('view-editableelement-document-already-set: View document is already set.');this.setCustomProperty(w,P),this.bind('isFocused').to(P,'isFocused',(T)=>T&&P.selection.editableElement==this),this.listenTo(P,'render',()=>{this.isFocused=P.isFocused&&P.selection.editableElement==this},{priority:'high'})}}r.a=C,s.i(f.a)(C,h.a)},function(o,r,s){'use strict';var d=s(0),u=s(7),f=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h{constructor(){this.parent=null}get index(){let w;if(!this.parent)return null;if(-1==(w=this.parent.getChildIndex(this)))throw new d.a('view-node-not-found-in-parent: The node\\'s parent does not contain this node.');return w}get nextSibling(){const w=this.index;return null!==w&&this.parent.getChild(w+1)||null}get previousSibling(){const w=this.index;return null!==w&&this.parent.getChild(w-1)||null}get root(){let w=this;for(;w.parent;)w=w.parent;return w}get document(){return this.parent instanceof h?this.parent.document:null}getAncestors(w={includeNode:!1,parentFirst:!1}){const C=[];for(let P=w.includeNode?this:this.parent;P;)C[w.parentFirst?'push':'unshift'](P),P=P.parent;return C}remove(){this.parent.removeChildren(this.index)}_fireChange(w,C){this.fire('change:'+w,C),this.parent&&this.parent._fireChange(w,C)}}r.a=h,s.i(f.a)(h,u.a)},function(o,r,s){'use strict';var d=s(0),u=s(34),f=s(25),h=s(4),w=s(7),C=s(21);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P{constructor(){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel=''}setFake(T=!0,E={}){this._isFake=T,this._fakeSelectionLabel=T?E.label||'':'',this.fire('change')}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const T=this._ranges[this._ranges.length-1],E=this._lastRangeBackward?T.end:T.start;return f.a.createFromPosition(E)}get focus(){if(!this._ranges.length)return null;const T=this._ranges[this._ranges.length-1],E=this._lastRangeBackward?T.start:T.end;return f.a.createFromPosition(E)}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}addRange(T,E){if(!(T instanceof u.a))throw new d.a('view-selection-invalid-range: Invalid Range.');this._pushRange(T),this._lastRangeBackward=!!E,this.fire('change')}*getRanges(){for(let T of this._ranges)yield u.a.createFromRange(T)}getFirstRange(){let T=null;for(let E of this._ranges)(!T||E.start.isBefore(T.start))&&(T=E);return T?u.a.createFromRange(T):null}getLastRange(){let T=null;for(let E of this._ranges)(!T||E.end.isAfter(T.end))&&(T=E);return T?u.a.createFromRange(T):null}getFirstPosition(){const T=this.getFirstRange();return T?f.a.createFromPosition(T.start):null}getLastPosition(){const T=this.getLastRange();return T?f.a.createFromPosition(T.end):null}isEqual(T){if(this.isFake!=T.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=T.fakeSelectionLabel)return!1;if(this.rangeCount!=T.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(T.anchor)||!this.focus.isEqual(T.focus))return!1;for(let E of this._ranges){let S=!1;for(let O of T._ranges)if(E.isEqual(O)){S=!0;break}if(!S)return!1}return!0}removeAllRanges(){this._ranges.length&&(this._ranges=[],this.fire('change'))}setRanges(T,E){this._ranges=[];for(let S of T){if(!(S instanceof u.a))throw new d.a('view-selection-invalid-range: Invalid Range.');this._pushRange(S)}this._lastRangeBackward=!!E,this.fire('change')}setTo(T){this._isFake=T._isFake,this._fakeSelectionLabel=T._fakeSelectionLabel,this.setRanges(T.getRanges(),T.isBackward)}collapse(T,E){const S=f.a.createAt(T,E),O=new u.a(S,S);this.setRanges([O])}collapseToStart(){const T=this.getFirstPosition();null!==T&&this.setRanges([new u.a(T,T)])}collapseToEnd(){const T=this.getLastPosition();null!==T&&this.setRanges([new u.a(T,T)])}setFocus(T,E){if(null===this.anchor)throw new d.a('view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.');const S=f.a.createAt(T,E);if('same'!=S.compareWith(this.focus)){const O=this.anchor;this._ranges.pop(),'before'==S.compareWith(O)?this.addRange(new u.a(S,O),!0):this.addRange(new u.a(O,S))}}getSelectedElement(){if(1!==this.rangeCount)return null;const T=this.getFirstRange(),E=T.start.nodeAfter,S=T.end.nodeBefore;return E instanceof C.a&&E==S?E:null}static createFromSelection(T){const E=new P;return E.setTo(T),E}_pushRange(T){for(let E of this._ranges)if(T.isIntersecting(E))throw new d.a('view-selection-range-intersects: Trying to add a range that intersects with another range from selection.',{addedRange:T,intersectingRange:E});this._ranges.push(u.a.createFromRange(T))}}r.a=P,s.i(h.a)(P,w.a)},function(o,r,s){'use strict';var d=s(21),u=s(29),f=s(319),h=s(25),w=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C{constructor(P={}){if(!P.boundaries&&!P.startPosition)throw new w.a('view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.');if(P.direction&&'forward'!=P.direction&&'backward'!=P.direction)throw new w.a('view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.',{direction:P.direction});this.boundaries=P.boundaries||null,this.position=P.startPosition?h.a.createFromPosition(P.startPosition):h.a.createFromPosition(P.boundaries['backward'==P.direction?'end':'start']),this.direction=P.direction||'forward',this.singleCharacters=!!P.singleCharacters,this.shallow=!!P.shallow,this.ignoreElementEnd=!!P.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(P){let T,E,S;do S=this.position,({done:T,value:E}=this.next());while(!T&&P(E));T||(this.position=S)}next(){return'forward'==this.direction?this._next():this._previous()}_next(){let P=h.a.createFromPosition(this.position);const T=this.position,E=P.parent;if(null===E.parent&&P.offset===E.childCount)return{done:!0};if(E===this._boundaryEndParent&&P.offset==this.boundaries.end.offset)return{done:!0};let S;if(E instanceof u.a){if(P.isAtEnd)return this.position=h.a.createAfter(E),this._next();S=E.data[P.offset]}else S=E.getChild(P.offset);if(S instanceof d.a)return this.shallow?P.offset++:P=new h.a(S,0),this.position=P,this._formatReturnValue('elementStart',S,T,P,1);if(S instanceof u.a){if(this.singleCharacters)return P=new h.a(S,0),this.position=P,this._next();let O=S.data.length,V=S;return S==this._boundaryEndParent?(O=this.boundaries.end.offset,V=new f.a(S,0,O),P=h.a.createAfter(V)):P.offset++,this.position=P,this._formatReturnValue('text',V,T,P,O)}if('string'==typeof S){let O;if(this.singleCharacters)O=1;else{const R=E===this._boundaryEndParent?this.boundaries.end.offset:E.data.length;O=R-P.offset}const V=new f.a(E,P.offset,O);return P.offset+=O,this.position=P,this._formatReturnValue('text',V,T,P,O)}return P=h.a.createAfter(E),this.position=P,this.ignoreElementEnd?this._next():this._formatReturnValue('elementEnd',E,T,P)}_previous(){let P=h.a.createFromPosition(this.position);const T=this.position,E=P.parent;if(null===E.parent&&0===P.offset)return{done:!0};if(E==this._boundaryStartParent&&P.offset==this.boundaries.start.offset)return{done:!0};let S;if(E instanceof u.a){if(P.isAtStart)return this.position=h.a.createBefore(E),this._previous();S=E.data[P.offset-1]}else S=E.getChild(P.offset-1);if(S instanceof d.a)return this.shallow?(P.offset--,this.position=P,this._formatReturnValue('elementStart',S,T,P,1)):(P=new h.a(S,S.childCount),this.position=P,this.ignoreElementEnd?this._previous():this._formatReturnValue('elementEnd',S,T,P));if(S instanceof u.a){if(this.singleCharacters)return P=new h.a(S,S.data.length),this.position=P,this._previous();let O=S.data.length,V=S;if(S==this._boundaryStartParent){const R=this.boundaries.start.offset;V=new f.a(S,R,S.data.length-R),O=V.data.length,P=h.a.createBefore(V)}else P.offset--;return this.position=P,this._formatReturnValue('text',V,T,P,O)}if('string'==typeof S){let O;if(!this.singleCharacters){const R=E===this._boundaryStartParent?this.boundaries.start.offset:0;O=P.offset-R}else O=1;P.offset-=O;const V=new f.a(E,P.offset,O);return this.position=P,this._formatReturnValue('text',V,T,P,O)}return P=h.a.createBefore(E),this.position=P,this._formatReturnValue('elementStart',E,T,P,1)}_formatReturnValue(P,T,E,S,O){return T instanceof f.a&&(T.offsetInText+T.data.length==T.textNode.data.length&&('forward'!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?E=h.a.createAfter(T.textNode):(S=h.a.createAfter(T.textNode),this.position=S)),0===T.offsetInText&&('backward'!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?E=h.a.createBefore(T.textNode):(S=h.a.createBefore(T.textNode),this.position=S))),{done:!1,value:{type:P,item:T,previousPosition:E,nextPosition:S,length:O}}}}r.a=C},function(o,r,s){'use strict';function f(le){const de=le.offset,ce=le.parent;if(ce.is('text'))return le;if(ce.is('attributeElement')&&0===ce.childCount){const ge=ce.parent,pe=ce.index;return ce.remove(),f(new G.a(ge,pe))}const ue=ce.getChild(de-1),me=ce.getChild(de);if(!ue||!me)return le;if(ue.is('text')&&me.is('text'))return z(ue,me);if(ue.is('attributeElement')&&me.is('attributeElement')&&ue.isSimilar(me)){const ge=ue.childCount;return ue.appendChildren(me.getChildren()),me.remove(),f(new G.a(ue,ge))}return le}function C(le,de){de=s.i(oe.a)(de)?[...de]:[de],W(de);const ce=F(le);if(!ce)throw new ne.a('view-writer-invalid-position-container');const ue=I(le,!0),me=ce.insertChildren(ue.offset,de),ge=ue.getShiftedBy(me),pe=f(ue);if(0===me)return new te.a(pe,pe);pe.isEqual(ue)||ge.offset--;const fe=f(ge);return new te.a(pe,fe)}function P(le){if(J(le),le.isCollapsed)return new ie.a;const{start:de,end:ce}=N(le,!0),ue=de.parent,me=ce.offset-de.offset,ge=ue.removeChildren(de.offset,me),pe=f(de);return le.start=pe,le.end=G.a.createFromPosition(pe),new ie.a(ge)}function E(le,de){let ce;if(de.isAfter(le.end)){de=I(de,!0);const ue=de.parent,me=ue.childCount;le=N(le,!0),ce=P(le),de.offset+=ue.childCount-me}else ce=P(le);return C(de,ce)}function S(le,de){if(!(de instanceof X.a))throw new ne.a('view-writer-wrap-invalid-attribute');if(J(le),le.isCollapsed)return le;if(le.end.isEqual(le.start.getShiftedBy(1))){const be=le.start.nodeAfter;if(be instanceof X.a&&K(de,be))return le}if(H(le)&&K(de,le.start.parent)){const be=le.start.parent.parent,_e=le.start.parent.index;return te.a.createFromParentsAndOffsets(be,_e,be,_e+1)}const{start:ce,end:ue}=N(le,!0),me=ce.parent,ge=M(me,ce.offset,ue.offset,de),pe=D(me,ge.start.offset,ge.end.offset,de),fe=f(pe.start);fe.isEqual(pe.start)||pe.end.offset--;const he=f(pe.end);return new te.a(fe,he)}function F(le){let de=le.parent;for(;!U(de);){if(!de)return;de=de.parent}return de}function N(le,de=!1){const ce=le.start,ue=le.end;if(J(le),le.isCollapsed){const fe=I(le.start,de);return new te.a(fe,fe)}const me=I(ue,de),ge=me.parent.childCount,pe=I(ce,de);return me.offset+=me.parent.childCount-ge,new te.a(pe,me)}function I(le,de=!1){const ce=le.offset,ue=le.parent;if(le.parent.is('emptyElement'))throw new ne.a('view-writer-cannot-break-empty-element');if(le.parent.is('uiElement'))throw new ne.a('view-writer-cannot-break-ui-element');if(!de&&ue.is('text')&&U(ue.parent))return G.a.createFromPosition(le);if(U(ue))return G.a.createFromPosition(le);if(ue.is('text'))return I(q(le),de);const me=ue.childCount;if(ce==me){const ge=new G.a(ue.parent,ue.index+1);return I(ge,de)}if(0===ce){const ge=new G.a(ue.parent,ue.index);return I(ge,de)}const ge=ue.index+1,pe=ue.clone();ue.parent.insertChildren(ge,pe);const fe=ue.childCount-ce,he=ue.removeChildren(ce,fe);pe.appendChildren(he);const be=new G.a(ue.parent,ge);return I(be,de)}function M(le,de,ce,ue){let me=de;const ge=[];for(;me<ce;){const fe=le.getChild(me);if(fe.isSimilar(ue)){const he=fe.getChildren(),be=fe.childCount;fe.remove(),le.insertChildren(me,he),ge.push(new G.a(le,me),new G.a(le,me+be)),me+=be,ce+=be-1}else fe.is('attributeElement')&&M(fe,0,fe.childCount,ue),me++}let pe=0;for(let fe of ge){if(fe.offset-=pe,fe.offset==de||fe.offset==ce)continue;const he=f(fe);he.isEqual(fe)||(pe++,ce--)}return te.a.createFromParentsAndOffsets(le,de,le,ce)}function D(le,de,ce,ue){let me=de;const ge=[];for(;me<ce;){const fe=le.getChild(me),he=fe.is('text'),be=fe.is('attributeElement'),_e=fe.is('emptyElement'),ye=fe.is('uiElement');if(he||_e||ye||be&&ue.priority<=fe.priority){const ve=ue.clone();fe.remove(),ve.appendChildren(fe),le.insertChildren(me,ve),ge.push(new G.a(le,me))}else be&&D(fe,0,fe.childCount,ue);me++}let pe=0;for(let fe of ge){if(fe.offset-=pe,fe.offset==de)continue;const he=f(fe);he.isEqual(fe)||(pe++,ce--)}return te.a.createFromParentsAndOffsets(le,de,le,ce)}function L(le){const de=le.nodeBefore;if(de&&de.is('text'))return new G.a(de,de.data.length);const ce=le.nodeAfter;return ce&&ce.is('text')?new G.a(ce,0):le}function q(le){if(le.offset==le.parent.data.length)return new G.a(le.parent.parent,le.parent.index+1);if(0===le.offset)return new G.a(le.parent.parent,le.parent.index);const de=le.parent.data.slice(le.offset);return le.parent.data=le.parent.data.slice(0,le.offset),le.parent.parent.insertChildren(le.parent.index+1,new ee.a(de)),new G.a(le.parent.parent,le.parent.index+1)}function z(le,de){const ce=le.data.length;return le.data+=de.data,de.remove(),new G.a(le,ce)}function K(le,de){if(le.name!==de.name||le.priority!==de.priority)return!1;for(let ce of le.getAttributeKeys())if('class'!==ce&&'style'!==ce&&de.hasAttribute(ce)&&de.getAttribute(ce)!==le.getAttribute(ce))return!1;for(let ce of le.getStyleNames())if(de.hasStyle(ce)&&de.getStyle(ce)!==le.getStyle(ce))return!1;for(let ce of le.getAttributeKeys())'class'!==ce&&'style'!==ce&&(de.hasAttribute(ce)||de.setAttribute(ce,le.getAttribute(ce)));for(let ce of le.getStyleNames())de.hasStyle(ce)||de.setStyle(ce,le.getStyle(ce));for(let ce of le.getClassNames())de.hasClass(ce)||de.addClass(ce);return!0}function $(le,de){if(le.name!==de.name||le.priority!==de.priority)return!1;for(let ce of le.getAttributeKeys())if('class'!==ce&&'style'!==ce&&(!de.hasAttribute(ce)||de.getAttribute(ce)!==le.getAttribute(ce)))return!1;if(!de.hasClass(...le.getClassNames()))return!1;for(let ce of le.getStyleNames())if(!de.hasStyle(ce)||de.getStyle(ce)!==le.getStyle(ce))return!1;for(let ce of le.getAttributeKeys())'class'!==ce&&'style'!==ce&&de.removeAttribute(ce);return de.removeClass(...le.getClassNames()),de.removeStyle(...le.getStyleNames()),!0}function H(le){return le.start.parent==le.end.parent&&le.start.parent.is('attributeElement')&&0===le.start.offset&&le.end.offset===le.start.parent.childCount}function W(le){for(let de of le){if(!se.some((ce)=>de instanceof ce))throw new ne.a('view-writer-insert-invalid-node');de.is('text')||W(de.getChildren())}}function U(le){return le&&(le.is('containerElement')||le.is('documentFragment'))}function J(le){const de=F(le.start),ce=F(le.end);if(!de||!ce||de!==ce)throw new ne.a('view-writer-invalid-range-container')}var G=s(25),Y=s(39),X=s(110),Z=s(163),Q=s(167),ee=s(29),te=s(34),ae=s(74),ne=s(0),ie=s(111),oe=s(41);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a={breakAttributes:function(le){return le instanceof G.a?I(le):N(le)},breakContainer:function(le){const de=le.parent;if(!de.is('containerElement'))throw new ne.a('view-writer-break-non-container-element: Trying to break an element which is not a container element.');if(!de.parent)throw new ne.a('view-writer-break-root: Trying to break root element.');if(le.isAtStart)return G.a.createBefore(de);if(!le.isAtEnd){const ce=de.clone(!1);C(G.a.createAfter(de),ce);const ue=new te.a(le,G.a.createAt(de,'end')),me=new G.a(ce,0);E(ue,me)}return G.a.createAfter(de)},mergeAttributes:f,mergeContainers:function(le){const de=le.nodeBefore,ce=le.nodeAfter;if(!de||!ce||!de.is('containerElement')||!ce.is('containerElement'))throw new ne.a('view-writer-merge-containers-invalid-position: Element before and after given position cannot be merged.');const ue=de.getChild(de.childCount-1),me=ue instanceof ee.a?G.a.createAt(ue,'end'):G.a.createAt(de,'end');return E(te.a.createIn(ce),G.a.createAt(de,'end')),P(te.a.createOn(ce)),me},insert:C,remove:P,clear:function(le,de){J(le);const ce=le.getWalker({direction:'backward',ignoreElementEnd:!0});for(const ue of ce){const me=ue.item;let ge;if(me.is('element')&&de.isSimilar(me))ge=te.a.createOn(me);else if(!ue.nextPosition.isAfter(le.start)&&(me.is('text')||me.is('textProxy'))){const pe=me.getAncestors().find((fe)=>{return fe.is('element')&&de.isSimilar(fe)});pe&&(ge=te.a.createIn(pe))}ge&&(ge.end.isAfter(le.end)&&(ge.end=le.end),ge.start.isBefore(le.start)&&(ge.start=le.start),P(ge))}},move:E,wrap:S,wrapPosition:function(le,de){if(!(de instanceof X.a))throw new ne.a('view-writer-wrap-invalid-attribute');if(de.isSimilar(le.parent))return L(G.a.createFromPosition(le));le.parent.is('text')&&(le=q(le));const ce=new X.a;ce.priority=_NumberPOSITIVE_INFINITY,ce.isSimilar=()=>!1,le.parent.insertChildren(le.offset,ce);const ue=new te.a(le,le.getShiftedBy(1));S(ue,de);const me=new G.a(ce.parent,ce.index);ce.remove();const ge=me.nodeBefore,pe=me.nodeAfter;return ge instanceof ee.a&&pe instanceof ee.a?z(ge,pe):L(me)},unwrap:function(le,de){if(!(de instanceof X.a))throw new ne.a('view-writer-unwrap-invalid-attribute');if(J(le),le.isCollapsed)return le;if(le.end.isEqual(le.start.getShiftedBy(1))){const he=le.start.nodeAfter;if(!de.isSimilar(he)&&he instanceof X.a&&$(de,he))return le}const{start:ce,end:ue}=N(le,!0),me=ce.parent,ge=M(me,ce.offset,ue.offset,de),pe=f(ge.start);pe.isEqual(ge.start)||ge.end.offset--;const fe=f(ge.end);return new te.a(pe,fe)},rename:function(le,de){const ce=new Y.a(de,le.getAttributes());return C(G.a.createAfter(le),ce),E(te.a.createIn(le),G.a.createAt(ce)),P(te.a.createOn(le)),ce},breakViewRangePerContainer:function(le){const de=[],ce=new ae.a({boundaries:le});let ue=le.start;for(let me of ce)me.item.is('containerElement')&&(ue.isEqual(me.previousPosition)||de.push(new te.a(ue,me.previousPosition)),ue=me.nextPosition);return de.push(new te.a(ue,le.end)),de}};const se=[ee.a,X.a,Y.a,Z.a,Q.a]},function(o,r,s){'use strict';var d=s(7),u=s(0),f=s(66),h=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w{constructor(C){this._items=[],this._itemMap=new Map,this._idProperty=C&&C.idProperty||'id',this._boundItemsMap=new Map}get length(){return this._items.length}add(C,P){let T;const E=this._idProperty;if(E in C){if(T=C[E],'string'!=typeof T)throw new u.a('collection-add-invalid-id');if(this.get(T))throw new u.a('collection-add-item-already-exists')}else C[E]=T=s.i(f.a)();if(void 0===P)P=this._items.length;else if(P>this._items.length||0>P)throw new u.a('collection-add-item-invalid-index');return this._items.splice(P,0,C),this._itemMap.set(T,C),this.fire('add',C,P),this}get(C){let P;if('string'==typeof C)P=this._itemMap.get(C);else if('number'==typeof C)P=this._items[C];else throw new u.a('collection-get-invalid-arg: Index or id must be given.');return P||null}getIndex(C){let P;return P='string'==typeof C?this._itemMap.get(C):C,this._items.indexOf(P)}remove(C){let S=!1,P,T,E;const O=this._idProperty;if('string'==typeof C?(T=C,E=this._itemMap.get(T),S=!E,E&&(P=this._items.indexOf(E))):'number'==typeof C?(P=C,E=this._items[P],S=!E,E&&(T=E[O])):(E=C,T=E[O],P=this._items.indexOf(E),S=-1==P||!this._itemMap.get(T)),S)throw new u.a('collection-remove-404: Item not found.');return this._items.splice(P,1),this._itemMap.delete(T),this.fire('remove',E),E}map(C,P){return this._items.map(C,P)}find(C,P){return this._items.find(C,P)}filter(C,P){return this._items.filter(C,P)}clear(){for(;this.length;)this.remove(0)}bindTo(C){const P=(T)=>{for(let E of C)this.add(T(E));this.listenTo(C,'add',(E,S,O)=>{this.add(T(S),O)}),this.listenTo(C,'remove',(E,S)=>{this.remove(this._boundItemsMap.get(S)),this._boundItemsMap.delete(S)})};return{as:(T)=>{P((E)=>{const S=new T(E);return this._boundItemsMap.set(E,S),S})},using:(T)=>{let E;E='function'==typeof T?(S)=>{const O=T(S);return this._boundItemsMap.set(S,O),O}:(S)=>{const O=S[T];return this._boundItemsMap.set(S,O),O},P(E)}}}[Symbol.iterator](){return this._items[Symbol.iterator]()}}r.a=w,s.i(h.a)(w,d.a)},function(o,r,s){'use strict';function d(E){return E['data-ck-expando']||(E['data-ck-expando']=s.i(h.a)())}function u(E){return E&&s.i(C.a)(E.addEventListener)}var f=s(7),h=s(66),w=s(54),C=s(229);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const P=s.i(w.a)({},f.a,{listenTo(...E){const S=E[0];u(S)&&(E[0]=this._getProxyEmitter(S)||new T(S)),f.a.listenTo.apply(this,E)},stopListening(...E){const S=E[0];if(u(S)){let O=this._getProxyEmitter(S);if(!O)return;E[0]=O}f.a.stopListening.apply(this,E)},_getProxyEmitter(E){return s.i(f.b)(this,d(E))}});r.a=P;class T{constructor(E){s.i(f.c)(this,d(E)),this._domNode=E}}s.i(w.a)(T.prototype,f.a,{on(E,S,O={}){if(f.a.on.apply(this,arguments),!(this._domListeners&&this._domListeners[E])){const V=this._createDomListener(E);this._domNode.addEventListener(E,V,!!O.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[E]=V}},off(E){f.a.off.apply(this,arguments);let S;!this._domListeners[E]||(S=this._events[E])&&S.callbacks.length||this._domListeners[E].removeListener()},_createDomListener(E){const S=(O)=>{this.fire(E,O)};return S.removeListener=()=>{this._domNode.removeEventListener(E,S),delete this._domListeners[E]},S}})},function(o,r,s){'use strict';function d(P){var T=-1,E=P?P.length:0;for(this.clear();++T<E;){var S=P[T];this.set(S[0],S[1])}}var u=s(454),f=s(455),h=s(456),w=s(457),C=s(458);d.prototype.clear=u.a,d.prototype['delete']=f.a,d.prototype.get=h.a,d.prototype.has=w.a,d.prototype.set=C.a,r.a=d},function(o,r,s){'use strict';function d(w){var C=-1,P=w?w.length:0;for(this.__data__=new u.a;++C<P;)this.add(w[C])}var u=s(118),f=s(465),h=s(466);d.prototype.add=d.prototype.push=f.a,d.prototype.has=h.a,r.a=d},function(o,r){'use strict';r.a=function(u,f){for(var h=-1,w=u.length,C=0,P=[],T;++h<w;)T=u[h],f(T,h,u)&&(P[C++]=T);return P}},function(o,r){'use strict';r.a=function(u,f){for(var h=-1,w=f.length,C=u.length;++h<w;)u[C+h]=f[h];return u}},function(o,r,s){'use strict';var u=s(53);r.a=function(f,h){for(var w=f.length;w--;)if(s.i(u.a)(f[w][0],h))return w;return-1}},function(o,r,s){'use strict';var u=s(129),f=s(223),h=s(44);r.a=function(P,T,E){var S=0,O=P?P.length:S;if('number'==typeof T&&T===T&&O<=4294967295>>>1){for(;S<O;){var V=S+O>>>1,R=P[V];null!==R&&!s.i(h.a)(R)&&(E?R<=T:R<T)?S=V+1:O=V}return O}return s.i(u.a)(P,T,f.a,E)}},function(o,r,s){'use strict';var u=s(35);r.a=function(f,h,w,C){for(var P=f.length,T=C?P:-1;(C?T--:++T<P)&&h(f[T],T,f););return w?s.i(u.a)(f,C?0:T,C?T+1:P):s.i(u.a)(f,C?T+1:0,C?P:T)}},function(o,r,s){'use strict';var u=s(11),f=s(473);r.a=function(h){return s.i(u.a)(h)?h:s.i(f.a)(h)}},function(o,r,s){'use strict';var u=s(452);r.a=function(f,h){var w=f.__data__;return s.i(u.a)(h)?w['string'==typeof h?'string':'hash']:w.map}},function(o,r){'use strict';r.a=function(u){var f=!1;if(null!=u&&'function'!=typeof u.toString)try{f=!!(u+'')}catch(h){}return f}},function(o,r,s){'use strict';var u=s(53),f=s(93),h=s(36),w=s(14);r.a=function(C,P,T){if(!s.i(w.a)(T))return!1;var E=typeof P;return!('number'==E?!(s.i(f.a)(T)&&s.i(h.a)(P,T.length)):!('string'==E&&P in T))&&s.i(u.a)(T[P],C)}},function(o,r){'use strict';var u=Object.prototype;r.a=function(f){var h=f&&f.constructor,w='function'==typeof h&&h.prototype||u;return f===w}},function(o,r,s){'use strict';var d=s(50),u=s.i(d.a)(Object,'create');r.a=u},function(o,r){'use strict';r.a=function(u){var f=-1,h=Array(u.size);return u.forEach(function(w){h[++f]=w}),h}},function(o,r,s){'use strict';var u=s(191);r.a=function(f){return s.i(u.a)(f,!1,!0)}},function(o,r,s){'use strict';var u=s(440),f=s(144),h=s(94);r.a=function(w){return null!=w&&s.i(h.a)(s.i(u.a)(w))&&!s.i(f.a)(w)}},function(o,r){'use strict';r.a=function(f){return'number'==typeof f&&-1<f&&0==f%1&&f<=9007199254740991}},function(o,r,s){'use strict';var u=s(136),f=s(87),h=s(43),C=Object.prototype,P=Function.prototype.toString,T=C.hasOwnProperty,E=P.call(Object),S=C.toString;r.a=function(O){if(!s.i(h.a)(O)||S.call(O)!='[object Object]'||s.i(f.a)(O))return!1;var V=s.i(u.a)(O);if(null===V)return!0;var R=T.call(V,'constructor')&&V.constructor;return'function'==typeof R&&R instanceof R&&P.call(R)==E}},function(o,r,s){'use strict';var u=s(80),f=s(27),h=s(127),w=s(196),C=s(13);r.a=function(T){if(!(T&&T.length))return[];var E=0;return T=s.i(u.a)(T,function(S){if(s.i(C.a)(S))return E=_Mathmax(S.length,E),!0}),s.i(w.a)(E,function(S){return s.i(f.a)(T,s.i(h.a)(S))})}},function(o,r,s){'use strict';function V(M){const D=M.split(':');return D[0]+':'+D[1]}/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */var R=s(3),F=s(21),N=s(29),I=s(75);r.a=function(M){return(D,L,q,z)=>{const K=M instanceof F.a?M.clone(!0):M(L,q,z);if(K&&q.consume(L.item,'insert')){const $=z.mapper.toViewPosition(L.range.start);z.mapper.bindElements(L.item,K),I.a.insert($,K)}}},r.j=function(){return(M,D,L,q)=>{if(L.consume(D.item,'insert')){const z=q.mapper.toViewPosition(D.range.start),K=new N.a(D.item.data);I.a.insert(z,K)}}},r.f=function(M){return(D,L,q,z)=>{let K,$;if((M instanceof F.a?(K=M.clone(!0),$=M.clone(!0)):(L.isOpening=!0,K=M(L,q,z),L.isOpening=!1,$=M(L,q,z)),K&&$)&&q.consume(L.range,'addMarker')){const H=z.mapper;I.a.insert(H.toViewPosition(L.range.start),K),L.range.isCollapsed||I.a.insert(H.toViewPosition(L.range.end),$)}}},r.h=function(M){return M=M||((D,L)=>({value:D,key:L})),(D,L,q,z)=>{if(q.consume(L.item,V(D.name))){const{key:K,value:$}=M(L.attributeNewValue,L.attributeKey,L,q,z);z.mapper.toViewElement(L.item).setAttribute(K,$)}}},r.i=function(M){return M=M||((D,L)=>({key:L})),(D,L,q,z)=>{if(q.consume(L.item,V(D.name))){const{key:K}=M(L.attributeOldValue,L.attributeKey,L,q,z);z.mapper.toViewElement(L.item).removeAttribute(K)}}},r.b=function(M){return(D,L,q,z)=>{const K=M instanceof F.a?M.clone(!0):M(L.attributeNewValue,L,q,z);if(!K)return;if(!q.consume(L.item,V(D.name)))return;let $=z.mapper.toViewRange(L.range);if(null!==L.attributeOldValue&&!(M instanceof F.a)){const H=M(L.attributeOldValue,L,q,z);$=I.a.unwrap($,H)}I.a.wrap($,K)}},r.c=function(M){return(D,L,q,z)=>{const K=M instanceof F.a?M.clone(!0):M(L.attributeOldValue,L,q,z);if(K&&q.consume(L.item,V(D.name))){const $=z.mapper.toViewRange(L.range);I.a.unwrap($,K)}}},r.d=function(M){return(D,L,q,z)=>{const K=M instanceof F.a?M.clone(!0):M(L,q,z);if(K&&q.consume(L.range,'addMarker')){const $=z.mapper.toViewRange(L.range),H=I.a.breakViewRangePerContainer($);for(let W of H)I.a.wrap(W,K)}}},r.e=function(M){return(D,L,q,z)=>{const K=M instanceof F.a?M.clone(!0):M(L,q,z);if(K&&q.consume(L.range,'removeMarker')){const $=z.mapper.toViewRange(L.range),H=I.a.breakViewRangePerContainer($);for(let W of H)I.a.unwrap(W,K)}}},r.k=function(){return(M,D,L,q)=>{if(L.consume(D.item,'remove')){const z=R.a.createFromPositionAndShift(D.sourcePosition,D.item.offsetSize),K=q.mapper.toViewRange(z);I.a.remove(K.getTrimmed()),q.mapper.unbindModelElement(D.item)}}},r.g=function(M){return(D,L,q,z)=>{let K,$;if((M instanceof F.a?(K=M.clone(!0),$=M.clone(!0)):(L.isOpening=!0,K=M(L,q,z),L.isOpening=!1,$=M(L,q,z)),K&&$)&&q.consume(L.range,'removeMarker')){const H=z.mapper.toViewRange(L.range);I.a.clear(H.getEnlarged(),$),K.isSimilar($)||I.a.clear(H.getEnlarged(),K)}}}},function(o,r,s){'use strict';var d=s(19),u=s(17),f=s(101),h=s(16),w=s(37),C=s(47),P=s(3),T=s(1);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class E extends d.a{get type(){return'insert'}get position(){return this._insertOperation?this._insertOperation.position:null}get nodes(){return this._insertOperation?this._insertOperation.nodes:null}get _insertOperation(){return this.operations[0]||null}get _reverseDeltaClass(){return f.a}static get className(){return'engine.model.delta.InsertDelta'}static get _priority(){return 20}}r.a=E,s.i(h.b)('insert',function(S,O){const V=new E,R=new w.a(S,O,this.document.version);if(this.addDelta(V),V.addOperation(R),this.document.applyOperation(R),O instanceof C.a)for(const[F,N]of O.markers){const I=T.a.createAt(N.root),M=new P.a(N.start._getCombined(I,S),N.end._getCombined(I,S));this.setMarker(F,M)}return this}),u.a.register(E)},function(o,r,s){'use strict';var d=s(19),u=s(17),f=s(102),h=s(16),w=s(1),C=s(5),P=s(38),T=s(28),E=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class S extends d.a{get type(){return'merge'}get position(){return this._removeOperation?this._removeOperation.sourcePosition:null}getReversed(){let O=super.getReversed();return 0<O.operations.length&&(O.operations[1].isSticky=!1),O}get _removeOperation(){return this.operations[1]||null}get _reverseDeltaClass(){return f.a}static get className(){return'engine.model.delta.MergeDelta'}}r.a=S,s.i(h.b)('merge',function(O){const V=new S;this.addDelta(V);const R=O.nodeBefore,F=O.nodeAfter;if(!(R instanceof C.a))throw new E.a('batch-merge-no-element-before: Node before merge position must be an element.');if(!(F instanceof C.a))throw new E.a('batch-merge-no-element-after: Node after merge position must be an element.');const N=w.a.createFromParentAndOffset(F,0),I=w.a.createFromParentAndOffset(R,R.maxOffset),M=new T.a(N,F.maxOffset,I,this.document.version);M.isSticky=!0,V.addOperation(M),this.document.applyOperation(M);const D=new P.a(O,1,this.document.version);return V.addOperation(D),this.document.applyOperation(D),this}),u.a.register(S)},function(o,r,s){'use strict';function d(S,O,V,R,F){const N=new w.a(V,R,F,S.document.version);O.addOperation(N),S.document.applyOperation(N)}var u=s(19),f=s(17),h=s(16),w=s(28),C=s(1),P=s(3),T=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class E extends u.a{get type(){return'move'}get howMany(){return this._moveOperation?this._moveOperation.howMany:null}get sourcePosition(){return this._moveOperation?this._moveOperation.sourcePosition:null}get targetPosition(){return this._moveOperation?this._moveOperation.targetPosition:null}get _moveOperation(){return this.operations[0]||null}get _reverseDeltaClass(){return E}static get className(){return'engine.model.delta.MoveDelta'}static get _priority(){return 20}}r.a=E,s.i(h.b)('move',function(S,O){const V=new E;if(this.addDelta(V),S instanceof P.a){if(!S.isFlat)throw new T.a('batch-move-range-not-flat: Range to move is not flat.');d(this,V,S.start,S.end.offset-S.start.offset,O)}else d(this,V,C.a.createBefore(S),1,O);return this}),f.a.register(E)},function(o,r,s){'use strict';function d(E,S,O,V){const R=new w.a(O,V,E.document.version);S.addOperation(R),E.document.applyOperation(R)}var u=s(100),f=s(16),h=s(17),w=s(38),C=s(1),P=s(3);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class T extends u.a{static get className(){return'engine.model.delta.RemoveDelta'}}r.a=T,s.i(f.b)('remove',function(E){const S=new T;if(this.addDelta(S),E instanceof P.a){let O=E.getMinimalFlatRanges().reverse();for(let V of O)d(this,S,V.start,V.end.offset-V.start.offset)}else d(this,S,C.a.createBefore(E),1);return this}),h.a.register(T)},function(o,r,s){'use strict';var d=s(19),u=s(17),f=s(16),h=s(1),w=s(5),C=s(37),P=s(28),T=s(0),E=s(99);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class S extends d.a{get type(){return'split'}get position(){return this._moveOperation?this._moveOperation.sourcePosition:null}getReversed(){let O=super.getReversed();return 0<O.operations.length&&(O.operations[0].isSticky=!0),O}get _cloneOperation(){return this.operations[0]||null}get _moveOperation(){return this.operations[1]||null}get _reverseDeltaClass(){return E.a}static get className(){return'engine.model.delta.SplitDelta'}static get _priority(){return 5}}r.a=S,s.i(f.b)('split',function(O){const V=new S;this.addDelta(V);const R=O.parent;if(!R.parent)throw new T.a('batch-split-root: Root element can not be split.');const F=new w.a(R.name,R.getAttributes()),N=new C.a(h.a.createAfter(R),F,this.document.version);V.addOperation(N),this.document.applyOperation(N);const I=new P.a(O,R.maxOffset-O.offset,h.a.createFromParentAndOffset(F,0),this.document.version);return I.isSticky=!0,V.addOperation(I),this.document.applyOperation(I),this}),u.a.register(S)},function(o,r,s){'use strict';function d(N,I,M){const D=w(N,I)||f,L=D(N,I,M),q=R.a.last(I.operations).baseVersion;return u(q,L)}function u(N,I){for(let M of I)for(let D of M.operations)D.baseVersion=++N;return I}function f(N,I,M){M=C(N.constructor,I.constructor,M);const D=new N.constructor;let L=I.operations,q=[];for(let z of N.operations){const K=[z];for(let $ of L)for(let H=0;H<K.length;H++){const W=K[H];Array.prototype.push.apply(q,s.i(O.a)($,W,!M));const U=s.i(O.a)(W,$,M);Array.prototype.splice.apply(K,[H,1].concat(U)),H+=U.length-1}L=q,q=[];for(let $ of K)D.addOperation($)}return[D]}function w(N,I){let M=F.get(N.constructor);if(!M||!M.get(I.constructor)){const D=F.keys();for(let L of D)if(N instanceof L&&F.get(L).get(I.constructor)){M=F.get(L);break}}return M?M.get(I.constructor):void 0}function C(N,I,M){return!!(N._priority>I._priority)||!(N._priority<I._priority)&&M}function T(N){return N.reduce((I,M)=>{return I+M.operations.length},0)}function E(N,I){const M=N[N.length-1];let D=M.operations.length+M.baseVersion,L=new S.a;for(let q=0;q<I;q++)L.addOperation(new V.a(D++));N.push(L)}var S=s(19),O=s(308),V=s(69),R=s(475);r.c=f,r.b=function(N,I,M){let D=F.get(N);D||(D=new Map,F.set(N,D)),D.set(I,M)},r.a=function(N,I,M){let D=Array.from(N),L=Array.from(I);for(let K=0,$;K<D.length;K++){$=[D[K]];for(let H=0,W;H<L.length;H++){W=[L[H]];for(let U=0;U<$.length;U++)for(let J=0;J<W.length;J++){let G=d($[U],W[J],M),Y=d(W[J],$[U],!M);$.splice(U,1,...G),U+=G.length-1,W.splice(J,1,...Y),J+=Y.length-1}L.splice(H,1,...W),H+=W.length-1}D.splice(K,1,...$),K+=$.length-1}const q=T(D)-T(N),z=T(L)-T(I);return z<q?E(L,q-z):q<z&&E(D,z-q),{deltasA:D,deltasB:L}};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const F=new Map},function(o,r,s){'use strict';var d=s(19),u=s(17),f=s(105),h=s(16),w=s(1),C=s(38),P=s(28),T=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class E extends d.a{get type(){return'unwrap'}get position(){return this._moveOperation?this._moveOperation.targetPosition:null}get _moveOperation(){return this.operations[0]||null}get _reverseDeltaClass(){return f.a}static get className(){return'engine.model.delta.UnwrapDelta'}static get _priority(){return 10}}r.a=E,s.i(h.b)('unwrap',function(S){if(null===S.parent)throw new T.a('batch-unwrap-element-no-parent: Trying to unwrap an element which has no parent.');const O=new E;this.addDelta(O);let V=w.a.createFromParentAndOffset(S,0);const R=new P.a(V,S.maxOffset,w.a.createBefore(S),this.document.version);R.isSticky=!0,O.addOperation(R),this.document.applyOperation(R);const F=new C.a(w.a.createBefore(S),1,this.document.version);return O.addOperation(F),this.document.applyOperation(F),this}),u.a.register(E)},function(o,r,s){'use strict';var d=s(19),u=s(17),f=s(104),h=s(16),w=s(1),C=s(3),P=s(5),T=s(37),E=s(28),S=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class O extends d.a{get type(){return'wrap'}get range(){let V=this._moveOperation;return V?C.a.createFromPositionAndShift(V.sourcePosition,V.howMany):null}get howMany(){let V=this.range;return V?V.end.offset-V.start.offset:0}get _insertOperation(){return this.operations[0]||null}get _moveOperation(){return this.operations[1]||null}get _reverseDeltaClass(){return f.a}static get className(){return'engine.model.delta.WrapDelta'}static get _priority(){return 10}}r.a=O,s.i(h.b)('wrap',function(V,R){if(!V.isFlat)throw new S.a('batch-wrap-range-not-flat: Range to wrap is not flat.');let F=R instanceof P.a?R:new P.a(R);if(0<F.childCount)throw new S.a('batch-wrap-element-not-empty: Element to wrap with is not empty.');if(null!==F.parent)throw new S.a('batch-wrap-element-attached: Element to wrap with is already attached to tree model.');const N=new O;this.addDelta(N);let I=new T.a(V.end,F,this.document.version);N.addOperation(I),this.document.applyOperation(I);let M=w.a.createFromParentAndOffset(F,0),D=new E.a(V.start,V.end.offset-V.start.offset,M,this.document.version);return N.addOperation(D),this.document.applyOperation(D),this}),u.a.register(O)},function(o,r,s){'use strict';var d=s(32),u=s(3);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h,w,C,P,T){super(T),this.name=h,this.oldRange=w?u.a.createFromRange(w):null,this.newRange=C?u.a.createFromRange(C):null,this._markers=P}get type(){return'marker'}clone(){return new f(this.name,this.oldRange,this.newRange,this._markers,this.baseVersion)}getReversed(){return new f(this.name,this.newRange,this.oldRange,this._markers,this.baseVersion+1)}_execute(){const h=this.newRange?'set':'remove';return this._markers[h](this.name,this.newRange),{name:this.name,type:h}}toJSON(){const h=super.toJSON();return delete h._markers,h}static get className(){return'engine.model.operation.MarkerOperation'}static fromJSON(h,w){return new f(h.name,h.oldRange?u.a.fromJSON(h.oldRange,w):null,h.newRange?u.a.fromJSON(h.newRange,w):null,w.markers,h.baseVersion)}}r.a=f},function(o,r,s){'use strict';var d=s(28),u=s(38);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{get position(){return this.targetPosition}set position(h){this.targetPosition=h}get type(){return'reinsert'}getReversed(){return new u.a(this.targetPosition,this.howMany,this.baseVersion+1)}static get className(){return'engine.model.operation.ReinsertOperation'}}r.a=f},function(o,r,s){'use strict';var d=s(32),u=s(5),f=s(0),h=s(1);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends d.a{constructor(C,P,T,E){super(E),this.position=C,this.oldName=P,this.newName=T}get type(){return'rename'}clone(){return new w(h.a.createFromPosition(this.position),this.oldName,this.newName,this.baseVersion)}getReversed(){return new w(h.a.createFromPosition(this.position),this.newName,this.oldName,this.baseVersion+1)}_execute(){const C=this.position.nodeAfter;if(!(C instanceof u.a))throw new f.a('rename-operation-wrong-position: Given position is invalid or node after it is not an instance of Element.');else if(C.name!==this.oldName)throw new f.a('rename-operation-wrong-name: Element to change has different name than operation\\'s old name.');return this.oldName==this.newName?void 0:(C.name=this.newName,{element:C,oldName:this.oldName})}static get className(){return'engine.model.operation.RenameOperation'}static fromJSON(C,P){return new w(h.a.fromJSON(C.position,P),C.oldName,C.newName,C.baseVersion)}}r.a=w},function(o,r,s){'use strict';var d=s(32),u=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h,w,C,P,T){super(T),this.root=h,this.key=w,this.oldValue=C,this.newValue=P}get type(){return null===this.oldValue?'addRootAttribute':null===this.newValue?'removeRootAttribute':'changeRootAttribute'}clone(){return new f(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new f(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_execute(){if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new u.a('rootattribute-operation-wrong-old-value: Changed node has different attribute value than operation\\'s old attribute value.',{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new u.a('rootattribute-operation-attribute-exists: The attribute with given key already exists.',{root:this.root,key:this.key});return null===this.newValue?this.root.removeAttribute(this.key):this.root.setAttribute(this.key,this.newValue),{root:this.root,key:this.key,oldValue:this.oldValue,newValue:this.newValue}}static get className(){return'engine.model.operation.RootAttributeOperation'}static fromJSON(h,w){if(!w.hasRoot(h.root))throw new u.a('rootattribute-operation-fromjson-no-root: Cannot create RootAttributeOperation. Root with specified name does not exist.',{rootName:h});return new f(w.getRoot(h.root),h.key,h.oldValue,h.newValue,h.baseVersion)}}r.a=f},function(o,r,s){'use strict';function d(){if(this.childCount)return null;let w=this.parent;for(;w&&w.is('attributeElement');){if(1<w.childCount)return null;w=w.parent}return!w||1<w.childCount?null:0}var u=s(21);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const f=10;class h extends u.a{constructor(w,C,P){super(w,C,P),this.priority=f,this.getFillerOffset=d}is(w,C=null){return C?'attributeElement'==w&&C==this.name||super.is(w,C):'attributeElement'==w||super.is(w)}clone(w){const C=super.clone(w);return C.priority=this.priority,C}isSimilar(w){return super.isSimilar(w)&&this.priority==w.priority}}r.a=h,h.DEFAULT_PRIORITY=f},function(o,r,s){'use strict';function d(P){return'string'==typeof P?[new u.a(P)]:(s.i(h.a)(P)||(P=[P]),Array.from(P).map((T)=>'string'==typeof T?new u.a(T):T))}var u=s(29),f=s(4),h=s(41),w=s(7);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C{constructor(P){this._children=[],P&&this.insertChildren(0,P)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(P){return'documentFragment'==P}appendChildren(P){return this.insertChildren(this.childCount,P)}getChild(P){return this._children[P]}getChildIndex(P){return this._children.indexOf(P)}getChildren(){return this._children[Symbol.iterator]()}insertChildren(P,T){this._fireChange('children',this);let E=0;T=d(T);for(let S of T)S.parent=this,this._children.splice(P,0,S),P++,E++;return E}removeChildren(P,T=1){this._fireChange('children',this);for(let E=P;E<P+T;E++)this._children[E].parent=null;return this._children.splice(P,T)}_fireChange(P,T){this.fire('change:'+P,T)}}r.a=C,s.i(f.a)(C,w.a)},function(o,r,s){'use strict';var d=s(54);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u{constructor(f,h,w){this.document=f,this.domEvent=h,this.domTarget=h.target,s.i(d.a)(this,w)}get target(){return this.document.domConverter.getCorrespondingViewElement(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}r.a=u},function(o,r){'use strict';function f(S,O){S.setCustomProperty(P,O)}function w(){return null}r.b=function(S){return!!S.getCustomProperty(C)},r.a=function(S,O){return O=O||{},S.setAttribute('contenteditable',!1),S.getFillerOffset=w,S.addClass(T),S.setCustomProperty(C,!0),O.label&&f(S,O.label),S},r.d=function(S){const O=S.getCustomProperty(P);return O?'function'==typeof O?O():O:''};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const C=Symbol('isWidget'),P=Symbol('label'),T='ck-widget';r.c='ck-widget_selected'},function(o,r,s){'use strict';function d(D,L,q,z,K){if(z.test(q.input)&&D.schema.check({name:'paragraph',inside:q.context})){const $=new P.a('paragraph');M.add($),q.context.push($);const H=K.convertItem(q.input,z,q);H&&(q.output=$,$.appendChildren(H)),q.context.pop()}}function u(D,L,q,z,K){if(I.paragraphLikeElements.has(q.input.name)&&z.test(q.input,{name:!0})&&!h(q.input)&&D.schema.check({name:'paragraph',inside:q.context})){z.consume(q.input,{name:!0});const $=new P.a('paragraph');q.context.push($);const H=K.convertChildren(q.input,z,q);$.appendChildren(V.a.normalizeNodes(H)),q.context.pop(),q.output=$}}function f(D,L){if(!L.output)return;let q;for(q=s.i(N.a)(L.output)?L.output[0]:L.output.getChild(0);q&&q.nextSibling;){const z=q.nextSibling;M.has(q)&&M.has(z)?(V.a.insert(T.a.createAt(q,'end'),Array.from(z.getChildren())),V.a.remove(E.a.createOn(z))):q=q.nextSibling}}function h(D){const L=O.a.createIn(D);for(const q of L)if(q.item instanceof S.a&&I.paragraphLikeElements.has(q.item.name))return!0;return!1}var w=s(351),C=s(2),P=s(5),T=s(1),E=s(3),S=s(21),O=s(34),V=s(20),R=s(45),F=s(46),N=s(11);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class I extends C.a{init(){const D=this.editor,L=D.document,q=D.data,z=D.editing;L.schema.registerItem('paragraph','$block'),s.i(R.a)().for(q.modelToView,z.modelToView).fromElement('paragraph').toElement('p'),s.i(F.a)().for(q.viewToModel).fromElement('p').toElement('paragraph'),q.viewToModel.on('text',(K,$,H,W)=>{d(L,K,$,H,W)},{priority:'lowest'}),q.viewToModel.on('element',f,{priority:'lowest'}),q.viewToModel.on('documentFragment',f,{priority:'lowest'}),q.viewToModel.on('element',(K,$,H,W)=>{u(L,K,$,H,W)},{priority:'low'}),D.commands.set('paragraph',new w.a(D))}}r.a=I,I.paragraphLikeElements=new Set(['blockquote','dd','div','dt','h1','h2','h3','h4','h5','h6','li','p','td']);const M=new WeakSet},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function d(f){return f.focus}class u{constructor(f){if(Object.assign(this,f),f.actions&&f.keystrokeHandler)for(let h in f.actions){let w=f.actions[h];'string'==typeof w&&(w=[w]);for(let C of w)f.keystrokeHandler.set(C,(P,T)=>{this[h](),T()})}}get first(){return this.focusables.find(d)||null}get last(){return this.focusables.filter(d).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let f=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find((h,w)=>{const C=h.element===this.focusTracker.focusedElement;return C&&(f=w),C}),f)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(f){f&&f.focus()}_getFocusableItem(f){const h=this.current,w=this.focusables.length;if(!w||null===h)return null;let C=(h+w+f)%w;do{let P=this.focusables.get(C);if(d(P))return P;C=(C+w+f)%w}while(C!==h);return null}}r.a=u},function(o,r,s){'use strict';function d(P){return P.every((T)=>'string'==typeof T)}var u=s(0),f=s(31),h=s(76),w=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends h.a{constructor(P){super({idProperty:'viewUid'}),this.on('add',(T,E,S)=>{E.element&&this._parentElement&&this._parentElement.insertBefore(E.element,this._parentElement.children[S])}),this.on('remove',(T,E)=>{E.element&&this._parentElement&&E.element.remove()}),this.locale=P,this.set('ready',!1),this._parentElement=null}init(){if(this.ready)throw new u.a('ui-viewcollection-init-reinit: This ViewCollection has already been initialized.');return Promise.all(this.map((P)=>P.init())).then(()=>{this.ready=!0})}destroy(){let P=[];for(let T of this)P.push(T.destroy());return Promise.all(P)}add(P,T){super.add(P,T);let E=Promise.resolve();return this.ready&&!P.ready&&(E=E.then(()=>{return P.init()})),E}setParent(P){this._parentElement=P}delegate(...P){if(!P.length||!d(P))throw new u.a('ui-viewcollection-delegate-wrong-events: All event names must be strings.');return{to:(T)=>{for(let E of this)for(let S of P)E.delegate(S).to(T);this.on('add',(E,S)=>{for(let O of P)S.delegate(O).to(T)}),this.on('remove',(E,S)=>{for(let O of P)S.stopDelegating(O,T)})}}}}r.a=C,s.i(w.a)(h.a,f.a)},function(o,r,s){'use strict';function d(w,C){let P=u([w],C);P.sort((T,E)=>T.start.isBefore(E.start)?-1:1);for(let T=1;T<P.length;T++){let E=P[T-1],S=P[T];E.end.isTouching(S.start)&&(E.end=S.end,P.splice(T,1),T--)}return P}function u(w,C){for(let P of C)for(let T of P.operations)for(let E=0;E<w.length;E++){let S;switch(T.type){case'insert':S=w[E]._getTransformedByInsertion(T.position,T.nodes.maxOffset,!0);break;case'move':case'remove':case'reinsert':S=w[E]._getTransformedByMove(T.sourcePosition,T.targetPosition,T.howMany,!0);}S&&(w.splice(E,1,...S),E=E+S.length-1)}return w}var f=s(12);r.b=u;/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends f.a{constructor(w){super(w),this._stack=[],this._createdBatches=new WeakSet,this.refreshState()}addBatch(w){const C={ranges:Array.from(this.editor.document.selection.getRanges()),isBackward:this.editor.document.selection.isBackward};this._stack.push({batch:w,selection:C}),this.refreshState()}clearStack(){this._stack=[],this.refreshState()}_checkEnabled(){return 0<this._stack.length}_restoreSelection(w,C,P){const T=this.editor.document,E=[];for(let S of w){const O=d(S,P),V=O.find((R)=>R.start.root!=T.graveyard);V&&E.push(V)}E.length&&T.selection.setRanges(E,C)}}r.a=h},function(o,r,s){'use strict';function d(P){var T=-1,E=P?P.length:0;for(this.clear();++T<E;){var S=P[T];this.set(S[0],S[1])}}var u=s(459),f=s(460),h=s(461),w=s(462),C=s(463);d.prototype.clear=u.a,d.prototype['delete']=f.a,d.prototype.get=h.a,d.prototype.has=w.a,d.prototype.set=C.a,r.a=d},function(o,r,s){'use strict';function d(T){this.__data__=new u.a(T)}var u=s(78),f=s(468),h=s(469),w=s(470),C=s(471),P=s(472);d.prototype.clear=f.a,d.prototype['delete']=h.a,d.prototype.get=w.a,d.prototype.has=C.a,d.prototype.set=P.a,r.a=d},function(o,r,s){'use strict';var d=s(30),u=d.a.Symbol;r.a=u},function(o,r,s){'use strict';var u=s(124);r.a=function(f,h){return!!f.length&&-1<s.i(u.a)(f,h,0)}},function(o,r){'use strict';r.a=function(u,f,h){for(var w=-1,C=u.length;++w<C;)if(h(f,u[w]))return!0;return!1}},function(o,r,s){'use strict';var u=s(85),f=s(51),h=s(52);r.a=function(w,C){C=s.i(f.a)(C,w)?[C]:s.i(u.a)(C);for(var P=0,T=C.length;null!=w&&P<T;)w=w[s.i(h.a)(C[P++])];return P&&P==T?w:void 0}},function(o,r,s){'use strict';var u=s(202);r.a=function(f,h,w){if(h!==h)return s.i(u.a)(f,w);for(var C=w-1,P=f.length;++C<P;)if(f[C]===h)return C;return-1}},function(o,r,s){'use strict';var u=s(79),f=s(121),h=s(122),w=s(27),C=s(130),P=s(132);r.a=function(E,S,O){for(var V=O?h.a:f.a,R=E[0].length,F=E.length,N=F,I=Array(F),M=Infinity,D=[],L;N--;)L=E[N],N&&S&&(L=s.i(w.a)(L,s.i(C.a)(S))),M=_Mathmin(L.length,M),I[N]=!O&&(S||120<=R&&120<=L.length)?new u.a(N&&L):void 0;L=E[0];var q=-1,z=I[0];outer:for(;++q<R&&D.length<M;){var K=L[q],$=S?S(K):K;if(K=O||0!==K?K:0,z?!s.i(P.a)(z,$):!V(D,$,O)){for(N=F;--N;){var H=I[N];if(H?!s.i(P.a)(H,$):!V(E[N],$,O))continue outer}z&&z.push($),D.push(K)}}return D}},function(o,r,s){'use strict';function d(w,C,P,T,E){return!(w!==C)||(null!=w&&null!=C&&(s.i(f.a)(w)||s.i(h.a)(C))?s.i(u.a)(w,C,d,P,T,E):w!==w&&C!==C)}var u=s(413),f=s(14),h=s(43);r.a=d},function(o,r){'use strict';r.a=function(u){return function(f){return null==f?void 0:f[u]}}},function(o,r,s){'use strict';var u=s(27),f=s(124),h=s(412),w=s(130),C=Array.prototype,P=C.splice;r.a=function(T,E,S,O){var V=O?h.a:f.a,R=-1,F=E.length,N=T;for(S&&(N=s.i(u.a)(T,s.i(w.a)(S)));++R<F;)for(var I=0,M=E[R],D=S?S(M):M;-1<(I=V(N,D,I,O));)N!==T&&P.call(N,I,1),P.call(T,I,1);return T}},function(o,r,s){'use strict';var u=s(44);r.a=function(P,T,E,S){T=E(T);for(var O=0,V=P?P.length:0,R=T!==T,F=null===T,N=s.i(u.a)(T),I=void 0===T;O<V;){var M=_Mathfloor((O+V)/2),D=E(P[M]),L=D!==void 0,q=null===D,z=D===D,K=s.i(u.a)(D);if(R)var $=S||z;else $=I?z&&(S||L):F?z&&L&&(S||!q):N?z&&L&&!q&&(S||!K):q||K?!1:S?D<=T:D<T;$?O=M+1:V=M}return _Mathmin(V,4294967295-1)}},function(o,r){'use strict';r.a=function(u){return function(f){return u(f)}}},function(o,r,s){'use strict';var u=s(81),f=s(64),h=s(42);r.a=function(w,C,P){for(var T=-1,E=w.length,S;++T<E;)S=S?s.i(u.a)(s.i(f.a)(S,w[T],C,P),s.i(f.a)(w[T],S,C,P)):w[T];return S&&S.length?s.i(h.a)(S,C,P):[]}},function(o,r){'use strict';r.a=function(u,f){return u.has(f)}},function(o,r,s){'use strict';var u=s(13);r.a=function(f){return s.i(u.a)(f)?f:[]}},function(o,r,s){'use strict';var u=s(188);r.a=function(f){var h=new f.constructor(f.byteLength);return new u.a(h).set(new u.a(f)),h}},function(o,r,s){'use strict';var u=s(63);r.a=function(f,h,w,C){w||(w={});for(var P=-1,T=h.length;++P<T;){var E=h[P],S=C?C(w[E],f[E],E,w,f):f[E];s.i(u.a)(w,E,S)}return w}},function(o,r){'use strict';var u=Object.getPrototypeOf;r.a=function(f){return u(Object(f))}},function(o,r,s){'use strict';function d(z){return N.call(z)}var u=s(396),f=s(186),h=s(398),w=s(187),C=s(400),P=s(205),T='[object Map]',S='[object Promise]',O='[object Set]',V='[object WeakMap]',R='[object DataView]',F=Object.prototype,N=F.toString,I=s.i(P.a)(u.a),M=s.i(P.a)(f.a),D=s.i(P.a)(h.a),L=s.i(P.a)(w.a),q=s.i(P.a)(C.a);(u.a&&d(new u.a(new ArrayBuffer(1)))!=R||f.a&&d(new f.a)!=T||h.a&&d(h.a.resolve())!=S||w.a&&d(new w.a)!=O||C.a&&d(new C.a)!=V)&&(d=function(z){var K=N.call(z),$=K=='[object Object]'?z.constructor:void 0,H=$?s.i(P.a)($):void 0;if(H)switch(H){case I:return R;case M:return T;case D:return S;case L:return O;case q:return V;}return K}),r.a=d},function(o,r){'use strict';r.a=function(u){var f=-1,h=Array(u.size);return u.forEach(function(w,C){h[++f]=[C,w]}),h}},function(o,r,s){'use strict';var u=s(14),f=s(487),h=s(253);r.a=function(T,E,S){function O(X){var Z=q,Q=z;return q=z=void 0,U=X,$=T.apply(Q,Z),$}function V(X){return U=X,H=setTimeout(N,E),J?O(X):$}function R(X){var Z=X-W,Q=X-U,ee=E-Z;return G?_Mathmin(ee,K-Q):ee}function F(X){var Z=X-W,Q=X-U;return!W||Z>=E||0>Z||G&&Q>=K}function N(){var X=s.i(f.a)();return F(X)?I(X):void(H=setTimeout(N,R(X)))}function I(X){return(clearTimeout(H),H=void 0,Y&&q)?O(X):(q=z=void 0,$)}function L(){var X=s.i(f.a)(),Z=F(X);if(q=arguments,z=this,W=X,Z){if(void 0===H)return V(W);if(G)return clearTimeout(H),H=setTimeout(N,E),O(W)}return void 0===H&&(H=setTimeout(N,E)),$}var W=0,U=0,J=!1,G=!1,Y=!0,q,z,K,$,H;if('function'!=typeof T)throw new TypeError('Expected a function');return E=s.i(h.a)(E)||0,s.i(u.a)(S)&&(J=!!S.leading,G='maxWait'in S,K=G?_Mathmax(s.i(h.a)(S.maxWait)||0,E):K,Y='trailing'in S?!!S.trailing:Y),L.cancel=function(){void 0!==H&&clearTimeout(H),W=U=0,q=z=H=void 0},L.flush=function(){return void 0===H?$:I(s.i(f.a)())},L}},function(o,r,s){'use strict';var u=s(35),f=s(15);r.a=function(h,w,C){var P=h?h.length:0;return P?(w=C||void 0===w?1:s.i(f.a)(w),s.i(u.a)(h,0>w?0:w,P)):[]}},function(o,r,s){'use strict';var u=s(35),f=s(15);r.a=function(h,w,C){var P=h?h.length:0;return P?(w=C||void 0===w?1:s.i(f.a)(w),w=P-w,s.i(u.a)(h,0,0>w?0:w)):[]}},function(o,r){'use strict';r.a=function(u){return u&&u.length?u[0]:void 0}},function(o,r,s){'use strict';var u=s(13),h=Object.prototype,w=h.hasOwnProperty,C=h.toString,P=h.propertyIsEnumerable;r.a=function(T){return s.i(u.a)(T)&&w.call(T,'callee')&&(!P.call(T,'callee')||C.call(T)=='[object Arguments]')}},function(o,r,s){'use strict';var u=s(14),w=Object.prototype,C=w.toString;r.a=function(P){var T=s.i(u.a)(P)?C.call(P):'';return T=='[object Function]'||T=='[object GeneratorFunction]'}},function(o,r,s){'use strict';var u=s(11),f=s(43),w=Object.prototype,C=w.toString;r.a=function(P){return'string'==typeof P||!s.i(u.a)(P)&&s.i(f.a)(P)&&C.call(P)=='[object String]'}},function(o,r,s){'use strict';var u=s(128);r.a=function(f,h){return f&&f.length&&h&&h.length?s.i(u.a)(f,h):f}},function(o,r,s){'use strict';var u=s(189),f=s(27),h=s(96);r.a=function(w,C){if(!(w&&w.length))return[];var P=s.i(h.a)(w);return null==C?P:s.i(f.a)(P,function(T){return s.i(u.a)(C,void 0,T)})}},function(o,r,s){'use strict';var u=s(95),f=s(268);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(h){return s.i(u.a)(h)?s.i(f.a)(h):new Map(h)}},function(o){o.exports=function(s){if(!s.webpackPolyfill){var d=Object.create(s);d.children||(d.children=[]),Object.defineProperty(d,'loaded',{enumerable:!0,get:function(){return d.l}}),Object.defineProperty(d,'id',{enumerable:!0,get:function(){return d.i}}),Object.defineProperty(d,'exports',{enumerable:!0}),d.webpackPolyfill=1}return d}},function(o,r,s){'use strict';var u=s(33),f=s(3),h=s(1);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(w,C,P){const T=[];for(let E of C){const S=new u.a({boundaries:E,mergeCharacters:!0});let O=S.next(),V=E.start,R=E.start,F=E.end;for(;!O.done;){const N=O.value.item.name||'$text',I=h.a.createBefore(O.value.item);P.check({name:N,inside:I,attributes:w})||(!R.isEqual(V)&&T.push(new f.a(R,V)),R=S.position),V=S.position,O=S.next()}R&&!R.isEqual(F)&&T.push(new f.a(R,F))}return T}},function(o,r,s){'use strict';var u=s(33);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(f,h,w){if(h.isCollapsed)return w.check({name:'$text',inside:h.getFirstPosition(),attributes:f});const C=h.getRanges();for(let P of C){const T=new u.a({boundaries:P,mergeCharacters:!0});for(let E=T.position,S=T.next();!S.done;){const O=S.value.item.name||'$text';if(w.check({name:O,inside:E,attributes:f}))return!0;E=T.position,S=T.next()}}return!1}},function(o,r,s){'use strict';var d=s(12),u=s(150),f=s(151);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{constructor(w,C){super(w),this.attributeKey=C,this.set('value',!1),this.listenTo(this.editor.document.selection,'change:attribute',()=>{this.value=this.editor.document.selection.hasAttribute(this.attributeKey)})}_checkEnabled(){const w=this.editor.document;return s.i(f.a)(this.attributeKey,w.selection,w.schema)}_doExecute(w={}){const C=this.editor.document,P=C.selection,T=w.forceValue===void 0?!this.value:w.forceValue;C.enqueueChanges(()=>{if(P.isCollapsed)T?P.setAttribute(this.attributeKey,!0):P.removeAttribute(this.attributeKey);else{const E=s.i(u.a)(this.attributeKey,P.getRanges(),C.schema),S=w.batch||C.batch();for(let O of E)T?S.setAttribute(O,this.attributeKey,T):S.removeAttribute(O,this.attributeKey)}})}}r.a=h},function(o,r,s){'use strict';var d=s(1),u=s(3),f=s(25),h=s(34),w=s(29),C=s(7),P=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class T{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map}bindElements(E,S){this._modelToViewMapping.set(E,S),this._viewToModelMapping.set(S,E)}unbindViewElement(E){const S=this.toModelElement(E);this._unbindElements(S,E)}unbindModelElement(E){const S=this.toViewElement(E);this._unbindElements(E,S)}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap}toModelElement(E){return this._viewToModelMapping.get(E)}toViewElement(E){return this._modelToViewMapping.get(E)}toModelRange(E){return new u.a(this.toModelPosition(E.start),this.toModelPosition(E.end))}toViewRange(E){return new h.a(this.toViewPosition(E.start),this.toViewPosition(E.end))}toModelPosition(E){const S={viewPosition:E,modelPosition:this._defaultToModelPosition(E),mapper:this};return this.fire('viewToModelPosition',S),S.modelPosition}_defaultToViewPosition(E){let S=this._modelToViewMapping.get(E.parent);return this._findPositionIn(S,E.offset)}toViewPosition(E){const S={viewPosition:this._defaultToViewPosition(E),modelPosition:E,mapper:this};return this.fire('modelToViewPosition',S),S.viewPosition}_defaultToModelPosition(E){let S=E.parent,O=this._viewToModelMapping.get(S);for(;!O;)S=S.parent,O=this._viewToModelMapping.get(S);let V=this._toModelOffset(E.parent,E.offset,S);return d.a.createFromParentAndOffset(O,V)}registerViewToModelLength(E,S){this._viewToModelLengthCallbacks.set(E,S)}_toModelOffset(E,S,O){if(O!=E){const R=this._toModelOffset(E.parent,E.index,O),F=this._toModelOffset(E,S,E);return R+F}if(E.is('text'))return S;let V=0;for(let R=0;R<S;R++)V+=this.getModelLength(E.getChild(R));return V}_unbindElements(E,S){this._viewToModelMapping.delete(S),this._modelToViewMapping.delete(E)}getModelLength(E){if(this._viewToModelLengthCallbacks.get(E.name)){const S=this._viewToModelLengthCallbacks.get(E.name);return S(E)}if(this._viewToModelMapping.has(E))return 1;if(E.is('text'))return E.data.length;if(E.is('uiElement'))return 0;let S=0;for(let O of E.getChildren())S+=this.getModelLength(O);return S}_findPositionIn(E,S){let O,V=0,R=0,F=0;if(E.is('text'))return new f.a(E,S);for(;R<S;)O=E.getChild(F),V=this.getModelLength(O),R+=V,F++;return R==S?this._moveViewPositionToTextNode(new f.a(E,F)):this._findPositionIn(O,S-(R-V))}_moveViewPositionToTextNode(E){const S=E.nodeBefore,O=E.nodeAfter;if(S instanceof w.a)return new f.a(S,S.data.length);return O instanceof w.a?new f.a(O,0):E}}r.a=T,s.i(P.a)(T,C.a)},function(o,r,s){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function w(O,V,R,F,N){if(!O.isCollapsed)return;if(!F.consume(O,N))return;let I=V.getFirstPosition();I=S.a.wrapPosition(I,R),V.removeAllRanges(),V.addRange(new E.a(I,I))}var T=s(21),E=s(34),S=s(75);r.e=function(){return(O,V,R,F)=>{const N=V.selection;if(!N.isCollapsed&&R.consume(N,'selection')){F.viewSelection.removeAllRanges();for(let I of N.getRanges()){const M=F.mapper.toViewRange(I);F.viewSelection.addRange(M,N.isBackward)}}}},r.f=function(){return(O,V,R,F)=>{const N=V.selection;if(N.isCollapsed&&R.consume(N,'selection')){const I=N.getFirstPosition(),M=F.mapper.toViewPosition(I),D=S.a.breakAttributes(M);F.viewSelection.removeAllRanges(),F.viewSelection.addRange(new E.a(D,D))}}},r.a=function(O){return(V,R,F,N)=>{const I=O instanceof T.a?O.clone(!0):O(R.value,R,R.selection,F,N);if(I){const M='selectionAttribute:'+R.key;w(R.selection,N.viewSelection,I,F,M)}}},r.b=function(O){return(V,R,F,N)=>{const I=O instanceof T.a?O.clone(!0):O(R,F,N);if(I){const M='selectionMarker:'+R.name;w(R.selection,N.viewSelection,I,F,M)}}},r.c=function(){return(O,V,R,F)=>{for(let N of F.viewSelection.getRanges())N.isCollapsed&&N.end.parent.document&&S.a.mergeAttributes(N.start);F.viewSelection.removeAllRanges()}},r.d=function(){return(O,V,R,F)=>F.viewSelection.setFake(!1)}},function(o,r,s){'use strict';var d=s(294),u=s(3),f=s(1),h=s(47),w=s(7),C=s(4),P=s(54);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class T{constructor(E,S={}){this._modelDocument=E,this.conversionApi=s.i(P.a)({dispatcher:this},S)}convertChange(E,S){'remove'!==E&&S.range&&'$graveyard'==S.range.root.rootName||'remove'==E&&'$graveyard'==S.sourcePosition.root.rootName||'rename'==E&&'$graveyard'==S.element.root.rootName||('insert'==E||'reinsert'==E?this.convertInsertion(S.range):'move'==E?this.convertMove(S.sourcePosition,S.range):'remove'==E?this.convertRemove(S.sourcePosition,S.range):'addAttribute'==E||'removeAttribute'==E||'changeAttribute'==E?this.convertAttribute(E,S.range,S.key,S.oldValue,S.newValue):'rename'==E&&this.convertRename(S.element,S.oldName))}convertInsertion(E){const S=this._createInsertConsumable(E);for(let O of E){const V=O.item,R=u.a.createFromPositionAndShift(O.previousPosition,O.length),F={item:V,range:R};this._testAndFire('insert',F,S);for(let N of V.getAttributeKeys())F.attributeKey=N,F.attributeOldValue=null,F.attributeNewValue=V.getAttribute(N),this._testAndFire(`addAttribute:${N}`,F,S)}for(let O of this._modelDocument.markers){const V=O.getRange();V.containsPosition(E.start)&&this.convertMarker('addMarker',O.name,V.getIntersection(E)),(E.containsRange(V)||E.isEqual(V))&&this.convertMarker('addMarker',O.name,V)}}convertMove(E,S){this.convertRemove(E,S),this.convertInsertion(S)}convertRemove(E,S){const O=this._createConsumableForRange(S,'remove');for(let V of S.getItems({shallow:!0})){this._testAndFire(`remove`,{sourcePosition:E,item:V},O)}}convertAttribute(E,S,O,V,R){const F=this._createConsumableForRange(S,E+':'+O);for(let N of S){const I=N.item,M=u.a.createFromPositionAndShift(N.previousPosition,N.length);this._testAndFire(`${E}:${O}`,{item:I,range:M,attributeKey:O,attributeOldValue:V,attributeNewValue:R},F)}}convertRename(E,S){const O=E.clone(!0);O.name=S,this.conversionApi.mapper.bindElements(O,this.conversionApi.mapper.toViewElement(E));const V=new h.a;V.appendChildren(O),this.convertRemove(f.a.createBefore(E),u.a.createOn(O)),this.convertInsertion(u.a.createOn(E))}convertSelection(E){const S=Array.from(this._modelDocument.markers.getMarkersAtPosition(E.getFirstPosition())),O=this._createSelectionConsumable(E,S);this.fire('selection',{selection:E},O,this.conversionApi);for(let V of S){const R={selection:E,name:V.name};O.test(E,'selectionMarker:'+V.name)&&this.fire('selectionMarker:'+V.name,R,O,this.conversionApi)}for(let V of E.getAttributeKeys()){const R={selection:E,key:V,value:E.getAttribute(V)};O.test(E,'selectionAttribute:'+R.key)&&this.fire('selectionAttribute:'+R.key,R,O,this.conversionApi)}}convertMarker(E,S,O){if(O.root.document&&'$graveyard'!=O.root.rootName){const V=this._createMarkerConsumable(E,O);this.fire(E+':'+S,{name:S,range:O},V,this.conversionApi)}}_createInsertConsumable(E){const S=new d.a;for(let O of E){const V=O.item;S.add(V,'insert');for(let R of V.getAttributeKeys())S.add(V,'addAttribute:'+R)}return S}_createConsumableForRange(E,S){const O=new d.a;for(let V of E.getItems())O.add(V,S);return O}_createSelectionConsumable(E,S){const O=new d.a;O.add(E,'selection');for(let V of S)O.add(E,'selectionMarker:'+V.name);for(let V of E.getAttributeKeys())O.add(E,'selectionAttribute:'+V);return O}_createMarkerConsumable(E,S){const O=new d.a;return O.add(S,E),O}_testAndFire(E,S,O){if(O.test(S.item,E)){const V=S.item.name||'$text';this.fire(E+':'+V,S,O,this.conversionApi)}}}r.a=T,s.i(C.a)(T,w.a)},function(o,r,s){'use strict';var d=s(299),u=s(162),f=s(58);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(){this._domParser=new DOMParser,this._domConverter=new u.a({blockFiller:f.a}),this._htmlWriter=new d.a}toData(w){const C=this._domConverter.viewToDom(w,document);return this._htmlWriter.getHtml(C)}toView(w){const C=this._toDom(w);return this._domConverter.domToView(C)}_toDom(w){const C=this._domParser.parseFromString(w,'text/html'),P=C.createDocumentFragment(),T=C.body.childNodes;for(;0<T.length;)P.appendChild(T[0]);return P}}},function(o,r,s){'use strict';function d(R,F,N,I){I instanceof S.a?f(R,R.document,F,N,I):u(R,R.document,F,N,I)}function u(R,F,N,I,M){const D=M.getAttribute(N);let L,q;const z=M.is('rootElement')?new V:new O;D!=I&&(R.addDelta(z),M.is('rootElement')?q=new T.a(M,N,D,I,F.version):(L=M.is('element')?new S.a(E.a.createBefore(M),E.a.createFromParentAndOffset(M,0)):new S.a(E.a.createBefore(M),E.a.createAfter(M)),q=new P.a(L,N,D,I,F.version)),z.addOperation(q),F.applyOperation(q))}function f(R,F,N,I,M){function D(){0===L.operations.length&&R.addDelta(L);let H=new S.a(q,z);const W=new P.a(H,N,K,I,F.version);L.addOperation(W),F.applyOperation(W)}const L=new O;let q=M.start,z,K,$;for(let H of M)$=H.item.getAttribute(N),z&&K!=$&&(K!=I&&D(),q=z),z=H.nextPosition,K=$;z instanceof E.a&&z!=q&&K!=I&&D()}var h=s(19),w=s(17),C=s(16),P=s(68),T=s(109),E=s(1),S=s(3);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class O extends h.a{get type(){return'attribute'}get key(){return this.operations[0]?this.operations[0].key:null}get value(){return this.operations[0]?this.operations[0].newValue:null}get range(){if(this._range)return this._range;let R=null,F=null;for(let N of this.operations)(null==R||R.isAfter(N.range.start))&&(R=N.range.start),(null==F||F.isBefore(N.range.end))&&(F=N.range.end);return R&&F?(this._range=new S.a(R,F),this._range):null}get _reverseDeltaClass(){return O}static get className(){return'engine.model.delta.AttributeDelta'}static get _priority(){return 20}}r.a=O;class V extends h.a{static get className(){return'engine.model.delta.RootAttributeDelta'}}s.i(C.b)('setAttribute',function(R,F,N){return d(this,F,N,R),this}),s.i(C.b)('removeAttribute',function(R,F){return d(this,F,null,R),this}),w.a.register(O),w.a.register(V)},function(o,r,s){'use strict';function d(S,O,V){O.addOperation(V),S.document.applyOperation(V)}var u=s(19),f=s(17),h=s(16),w=s(108),C=s(5),P=s(1),T=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class E extends u.a{get type(){return'rename'}get _reverseDeltaClass(){return E}static get className(){return'engine.model.delta.RenameDelta'}}r.a=E,s.i(h.b)('rename',function(S,O){if(!(S instanceof C.a))throw new T.a('batch-rename-not-element-instance: Trying to rename an object which is not an instance of Element.');const V=new E;return this.addDelta(V),d(this,V,new w.a(P.a.createBefore(S),S.name,O,this.document.version)),this}),f.a.register(E)},function(o,r,s){'use strict';var d=s(98),u=s(16),f=s(17),h=s(37),w=s(20);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends d.a{static get className(){return'engine.model.delta.WeakInsertDelta'}}r.a=C,s.i(u.b)('weakInsert',function(P,T){const E=new C;this.addDelta(E),T=s.i(w.b)(T);for(let O of T)O.setAttributesTo(this.document.selection.getAttributes());const S=new h.a(P,T,this.document.version);return E.addOperation(S),this.document.applyOperation(S),this}),f.a.register(C)},function(o,r,s){'use strict';function d(){const E=new Set(['insert','move','remove','reinsert']);this.listenTo(this.root.document,'change',(S,O,V)=>{E.has(O)&&u.call(this,O,V.range,V.sourcePosition)},{priority:'high'})}function u(E,S,O){let V=S.end.offset-S.start.offset,R;switch(E){case'insert':let F='sticksToNext'==this.stickiness;R=this._getTransformedByInsertion(S.start,V,F);break;case'move':case'remove':case'reinsert':let N=h.a.createFromPositionAndShift(O,V),I=N.containsPosition(this)||N.start.isEqual(this)&&'sticksToNext'==this.stickiness||N.end.isEqual(this)&&'sticksToPrevious'==this.stickiness;if(I)R=this._getCombined(O,S.start);else{let M='sticksToNext'==this.stickiness;R=this._getTransformedByMove(O,S.start,V,M)}}if(!this.isEqual(R)){const F=f.a.createFromPosition(this);this.path=R.path,this.root=R.root,this.fire('change',F)}}var f=s(1),h=s(3),w=s(7),C=s(4),P=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class T extends f.a{constructor(E,S,O){if(super(E,S),!this.root.is('rootElement'))throw new P.a('model-liveposition-root-not-rootelement: LivePosition root has to be an instance of RootElement.');this.stickiness=O||'sticksToNext',d.call(this)}detach(){this.stopListening()}}r.a=T,s.i(C.a)(T,w.a)},function(o,r,s){'use strict';function d(){const P=new Set(['insert','move','remove','reinsert']);this.listenTo(this.root.document,'change',(T,E,S,O,V)=>{P.has(E)&&u.call(this,E,V,S.range,S.sourcePosition)},{priority:'high'})}function u(P,T,E,S){const O=E.end.offset-E.start.offset;let V=E.start;'move'==P&&(V=V._getTransformedByInsertion(S,O));const R=this._getTransformedByDocumentChange(P,T,V,O,S);'move'==P&&3==R.length&&(R[2]=E);const F=f.a.createFromRanges(R);if(!F.isEqual(this)){const N=f.a.createFromRange(this);this.start=F.start,this.end=F.end,this.fire('change',N)}}var f=s(3),h=s(7),w=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends f.a{constructor(P,T){super(P,T),d.call(this)}detach(){this.stopListening()}}r.a=C,s.i(w.a)(C,h.a)},function(o,r,s){'use strict';function d(F,N,I){let M=s.i(O.a)(F);return I&&(M=M.slice(M.indexOf(I)+1)),M.some((D)=>D.tagName&&N.includes(D.tagName.toLowerCase()))}var u=s(29),f=s(21),h=s(25),w=s(34),C=s(73),P=s(111),T=s(74),E=s(58),S=s(386),O=s(184),V=s(383);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(F={}){this.blockFiller=F.blockFiller||E.b,this.preElements=['pre'],this.blockElements=['p','div','h1','h2','h3','h4','h5','h6'],this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap}bindFakeSelection(F,N){this._fakeSelectionMapping.set(F,C.a.createFromSelection(N))}fakeSelectionToView(F){return this._fakeSelectionMapping.get(F)}bindElements(F,N){this._domToViewMapping.set(F,N),this._viewToDomMapping.set(N,F)}bindDocumentFragments(F,N){this._domToViewMapping.set(F,N),this._viewToDomMapping.set(N,F)}viewToDom(F,N,I={}){if(F.is('text')){const M=this._processDataFromViewText(F);return N.createTextNode(M)}if(this.getCorrespondingDom(F))return this.getCorrespondingDom(F);let M;if(F.is('documentFragment'))M=N.createDocumentFragment(),I.bind&&this.bindDocumentFragments(M,F);else{M=N.createElement(F.name),I.bind&&this.bindElements(M,F);for(let D of F.getAttributeKeys())M.setAttribute(D,F.getAttribute(D))}if(I.withChildren||void 0===I.withChildren)for(let D of this.viewChildrenToDom(F,N,I))M.appendChild(D);return M}*viewChildrenToDom(F,N,I={}){let M=F.getFillerOffset&&F.getFillerOffset(),D=0;for(let L of F.getChildren())M===D&&(yield this.blockFiller(N)),yield this.viewToDom(L,N,I),D++;M===D&&(yield this.blockFiller(N))}viewRangeToDom(F){const N=this.viewPositionToDom(F.start),I=this.viewPositionToDom(F.end),M=new Range;return M.setStart(N.parent,N.offset),M.setEnd(I.parent,I.offset),M}viewPositionToDom(F){const N=F.parent;if(N.is('text')){const I=this.getCorrespondingDomText(N);if(!I)return null;let M=F.offset;return s.i(E.c)(I)&&(M+=E.d),{parent:I,offset:M}}let I,M,D;if(0===F.offset){if(I=this.getCorrespondingDom(F.parent),!I)return null;D=I.childNodes[0]}else{if(M=this.getCorrespondingDom(F.nodeBefore),!M)return null;I=M.parentNode,D=M.nextSibling}if(this.isText(D)&&s.i(E.c)(D))return{parent:D,offset:E.d};const L=M?s.i(S.a)(M)+1:0;return{parent:I,offset:L}}domToView(F,N={}){if(s.i(E.e)(F,this.blockFiller))return null;if(this.isText(F)){if(s.i(E.f)(F))return null;const I=this._processDataFromDomText(F);return''===I?null:new u.a(I)}if(this.getCorrespondingView(F))return this.getCorrespondingView(F);let I;if(this.isDocumentFragment(F))I=new P.a,N.bind&&this.bindDocumentFragments(F,I);else{const M=N.keepOriginalCase?F.tagName:F.tagName.toLowerCase();I=new f.a(M),N.bind&&this.bindElements(F,I);const D=F.attributes;for(let L=D.length-1;0<=L;L--)I.setAttribute(D[L].name,D[L].value)}if(N.withChildren||void 0===N.withChildren)for(let M of this.domChildrenToView(F,N))I.appendChildren(M);return I}*domChildrenToView(F,N={}){for(let I=0;I<F.childNodes.length;I++){const M=F.childNodes[I],D=this.domToView(M,N);null!==D&&(yield D)}}domSelectionToView(F){if(1===F.rangeCount){let M=F.getRangeAt(0).startContainer;this.isText(M)&&(M=M.parentNode);const D=this.fakeSelectionToView(M);if(D)return D}const N=new C.a,I=this.isDomSelectionBackward(F);for(let M=0;M<F.rangeCount;M++){const D=F.getRangeAt(M),L=this.domRangeToView(D);L&&N.addRange(L,I)}return N}domRangeToView(F){const N=this.domPositionToView(F.startContainer,F.startOffset),I=this.domPositionToView(F.endContainer,F.endOffset);return N&&I?new w.a(N,I):null}domPositionToView(F,N){if(s.i(E.e)(F,this.blockFiller))return this.domPositionToView(F.parentNode,s.i(S.a)(F));if(this.isText(F)){if(s.i(E.f)(F))return this.domPositionToView(F.parentNode,s.i(S.a)(F));const I=this.getCorrespondingViewText(F);let M=N;return I?(s.i(E.c)(F)&&(M-=E.d,M=0>M?0:M),new h.a(I,M)):null}if(0===N){const I=this.getCorrespondingView(F);if(I)return new h.a(I,0)}else{const I=this.getCorrespondingView(F.childNodes[N-1]);if(I&&I.parent)return new h.a(I.parent,I.index+1)}return null}getCorrespondingView(F){if(this.isElement(F))return this.getCorrespondingViewElement(F);return this.isDocumentFragment(F)?this.getCorrespondingViewDocumentFragment(F):this.isText(F)?this.getCorrespondingViewText(F):null}getCorrespondingViewElement(F){return this._domToViewMapping.get(F)}getCorrespondingViewDocumentFragment(F){return this._domToViewMapping.get(F)}getCorrespondingViewText(F){if(s.i(E.f)(F))return null;const N=F.previousSibling;if(N){if(!this.isElement(N))return null;const I=this.getCorrespondingViewElement(N);if(I){const M=I.nextSibling;return M instanceof u.a?I.nextSibling:null}}else{const I=this.getCorrespondingViewElement(F.parentNode);if(I){const M=I.getChild(0);return M instanceof u.a?M:null}}return null}getCorrespondingDom(F){if(F instanceof f.a)return this.getCorrespondingDomElement(F);return F instanceof P.a?this.getCorrespondingDomDocumentFragment(F):F instanceof u.a?this.getCorrespondingDomText(F):null}getCorrespondingDomElement(F){return this._viewToDomMapping.get(F)}getCorrespondingDomDocumentFragment(F){return this._viewToDomMapping.get(F)}getCorrespondingDomText(F){const N=F.previousSibling;return N&&this.getCorrespondingDom(N)?this.getCorrespondingDom(N).nextSibling:!N&&F.parent&&this.getCorrespondingDom(F.parent)?this.getCorrespondingDom(F.parent).childNodes[0]:null}focus(F){const N=this.getCorrespondingDomElement(F);N&&N.ownerDocument.activeElement!==N&&N.focus()}isText(F){return F&&F.nodeType==Node.TEXT_NODE}isElement(F){return F&&F.nodeType==Node.ELEMENT_NODE}isDocumentFragment(F){return F&&F.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isDomSelectionBackward(F){if(F.isCollapsed)return!1;const N=new Range;N.setStart(F.anchorNode,F.anchorOffset),N.setEnd(F.focusNode,F.focusOffset);const I=N.collapsed;return N.detach(),I}_processDataFromViewText(F){let N=F.data;if(F.getAncestors().some((q)=>this.preElements.includes(q.name)))return N;const I=this._getTouchingViewTextNode(F,!1),M=this._getTouchingViewTextNode(F,!0);let D=N.match(/ *$/)[0],L=N.substr(0,N.length-D.length);if(I&&' '!=I.data.charAt(I.data.length-1)||(L=L.replace(/^ /,'\\xA0')),L=L.replace(/  /g,' \\xA0'),0<D.length){let q=!1;M?(' '==M.data.charAt(0)||'\\xA0'==M.data.charAt(0))&&0==D.length%2&&(q=!0):D.length%2&&(q=!0),q&&(D='\\xA0'+D.substr(0,D.length-1)),D=D.replace(/  /g,' \\xA0')}return L+D}_getTouchingViewTextNode(F,N){if(!F.parent)return null;const I=new T.a({startPosition:N?h.a.createAfter(F):h.a.createBefore(F),direction:N?'forward':'backward'});for(let M of I){if(M.item.is('containerElement'))return null;if(M.item.is('text'))return M.item}return null}_processDataFromDomText(F){let N=s.i(E.g)(F);if(d(F,this.preElements))return N;N=N.replace(/[^\\S\\u00A0]{2,}/g,' ');const I=this._getTouchingDomTextNode(F,!1),M=this._getTouchingDomTextNode(F,!0);return(!I||/[^\\S\\u00A0]/.test(I.data.charAt(I.data.length-1)))&&(N=N.replace(/^ /,'')),M||(N=N.replace(/ $/,'')),N=N.replace(/ \\u00A0/g,'  '),(!I||/[^\\S\\u00A0]/.test(I.data.charAt(I.data.length-1)))&&(N=N.replace(/^\\u00A0/,' ')),M&&'\\xA0'!=M.data.charAt(0)||(N=N.replace(/\\u00A0( *)$/,' $1')),N}_getTouchingDomTextNode(F,N){if(!F.parentNode)return null;const I=N?'nextNode':'previousNode',M=F.ownerDocument,D=M.createTreeWalker(M.childNodes[0],NodeFilter.SHOW_TEXT);D.currentNode=F;const L=D[I]();if(null!==L){const q=s.i(V.a)(F,L);if(q&&!d(F,this.blockElements,q)&&!d(L,this.blockElements,q))return L}return null}}},function(o,r,s){'use strict';function d(){return null}var u=s(21),f=s(0),h=s(72);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends u.a{constructor(C,P,T){super(C,P,T),this.getFillerOffset=d}is(C,P=null){return P?'emptyElement'==C&&P==this.name||super.is(C,P):'emptyElement'==C||super.is(C)}insertChildren(C,P){if(P&&(P instanceof h.a||0<Array.from(P).length))throw new f.a('view-emptyelement-cannot-add: Cannot add child nodes to EmptyElement instance.')}}r.a=w},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function d(P,T){if('function'==typeof T)return T(P);const E={};return T.name&&(E.name=u(T.name,P.name),!E.name)?null:T.attribute&&(E.attribute=f(T.attribute,P),!E.attribute)?null:T.class&&(E.class=h(T.class,P),!E.class)?!1:T.style&&(E.style=w(T.style,P),!E.style)?!1:E}function u(P,T){return P instanceof RegExp?P.test(T):P===T}function f(P,T){const E=[];for(let S in P){const O=P[S];if(T.hasAttribute(S)){const V=T.getAttribute(S);if(O instanceof RegExp){if(O.test(V))E.push(S);else return null;}else if(V===O)E.push(S);else return null}else return null}return E}function h(P,T){const E=[];for(let S of P)if(S instanceof RegExp){const O=T.getClassNames();for(let V of O)S.test(V)&&E.push(V);if(0===E.length)return null}else if(T.hasClass(S))E.push(S);else return null;return E}function w(P,T){const E=[];for(let S in P){const O=P[S];if(T.hasStyle(S)){const V=T.getStyle(S);if(O instanceof RegExp){if(O.test(V))E.push(S);else return null;}else if(V===O)E.push(S);else return null}else return null}return E}r.a=class{constructor(...P){this._patterns=[],this.add(...P)}add(...P){for(let T of P)('string'==typeof T||T instanceof RegExp)&&(T={name:T}),T.class&&('string'==typeof T.class||T.class instanceof RegExp)&&(T.class=[T.class]),this._patterns.push(T)}match(...P){for(let T of P)for(let E of this._patterns){const S=d(T,E);if(S)return{element:T,pattern:E,match:S}}return null}matchAll(...P){const T=[];for(let E of P)for(let S of this._patterns){const O=d(E,S);O&&T.push({element:E,pattern:S,match:O})}return 0<T.length?T:null}getElementName(){if(1!==this._patterns.length)return null;const P=this._patterns[0],T=P.name;return'function'!=typeof P&&T&&!(T instanceof RegExp)?T:null}}},function(o,r,s){'use strict';var d=s(48),u=s(73),f=s(58);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{constructor(w){super(w),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=w.domConverter,this.renderer=w.renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(w){this._domElements.push(w),this.isEnabled&&this._mutationObserver.observe(w,this._config)}enable(){super.enable();for(let w of this._domElements)this._mutationObserver.observe(w,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(w){if(0===w.length)return;const C=this.domConverter,P=new Map,T=new Set;for(let V of w)if('childList'===V.type){const R=C.getCorrespondingViewElement(V.target);R&&T.add(R)}for(let V of w)if('characterData'===V.type){const R=C.getCorrespondingViewText(V.target);R&&!T.has(R.parent)?P.set(R,{type:'text',oldText:R.data,newText:s.i(f.g)(V.target),node:R}):!R&&s.i(f.c)(V.target)&&T.add(C.getCorrespondingViewElement(V.target.parentNode))}const E=[];for(let V of P.values())this.renderer.markToSync('text',V.node),E.push(V);for(let V of T){const R=C.getCorrespondingDomElement(V),F=V.getChildren(),N=C.domChildrenToView(R);this.renderer.markToSync('children',V),E.push({type:'children',oldChildren:Array.from(F),newChildren:Array.from(N),node:V})}const S=w[0].target.ownerDocument.getSelection();let O=null;if(S&&S.anchorNode){const V=C.domPositionToView(S.anchorNode,S.anchorOffset),R=C.domPositionToView(S.focusNode,S.focusOffset);V&&R&&(O=new u.a,O.collapse(V),O.setFocus(R))}this.document.fire('mutations',E,O),this.document.render()}}r.a=h},function(o,r,s){'use strict';var d=s(71);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const u=Symbol('rootName');class f extends d.a{constructor(h){super(h),this.rootName='main'}is(h,w=null){return w?'rootElement'==h&&w==this.name||super.is(h,w):'rootElement'==h||super.is(h)}get rootName(){return this.getCustomProperty(u)}set rootName(h){this.setCustomProperty(u,h)}}r.a=f},function(o,r,s){'use strict';function d(){return null}var u=s(21),f=s(0),h=s(72);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends u.a{constructor(C,P,T){super(C,P,T),this.getFillerOffset=d}is(C,P=null){return P?'uiElement'==C&&P==this.name||super.is(C,P):'uiElement'==C||super.is(C)}insertChildren(C,P){if(P&&(P instanceof h.a||0<Array.from(P).length))throw new f.a('view-uielement-cannot-add: Cannot add child nodes to UIElement instance.')}}r.a=w},function(o,r,s){'use strict';function d(){return new P.a('figure',{class:'image'},new T.a('img'))}var u=s(2),f=s(45),h=s(171),w=s(327),C=s(40),P=s(39),T=s(163);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class E extends u.a{static get requires(){return[h.a]}init(){const S=this.editor,O=S.document,V=O.schema,R=S.data,F=S.editing,N=S.t;V.registerItem('image'),V.requireAttributes('image',['src']),V.allow({name:'image',attributes:['alt','src'],inside:'$root'}),V.objects.add('image'),s.i(f.a)().for(R.modelToView).fromElement('image').toElement(()=>d()),s.i(f.a)().for(F.modelToView).fromElement('image').toElement(()=>s.i(C.c)(d(),N('image widget'))),s.i(w.a)([F.modelToView,R.modelToView],'src'),s.i(w.a)([F.modelToView,R.modelToView],'alt'),R.viewToModel.on('element:figure',s.i(w.b)())}}r.a=E},function(o,r,s){'use strict';var d=s(489),u=s(60),f=s(180),h=s(40);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const w=f.a.arrowVerticalOffset,C={south(T,E){return{top:T.bottom+w,left:T.left+T.width/2-E.width/2,name:'s'}},north(T,E){return{top:T.top-E.height-w,left:T.left+T.width/2-E.width/2,name:'n'}}};class P extends f.a{constructor(T){super(T.locale),this.editor=T;const E=T.editing.view;this.listenTo(T.ui.focusTracker,'change:isFocused',(S,O,V,R)=>{R&&!V&&this.detach()}),T.listenTo(E,'render',()=>{const S=E.selection.getSelectedElement();S&&s.i(h.a)(S)||this.detach()},{priority:'low'}),this._throttledAttach=s.i(d.a)(()=>{this._attach()},100)}init(){return this.editor.ui.focusTracker.add(this.element),super.init()}attach(){this._attach(),this.editor.ui.view.listenTo(u.a.window,'scroll',this._throttledAttach),this.editor.ui.view.listenTo(u.a.window,'resize',this._throttledAttach)}detach(){this.hide(),this.editor.ui.view.stopListening(u.a.window,'scroll',this._throttledAttach),this.editor.ui.view.stopListening(u.a.window,'resize',this._throttledAttach)}_attach(){const T=this.editor.editing.view;this.attachTo({target:T.domConverter.viewRangeToDom(T.selection.getFirstRange()),positions:[C.north,C.south]})}}r.a=P},function(o,r,s){'use strict';var d=s(6),u=s(2),f=s(181),h=s(40),w=s(169);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends u.a{constructor(P){super(P),P.config.set('image.defaultToolbar',[]),this.isEnabled=!0}afterInit(){const P=this.editor,T=P.config.get('image.toolbar')||P.config.get('image.defaultToolbar');if(T.length){const E=this._panel=new w.a(P),S=[],O=new f.a;return d.a.extend(E.template,{attributes:{class:['ck-toolbar__container']}}),S.push(E.content.add(O)),S.push(O.fillFromConfig(T,P.ui.componentFactory)),S.push(P.ui.view.body.add(E)),this.listenTo(this.editor.editing.view,'render',()=>{this.isEnabled&&this.show()},{priority:'low'}),this.listenTo(P.ui.focusTracker,'change:isFocused',(V,R,F,N)=>{!N&&F&&this.isEnabled&&this.show()}),Promise.all(S)}}show(){const P=this.editor.editing.view.selection.getSelectedElement();P&&s.i(h.a)(P)&&this._panel.attach()}hide(){this._panel.detach()}}r.a=C},function(o,r,s){'use strict';var d=s(2),u=s(113);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{init(){let h;this.editor.editing.modelToView.on('selection',(w,C,P,T)=>{h&&h.hasClass(u.c)&&h.removeClass(u.c);const E=T.viewSelection,S=E.getSelectedElement();S&&s.i(u.b)(S)&&(E.setFake(!0,{label:s.i(u.d)(S)}),S.addClass(u.c),h=S)},{priority:'low'})}}r.a=f},function(o,r,s){'use strict';function u(w,C,P){let T=w.textNode||(P?w.nodeBefore:w.nodeAfter),E=null;for(;T&&T.getAttribute('linkHref')==C;)E=T,T=P?T.previousSibling:T.nextSibling;return E?h.a.createAt(E,P?'before':'after'):w}/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */var f=s(3),h=s(1);r.a=function(w,C){return new f.a(u(w,C,!0),u(w,C,!1))}},function(o,r,s){'use strict';var d=s(110);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{}r.a=u},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){return Array.from(u.getAncestors()).find((f)=>'listItem'==f.name)||null}},function(o,r,s){'use strict';var d=s(182);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u{constructor(f,h=20){this.document=f,this.size=0,this.limit=h,this.isLocked=!1,this._changeCallback=(w,C,P,T)=>{this._onBatch(T)},this._selectionChangeCallback=()=>{this._reset()},f.on('change',this._changeCallback),f.selection.on('change:range',this._selectionChangeCallback),f.selection.on('change:attribute',this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.document.batch()),this._batch}input(f){this.size+=f,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.document.off('change',this._changeCallback),this.document.selection.off('change:range',this._selectionChangeCallback),this.document.selection.off('change:attribute',this._selectionChangeCallback)}_onBatch(f){'transparent'!=f.type&&f!==this._batch&&1>=s.i(d.a)(f.getOperations())&&this._reset(!0)}_reset(f){(!this.isLocked||f)&&(this._batch=null,this.size=0)}}r.a=u},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function({emitter:u,activator:f,callback:h,contextElement:w}){u.listenTo(document,'mouseup',(C,{target:P})=>{f()&&!w.contains(P)&&h()})}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function({view:u}){u.listenTo(u.element,'submit',(f,h)=>{h.preventDefault(),u.fire('submit')},{useCapture:!0})}},function(o,r,s){'use strict';var d=s(9),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.set('value'),this.set('id');const w=this.bindTemplate;this.template=new u.a({tag:'input',attributes:{type:'text',class:['ck-input','ck-input-text'],id:w.to('id')}}),this.on('change:value',(C,P,T)=>this.element.value=T||'')}select(){this.element.select()}focus(){this.element.focus()}}r.a=f},function(o,r,s){'use strict';var d=s(9),u=s(6),f=s(66),h=s(370);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends d.a{constructor(C,P){super(C);const T=`ck-input-${s.i(f.a)()}`;this.set('label'),this.set('value'),this.labelView=this._createLabelView(T),this.inputView=this._createInputView(P,T),this.template=new u.a({tag:'div',children:[this.labelView,this.inputView]})}_createLabelView(C){const P=new h.a(this.locale);return P.for=C,P.bind('text').to(this,'label'),P}_createInputView(C,P){const T=new C(this.locale);return T.id=P,T.bind('value').to(this),T}select(){this.inputView.select()}focus(){this.inputView.focus()}}r.a=w},function(o,r,s){'use strict';var d=s(9),u=s(6),f=s(389),h=s(185);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const w=s.i(h.a)('px');class C extends d.a{constructor(P){super(P);const T=this.bindTemplate;this.set('top',0),this.set('left',0),this.set('position','se'),this.set('isVisible',!1),this.content=this.createCollection(),this.template=new u.a({tag:'div',attributes:{class:['ck-balloon-panel',T.to('position',(E)=>`ck-balloon-panel_arrow_${E}`),T.if('isVisible','ck-balloon-panel_visible')],style:{top:T.to('top',w),left:T.to('left',w),maxWidth:T.to('maxWidth',w)},tabindex:-1},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(P){this.show();const T=C.defaultPositions,E=Object.assign({},{element:this.element,positions:[T.se,T.sw,T.ne,T.nw],limiter:document.body,fitInViewport:!0},P),{top:S,left:O,name:V}=s.i(f.a)(E);Object.assign(this,{top:S,left:O,position:V})}}r.a=C,C.arrowHorizontalOffset=30,C.arrowVerticalOffset=15,C.defaultPositions={se:(P)=>({top:P.bottom+C.arrowVerticalOffset,left:P.left+P.width/2-C.arrowHorizontalOffset,name:'se'}),sw:(P,T)=>({top:P.bottom+C.arrowVerticalOffset,left:P.left+P.width/2-T.width+C.arrowHorizontalOffset,name:'sw'}),ne:(P,T)=>({top:P.top-T.height-C.arrowVerticalOffset,left:P.left+P.width/2-C.arrowHorizontalOffset,name:'ne'}),nw:(P,T)=>({top:P.top-T.height-C.arrowVerticalOffset,left:P.left+P.width/2-T.width+C.arrowHorizontalOffset,name:'nw'})}},function(o,r,s){'use strict';var d=s(9),u=s(6),f=s(61),h=s(115),w=s(62),C=s(376);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P extends d.a{constructor(T){super(T),this.items=this.createCollection(),this.focusTracker=new f.a,this.keystrokes=new w.a,this._focusCycler=new h.a({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:['arrowleft','arrowup'],focusNext:['arrowright','arrowdown']}}),this.template=new u.a({tag:'div',attributes:{class:['ck-toolbar']},children:this.items}),this.items.on('add',(E,S)=>{this.focusTracker.add(S.element)}),this.items.on('remove',(E,S)=>{this.focusTracker.remove(S.element)})}init(){return this.keystrokes.listenTo(this.element),super.init()}focus(){this._focusCycler.focusFirst()}fillFromConfig(T,E){return T?Promise.all(T.map((S)=>{const O='|'==S?new C.a:E.create(S);return this.items.add(O)})):Promise.resolve()}}r.a=P},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){let f=0;for(let h of u)f++;return f}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u,f,h){function w(N){const I=(V[N-1]===void 0?-1:V[N-1])+1,M=V[N+1]===void 0?-1:V[N+1],D=I>M?-1:1;O[N+D]&&(O[N]=O[N+D].slice(0)),O[N]||(O[N]=[]),O[N].push(I>M?C:P);let L=_Mathmax(I,M),q=L-N;for(;q<T&&L<E&&h(u[q],f[L]);)q++,L++,O[N].push('equal');return L}h=h||function(N,I){return N===I};let C,P;if(f.length<u.length){let N=u;u=f,f=N,C='delete',P='insert'}else C='insert',P='delete';const T=u.length,E=f.length,S=E-T,O={},V={};let R=0,F;do{for(F=-R;F<S;F++)V[F]=w(F);for(F=S+R;F>S;F--)V[F]=w(F);V[S]=w(S),R++}while(V[S]!==E);return O[S].slice(1)}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){const f=[];for(;u&&u.nodeType!=Node.DOCUMENT_NODE;)f.unshift(u),u=u.parentNode;return f}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){return(f)=>f+u}},function(o,r,s){'use strict';var d=s(50),u=s(30),f=s.i(d.a)(u.a,'Map');r.a=f},function(o,r,s){'use strict';var d=s(50),u=s(30),f=s.i(d.a)(u.a,'Set');r.a=f},function(o,r,s){'use strict';var d=s(30),u=d.a.Uint8Array;r.a=u},function(o,r){'use strict';r.a=function(u,f,h){var w=h.length;return 0===w?u.call(f):1===w?u.call(f,h[0]):2===w?u.call(f,h[0],h[1]):3===w?u.call(f,h[0],h[1],h[2]):u.apply(f,h)}},function(o,r){'use strict';r.a=function(u,f,h,w){var C=-1,P=u.length;for(w&&P&&(h=u[++C]);++C<P;)h=f(h,u[C],C,u);return h}},function(o,r,s){'use strict';function d(ge,pe,fe,he,be,_e,ye){var ve;if(he&&(ve=_e?he(ge,be,_e,ye):he(ge)),void 0!==ve)return ve;if(!s.i(M.a)(ge))return ge;var we=s.i(F.a)(ge);if(!we){var ke=s.i(S.a)(ge),xe=ke==H||ke==W;if(s.i(N.a)(ge))return s.i(C.a)(ge,pe);if(ke==G||ke==L||xe&&!_e){if(s.i(I.a)(ge))return _e?ge:{};if(ve=s.i(R.a)(xe?{}:ge),!pe)return s.i(T.a)(ge,s.i(w.a)(ve,ge))}else{if(!me[ke])return _e?ge:{};ve=s.i(V.a)(ge,ke,d,pe)}}else if(ve=s.i(O.a)(ge),!pe)return s.i(P.a)(ge,ve);ye||(ye=new u.a);var Ce=ye.get(ge);if(Ce)return Ce;if(ye.set(ge,ve),!we)var Pe=fe?s.i(E.a)(ge):s.i(D.a)(ge);return s.i(f.a)(Pe||ge,function(Te,Ae){Pe&&(Ae=Te,Te=ge[Ae]),s.i(h.a)(ve,Ae,d(Te,pe,fe,he,Ae,ge,ye))}),ve}var u=s(119),f=s(403),h=s(63),w=s(405),C=s(425),P=s(198),T=s(433),E=s(439),S=s(137),O=s(448),V=s(449),R=s(450),F=s(11),N=s(480),I=s(87),M=s(14),D=s(65),L='[object Arguments]',H='[object Function]',W='[object GeneratorFunction]',G='[object Object]',me={};me[L]=me['[object Array]']=me['[object ArrayBuffer]']=me['[object DataView]']=me['[object Boolean]']=me['[object Date]']=me['[object Float32Array]']=me['[object Float64Array]']=me['[object Int8Array]']=me['[object Int16Array]']=me['[object Int32Array]']=me['[object Map]']=me['[object Number]']=me[G]=me['[object RegExp]']=me['[object Set]']=me['[object String]']=me['[object Symbol]']=me['[object Uint8Array]']=me['[object Uint8ClampedArray]']=me['[object Uint16Array]']=me['[object Uint32Array]']=!0,me['[object Error]']=me[H]=me['[object WeakMap]']=!1,r.a=d},function(o,r){'use strict';r.a=function(u,f,h){for(var w=u.length,C=h?w:-1;h?C--:++C<w;)if(f(u[C],C,u))return C;return-1}},function(o,r,s){'use strict';var u=s(136),f=Object.prototype,h=f.hasOwnProperty;r.a=function(w,C){return h.call(w,C)||'object'==typeof w&&C in w&&null===s.i(u.a)(w)}},function(o,r,s){'use strict';var u=s(85),f=s(36),h=s(51),w=s(18),C=s(464),P=s(52),T=Array.prototype,E=T.splice;r.a=function(S,O){for(var V=S?O.length:0,R=V-1,F;V--;)if(F=O[V],V==R||F!==N){var N=F;if(s.i(f.a)(F))E.call(S,F,1);else if(!s.i(h.a)(F,S)){var I=s.i(u.a)(F),M=s.i(C.a)(S,I);null!=M&&delete M[s.i(P.a)(s.i(w.a)(I))]}else delete S[s.i(P.a)(F)]}return S}},function(o,r,s){'use strict';var u=s(53);r.a=function(f,h){for(var w=-1,C=f.length,P=0,T=[];++w<C;){var E=f[w],S=h?h(E):E;if(!w||!s.i(u.a)(S,O)){var O=S;T[P++]=0===E?0:E}}return T}},function(o,r){'use strict';r.a=function(u,f){for(var h=-1,w=Array(u);++h<u;)w[h]=f(h);return w}},function(o,r){'use strict';r.a=function(u,f,h){for(var w=-1,C=u.length,P=f.length,T={},E;++w<C;)E=w<P?f[w]:void 0,h(T,u[w],E);return T}},function(o,r){'use strict';r.a=function(u,f){var h=-1,w=u.length;for(f||(f=Array(w));++h<w;)f[h]=u[h];return f}},function(o,r,s){'use strict';var u=s(79),f=s(404);r.a=function(C,P,T,E,S,O){var V=S&2,R=C.length,F=P.length;if(R!=F&&!(V&&F>R))return!1;var N=O.get(C);if(N)return N==P;var I=-1,M=!0,D=S&1?new u.a:void 0;for(O.set(C,P);++I<R;){var L=C[I],q=P[I];if(E)var z=V?E(q,L,I,P,C,O):E(L,q,I,C,P,O);if(void 0!==z){if(z)continue;M=!1;break}if(D){if(!s.i(f.a)(P,function(K,$){if(!D.has($)&&(L===K||T(L,K,E,S,O)))return D.add($)})){M=!1;break}}else if(!(L===q||T(L,q,E,S,O))){M=!1;break}}return O['delete'](C),M}},function(o,r){'use strict';function d(f){return u(Object(f))}var u=Object.getOwnPropertySymbols;u||(d=function(){return[]}),r.a=d},function(o,r,s){'use strict';var u=s(196),f=s(143),h=s(11),w=s(94),C=s(145);r.a=function(P){var T=P?P.length:void 0;return s.i(w.a)(T)&&(s.i(h.a)(P)||s.i(C.a)(P)||s.i(f.a)(P))?s.i(u.a)(T,String):null}},function(o,r){'use strict';r.a=function(u,f,h){for(var w=u.length,C=f+(h?0:-1),P;h?C--:++C<w;)if(P=u[C],P!==P)return C;return-1}},function(o,r,s){'use strict';var u=s(14);r.a=function(f){return f===f&&!s.i(u.a)(f)}},function(o,r){'use strict';r.a=function(u,f){return function(h){return null!=h&&h[u]===f&&(f!==void 0||u in Object(h))}}},function(o,r){'use strict';var u=Function.prototype.toString;r.a=function(f){if(null!=f){try{return u.call(f)}catch(h){}try{return f+''}catch(h){}}return''}},function(o,r,s){'use strict';var u=s(35),f=s(88),h=s(15),w=Math.ceil;r.a=function(P,T,E){T=(E?s.i(f.a)(P,T,E):void 0===T)?1:_Mathmax(s.i(h.a)(T),0);var S=P?P.length:0;if(!S||1>T)return[];for(var O=0,V=0,R=Array(w(S/T));O<S;)R[V++]=s.i(u.a)(P,O,O+=T);return R}},function(o,r){'use strict';r.a=function(u){for(var f=-1,h=u?u.length:0,w=0,C=[],P;++f<h;)P=u[f],P&&(C[w++]=P);return C}},function(o,r,s){'use strict';var u=s(81),f=s(23),h=s(198),w=s(11);r.a=function(){for(var C=arguments.length,P=Array(C?C-1:0),T=arguments[0],E=C;E--;)P[E-1]=arguments[E];return C?s.i(u.a)(s.i(w.a)(T)?s.i(h.a)(T):[T],s.i(f.a)(P,1)):[]}},function(o,r,s){'use strict';var d=s(64),u=s(23),f=s(13),h=s(8),w=s.i(h.a)(function(C,P){return s.i(f.a)(C)?s.i(d.a)(C,s.i(u.a)(P,1,f.a,!0)):[]});r.a=w},function(o,r,s){'use strict';var d=s(64),u=s(23),f=s(10),h=s(13),w=s(18),C=s(8),P=s.i(C.a)(function(T,E){var S=s.i(w.a)(E);return s.i(h.a)(S)&&(S=void 0),s.i(h.a)(T)?s.i(d.a)(T,s.i(u.a)(E,1,h.a,!0),s.i(f.a)(S)):[]});r.a=P},function(o,r,s){'use strict';var d=s(64),u=s(23),f=s(13),h=s(18),w=s(8),C=s.i(w.a)(function(P,T){var E=s.i(h.a)(T);return s.i(f.a)(E)&&(E=void 0),s.i(f.a)(P)?s.i(d.a)(P,s.i(u.a)(T,1,f.a,!0),void 0,E):[]});r.a=C},function(o,r,s){'use strict';var u=s(10),f=s(84);r.a=function(h,w){return h&&h.length?s.i(f.a)(h,s.i(u.a)(w,3),!0,!0):[]}},function(o,r,s){'use strict';var u=s(10),f=s(84);r.a=function(h,w){return h&&h.length?s.i(f.a)(h,s.i(u.a)(w,3),!0):[]}},function(o,r,s){'use strict';var u=s(409),f=s(88);r.a=function(h,w,C,P){var T=h?h.length:0;return T?(C&&'number'!=typeof C&&s.i(f.a)(h,w,C)&&(C=0,P=T),s.i(u.a)(h,w,C,P)):[]}},function(o,r,s){'use strict';var u=s(192),f=s(10);r.a=function(h,w){return h&&h.length?s.i(u.a)(h,s.i(f.a)(w,3)):-1}},function(o,r,s){'use strict';var u=s(192),f=s(10);r.a=function(h,w){return h&&h.length?s.i(u.a)(h,s.i(f.a)(w,3),!0):-1}},function(o,r,s){'use strict';var d=s(142);s.d(r,'a',function(){return d.a})},function(o,r,s){'use strict';var u=s(23);r.a=function(f){var h=f?f.length:0;return h?s.i(u.a)(f,1):[]}},function(o,r,s){'use strict';var u=s(23);r.a=function(h){var w=h?h.length:0;return w?s.i(u.a)(h,1/0):[]}},function(o,r,s){'use strict';var u=s(23),f=s(15);r.a=function(h,w){var C=h?h.length:0;return C?(w=void 0===w?1:s.i(f.a)(w),s.i(u.a)(h,w)):[]}},function(o,r){'use strict';r.a=function(u){for(var f=-1,h=u?u.length:0,w={},C;++f<h;)C=u[f],w[C[0]]=C[1];return w}},function(o,r,s){'use strict';var u=s(123);r.a=function(f,h,w){var C=null==f?void 0:s.i(u.a)(f,h);return C===void 0?w:C}},function(o,r){'use strict';r.a=function(u){return u}},function(o,r,s){'use strict';var u=s(124),f=s(15);r.a=function(w,C,P){var T=w?w.length:0;return T?(P=s.i(f.a)(P),0>P&&(P=_Mathmax(T+P,0)),s.i(u.a)(w,C,P)):-1}},function(o,r,s){'use strict';var u=s(141);r.a=function(f){return s.i(u.a)(f,1)}},function(o,r,s){'use strict';var d=s(27),u=s(125),f=s(133),h=s(8),w=s.i(h.a)(function(C){var P=s.i(d.a)(C,f.a);return P.length&&P[0]===C[0]?s.i(u.a)(P):[]});r.a=w},function(o,r,s){'use strict';var d=s(27),u=s(125),f=s(10),h=s(133),w=s(18),C=s(8),P=s.i(C.a)(function(T){var E=s.i(w.a)(T),S=s.i(d.a)(T,h.a);return E===s.i(w.a)(S)?E=void 0:S.pop(),S.length&&S[0]===T[0]?s.i(u.a)(S,s.i(f.a)(E)):[]});r.a=P},function(o,r,s){'use strict';var d=s(27),u=s(125),f=s(133),h=s(18),w=s(8),C=s.i(w.a)(function(P){var T=s.i(h.a)(P),E=s.i(d.a)(P,f.a);return T===s.i(h.a)(E)?T=void 0:E.pop(),E.length&&E[0]===P[0]?s.i(u.a)(E,void 0,T):[]});r.a=C},function(o,r,s){'use strict';var u=s(144),f=s(87),h=s(14),w=s(205),C=/[\\\\^$.*+?()[\\]{}|]/g,P=/^\\[object .+?Constructor\\]$/,T=Object.prototype,E=Function.prototype.toString,S=T.hasOwnProperty,O=RegExp('^'+E.call(S).replace(C,'\\\\$&').replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,'$1.*?')+'$');r.a=function(V){if(!s.i(h.a)(V))return!1;var R=s.i(u.a)(V)||s.i(f.a)(V)?O:P;return R.test(s.i(w.a)(V))}},function(o,r){'use strict';var u=Array.prototype,f=u.join;r.a=function(h,w){return h?f.call(h,w):''}},function(o,r,s){'use strict';var u=s(202),f=s(15);r.a=function(C,P,T){var E=C?C.length:0;if(!E)return-1;var S=E;if(void 0!==T&&(S=s.i(f.a)(T),S=(0>S?_Mathmax(E+S,0):_Mathmin(S,E-1))+1),P!==P)return s.i(u.a)(C,S,!0);for(;S--;)if(C[S]===P)return S;return-1}},function(o,r,s){'use strict';var u=s(419),f=s(15);r.a=function(h,w){return h&&h.length?s.i(u.a)(h,s.i(f.a)(w)):void 0}},function(o,r,s){'use strict';var d=s(146),u=s(8),f=s.i(u.a)(d.a);r.a=f},function(o,r,s){'use strict';var u=s(10),f=s(128);r.a=function(h,w,C){return h&&h.length&&w&&w.length?s.i(f.a)(h,w,s.i(u.a)(C)):h}},function(o,r,s){'use strict';var u=s(128);r.a=function(f,h,w){return f&&f.length&&h&&h.length?s.i(u.a)(f,h,void 0,w):f}},function(o,r,s){'use strict';var d=s(27),u=s(406),f=s(23),h=s(194),w=s(432),C=s(36),P=s(8),T=s.i(P.a)(function(E,S){S=s.i(f.a)(S,1);var O=E?E.length:0,V=s.i(u.a)(E,S);return s.i(h.a)(E,s.i(d.a)(S,function(R){return s.i(C.a)(R,O)?+R:R}).sort(w.a)),V});r.a=T},function(o,r,s){'use strict';var u=s(10),f=s(194);r.a=function(h,w){var C=[];if(!(h&&h.length))return C;var P=-1,T=[],E=h.length;for(w=s.i(u.a)(w,3);++P<E;){var S=h[P];w(S,P,h)&&(C.push(S),T.push(P))}return s.i(f.a)(h,T),C}},function(o,r){'use strict';var u=Array.prototype,f=u.reverse;r.a=function(h){return h?f.call(h):h}},function(o,r,s){'use strict';var u=s(35),f=s(88),h=s(15);r.a=function(w,C,P){var T=w?w.length:0;return T?(P&&'number'!=typeof P&&s.i(f.a)(w,C,P)?(C=0,P=T):(C=null==C?0:s.i(h.a)(C),P=void 0===P?T:s.i(h.a)(P)),s.i(u.a)(w,C,P)):[]}},function(o,r,s){'use strict';var u=s(83);r.a=function(f,h){return s.i(u.a)(f,h)}},function(o,r,s){'use strict';var u=s(10),f=s(129);r.a=function(h,w,C){return s.i(f.a)(h,w,s.i(u.a)(C))}},function(o,r,s){'use strict';var u=s(83),f=s(53);r.a=function(h,w){var C=h?h.length:0;if(C){var P=s.i(u.a)(h,w);if(P<C&&s.i(f.a)(h[P],w))return P}return-1}},function(o,r,s){'use strict';var u=s(83);r.a=function(f,h){return s.i(u.a)(f,h,!0)}},function(o,r,s){'use strict';var u=s(10),f=s(129);r.a=function(h,w,C){return s.i(f.a)(h,w,s.i(u.a)(C),!0)}},function(o,r,s){'use strict';var u=s(83),f=s(53);r.a=function(h,w){var C=h?h.length:0;if(C){var P=s.i(u.a)(h,w,!0)-1;if(s.i(f.a)(h[P],w))return P}return-1}},function(o,r,s){'use strict';var u=s(195);r.a=function(f){return f&&f.length?s.i(u.a)(f):[]}},function(o,r,s){'use strict';var u=s(10),f=s(195);r.a=function(h,w){return h&&h.length?s.i(f.a)(h,s.i(u.a)(w)):[]}},function(o,r,s){'use strict';var u=s(140);r.a=function(f){return s.i(u.a)(f,1)}},function(o,r,s){'use strict';var u=s(35),f=s(15);r.a=function(h,w,C){return h&&h.length?(w=C||void 0===w?1:s.i(f.a)(w),s.i(u.a)(h,0,0>w?0:w)):[]}},function(o,r,s){'use strict';var u=s(35),f=s(15);r.a=function(h,w,C){var P=h?h.length:0;return P?(w=C||void 0===w?1:s.i(f.a)(w),w=P-w,s.i(u.a)(h,0>w?0:w,P)):[]}},function(o,r,s){'use strict';var u=s(10),f=s(84);r.a=function(h,w){return h&&h.length?s.i(f.a)(h,s.i(u.a)(w,3),!1,!0):[]}},function(o,r,s){'use strict';var u=s(10),f=s(84);r.a=function(h,w){return h&&h.length?s.i(f.a)(h,s.i(u.a)(w,3)):[]}},function(o,r,s){'use strict';var u=s(144),f=s(14),h=s(44),w=0/0,C=/^\\s+|\\s+$/g,P=/^[-+]0x[0-9a-f]+$/i,T=/^0b[01]+$/i,E=/^0o[0-7]+$/i,S=parseInt;r.a=function(O){if('number'==typeof O)return O;if(s.i(h.a)(O))return w;if(s.i(f.a)(O)){var V=s.i(u.a)(O.valueOf)?O.valueOf():O;O=s.i(f.a)(V)?V+'':V}if('string'!=typeof O)return 0===O?O:+O;O=O.replace(C,'');var R=T.test(O);return R||E.test(O)?S(O.slice(2),R?2:8):P.test(O)?w:+O}},function(o,r,s){'use strict';var d=s(23),u=s(42),f=s(13),h=s(8),w=s.i(h.a)(function(C){return s.i(u.a)(s.i(d.a)(C,1,f.a,!0))});r.a=w},function(o,r,s){'use strict';var d=s(23),u=s(10),f=s(42),h=s(13),w=s(18),C=s(8),P=s.i(C.a)(function(T){var E=s.i(w.a)(T);return s.i(h.a)(E)&&(E=void 0),s.i(f.a)(s.i(d.a)(T,1,h.a,!0),s.i(u.a)(E))});r.a=P},function(o,r,s){'use strict';var d=s(23),u=s(42),f=s(13),h=s(18),w=s(8),C=s.i(w.a)(function(P){var T=s.i(h.a)(P);return s.i(f.a)(T)&&(T=void 0),s.i(u.a)(s.i(d.a)(P,1,f.a,!0),void 0,T)});r.a=C},function(o,r,s){'use strict';var u=s(42);r.a=function(f){return f&&f.length?s.i(u.a)(f):[]}},function(o,r,s){'use strict';var u=s(10),f=s(42);r.a=function(h,w){return h&&h.length?s.i(f.a)(h,s.i(u.a)(w)):[]}},function(o,r,s){'use strict';var u=s(42);r.a=function(f,h){return f&&f.length?s.i(u.a)(f,void 0,h):[]}},function(o,r,s){'use strict';var d=s(64),u=s(13),f=s(8),h=s.i(f.a)(function(w,C){return s.i(u.a)(w)?s.i(d.a)(w,C):[]});r.a=h},function(o,r,s){'use strict';var d=s(80),u=s(131),f=s(13),h=s(8),w=s.i(h.a)(function(C){return s.i(u.a)(s.i(d.a)(C,f.a))});r.a=w},function(o,r,s){'use strict';var d=s(80),u=s(10),f=s(131),h=s(13),w=s(18),C=s(8),P=s.i(C.a)(function(T){var E=s.i(w.a)(T);return s.i(h.a)(E)&&(E=void 0),s.i(f.a)(s.i(d.a)(T,h.a),s.i(u.a)(E))});r.a=P},function(o,r,s){'use strict';var d=s(80),u=s(131),f=s(13),h=s(18),w=s(8),C=s.i(w.a)(function(P){var T=s.i(h.a)(P);return s.i(f.a)(T)&&(T=void 0),s.i(u.a)(s.i(d.a)(P,f.a),void 0,T)});r.a=C},function(o,r,s){'use strict';var d=s(8),u=s(96),f=s.i(d.a)(u.a);r.a=f},function(o,r,s){'use strict';var u=s(63),f=s(197);r.a=function(h,w){return s.i(f.a)(h||[],w||[],u.a)}},function(o,r,s){'use strict';var u=s(421),f=s(197);r.a=function(h,w){return s.i(f.a)(h||[],w||[],u.a)}},function(o,r,s){'use strict';var d=s(8),u=s(147),f=s.i(d.a)(function(h){var w=h.length,C=1<w?h[w-1]:void 0;return C='function'==typeof C?(h.pop(),C):void 0,s.i(u.a)(h,C)});r.a=f},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){const f=new Map;for(let h in u)f.set(h,u[h]);return f}},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function d(C){return!!C&&1==C.length&&/[\\u0300-\\u036f\\u1ab0-\\u1aff\\u1dc0-\\u1dff\\u20d0-\\u20ff\\ufe20-\\ufe2f]/.test(C)}function u(C){return!!C&&1==C.length&&/[\\ud800-\\udbff]/.test(C)}function f(C){return!!C&&1==C.length&&/[\\udc00-\\udfff]/.test(C)}r.a=function(C,P){return u(C.charAt(P-1))&&f(C.charAt(P))},r.b=function(C,P){return d(C.charAt(P))}},function(o,r,s){'use strict';var d=s(284),u=s(156),f=s(286),h=s(287),w=s(393);throw new Error('Cannot find module \"../theme/theme.scss\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(2),u=s(352),f=s(114),h=s(273),w=s(323),C=s(326),P=s(328),T=s(331),E=s(170),S=s(275),O=s(340),V=s(347);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class R extends d.a{static get requires(){return[u.a,f.a,h.a,w.a,C.a,P.a,T.a,E.a,S.a,O.a,V.a]}}r.a=R},function(o){var s=function(){return this}();try{s=s||Function('return this')()||(1,eval)('this')}catch(d){'object'==typeof window&&(s=window)}o.exports=s},function(o,r,s){'use strict';var d=s(2),u=s(274),f=s(26);throw new Error('Cannot find module \"../theme/icons/bold.svg\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(2),u=s(45),f=s(46),h=s(152);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const w='bold';class C extends d.a{init(){const P=this.editor,T=P.data,E=P.editing;P.document.schema.allow({name:'$inline',attributes:[w]}),s.i(u.a)().for(T.modelToView,E.modelToView).fromAttribute(w).toElement('strong'),s.i(f.a)().for(T.viewToModel).fromElement('strong').fromElement('b').fromAttribute('style',{'font-weight':'bold'}).toAttribute(w,!0),P.commands.set(w,new h.a(P,w))}}r.a=C},function(o,r,s){'use strict';var d=s(2),u=s(276),f=s(26);throw new Error('Cannot find module \"../theme/icons/italic.svg\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(2),u=s(45),f=s(46),h=s(152);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const w='italic';class C extends d.a{init(){const P=this.editor,T=P.data,E=P.editing;P.document.schema.allow({name:'$inline',attributes:[w]}),s.i(u.a)().for(T.modelToView,E.modelToView).fromAttribute(w).toElement('em'),s.i(f.a)().for(T.viewToModel).fromElement('em').fromElement('i').fromAttribute('style',{'font-style':'italic'}).toAttribute(w,!0),P.commands.set(w,new h.a(P,w))}}r.a=C},function(o,r,s){'use strict';var d=s(2),u=s(278),f=s(281),h=s(280),w=s(156);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends d.a{init(){const P=this.editor,T=P.document,E=P.editing.view;this._htmlDataProcessor=new w.a,E.addObserver(u.a),this.listenTo(E,'paste',(O,V)=>{const R=V.dataTransfer;let F='';R.getData('text/html')?F=s.i(h.a)(R.getData('text/html')):R.getData('text/plain')&&(F=s.i(f.a)(R.getData('text/plain'))),F=this._htmlDataProcessor.toView(F),V.preventDefault(),E.fire('clipboardInput',{dataTransfer:R,content:F})},{priority:'low'}),this.listenTo(E,'clipboardInput',(O,V)=>{if(!V.content.isEmpty){const R=this.editor.data,F=R.toModel(V.content,'$clipboardHolder');T.enqueueChanges(()=>{R.insertContent(F,T.selection)})}},{priority:'low'});const S=(O,V)=>{const R=V.dataTransfer,F=P.data.toView(P.data.getSelectedContent(T.selection));V.preventDefault(),E.fire('clipboardOutput',{dataTransfer:R,content:F,method:O.name})};this.listenTo(E,'copy',S,{priority:'low'}),this.listenTo(E,'cut',S,{priority:'low'}),this.listenTo(E,'clipboardOutput',(O,V)=>{V.content.isEmpty||V.dataTransfer.setData('text/html',this._htmlDataProcessor.toData(V.content)),'cut'==V.method&&T.enqueueChanges(()=>{P.data.deleteContent(T.selection,T.batch(),{merge:!0})})},{priority:'low'})}}r.a=C},function(o,r,s){'use strict';var d=s(59),u=s(279);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.domEventType=['paste','copy','cut']}onDomEvent(h){this.fire(h.type,h,{dataTransfer:new u.a(h.clipboardData)})}}r.a=f},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(u){this._native=u}getData(u){return this._native.getData(u)}setData(u,f){this._native.setData(u,f)}}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){return u.replace(/<span class=\"Apple-converted-space\">(\\s+)<\\/span>/g,(f,h)=>{return 1==h.length?' ':h})}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){return u=u.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\\n\\n/g,'</p><p>').replace(/\\n/g,' ').replace(/^\\s/,'&nbsp;').replace(/\\s$/,'&nbsp;').replace(/\\s\\s/g,' &nbsp;'),-1<u.indexOf('</p><p>')&&(u=`<p>${u}</p>`),u}},function(o,r,s){'use strict';var d=s(62);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{constructor(f){super(),this.editor=f}set(f,h){if('string'==typeof h){const w=h;h=()=>{this.editor.execute(w)}}super.set(f,h)}listenTo(f){this._listener.listenTo(f,'keydown',(h,w)=>{const C=this.press(w);C&&w.preventDefault()})}}r.a=u},function(o,r,s){'use strict';var d=s(7),u=s(381),f=s(285),h=s(494),w=s(288),C=s(303),P=s(0),T=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class E{constructor(S){const O=this.constructor.build&&this.constructor.build.plugins;this.config=new u.a(S,this.constructor.build&&this.constructor.build.config),this.config.define('plugins',O),this.plugins=new f.a(this,O),this.commands=new Map,this.locale=new h.a(this.config.get('lang')),this.t=this.locale.t,this.document=new C.a,this.data=new w.a(this.document)}initPlugins(){function O(F,N){return F.reduce((I,M)=>{return I.then(M[N].bind(M))},Promise.resolve())}const V=this,R=this.config;return function(){return V.plugins.load(R.get('plugins')||[])}().then((F)=>{return O(F,'init').then(()=>O(F,'afterInit'))}).then(()=>this.fire('pluginsReady'))}destroy(){return this.fire('destroy'),this.stopListening(),Promise.resolve().then(()=>{this.document.destroy(),this.data.destroy()})}execute(S,O){let V=this.commands.get(S);if(!V)throw new P.a('editor-command-not-found: Specified command has not been added to the editor.');V._execute(O)}static create(S){return new Promise((O)=>{const V=new this(S);O(V.initPlugins().then(()=>{V.fire('dataReady'),V.fire('ready')}).then(()=>V))})}}r.a=E,s.i(T.a)(E,d.a)},function(o,r,s){'use strict';var d=s(283),u=s(282),f=s(290),h=s(384),w=s(392);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends d.a{constructor(P,T){super(T),this.element=P,this.editing=new f.a(this.document),this.keystrokes=new u.a(this),this.keystrokes.listenTo(this.editing.view)}destroy(){return Promise.resolve().then(()=>this.keystrokes.destroy()).then(()=>this.editing.destroy()).then(super.destroy())}setData(P){this.data.set(P)}getData(){return this.data.get()}updateEditorElement(){s.i(w.a)(this.element,this.getData())}loadDataFromEditorElement(){this.setData(s.i(h.a)(this.element))}static create(P,T){return new Promise((E)=>{const S=new this(P,T);E(S.initPlugins().then(()=>{S.fire('dataReady'),S.fire('ready')}).then(()=>S))})}}r.a=C},function(o,r,s){'use strict';var d=s(2),u=s(0),f=s(55);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h{constructor(w,C=[]){this._editor=w,this._availablePlugins=new Map,this._plugins=new Map;for(const P of C)this._availablePlugins.set(P,P),P.pluginName&&this._availablePlugins.set(P.pluginName,P)}*[Symbol.iterator](){for(const w of this._plugins)'function'==typeof w[0]&&(yield w)}get(w){return this._plugins.get(w)}load(w,C=[]){function P(q){return D.includes(q)||R.get(q)||N.has(q)?void 0:T(q).catch((z)=>{throw f.a.error('plugincollection-load: It was not possible to load the plugin.',{plugin:q}),z})}function T(q){return new Promise((z)=>{N.add(q),S(q),q.requires&&q.requires.forEach(($)=>{const H=E($);if(C.includes(H))throw new u.a('plugincollection-required: Cannot load a plugin because one of its dependencies is listed inthe `removePlugins` option.',{plugin:H,requiredBy:q});P(H)});const K=new q(F);R._add(q,K),I.push(K),z()})}function E(q){return'function'==typeof q?q:R._availablePlugins.get(q)}function S(q){if(!(q.prototype instanceof d.a))throw new u.a('plugincollection-instance: The loaded plugin module is not an instance of Plugin.',{plugin:q})}function V(q){return q.map((z)=>E(z)).filter((z)=>!!z)}const R=this,F=this._editor,N=new Set,I=[],M=V(w),D=V(C),L=function(q){const z=[];for(const K of q)E(K)||z.push(K);return z.length?z:null}(w);if(L){const q='plugincollection-plugin-not-found: Some plugins are not available and could not be loaded.';return f.a.error(q,{plugins:L}),Promise.reject(new u.a(q,{plugins:L}))}return Promise.all(M.map(P)).then(()=>I)}_add(w,C){this._plugins.set(w,C),w.pluginName&&this._plugins.set(w.pluginName,C)}}r.a=h},function(o,r,s){'use strict';var d=s(360),u=s(61),f=s(374);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(w,C){this.editor=w,this.view=C,this.componentFactory=new d.a(w),this.focusTracker=new u.a,C.set('width',w.config.get('ui.width')),C.set('height',w.config.get('ui.height')),C.toolbar.bind('isActive').to(this.focusTracker,'isFocused'),C.toolbar.limiterElement=C.element;const P=w.editing.createRoot('div');C.editable.bind('isReadOnly').to(P),C.editable.bind('isFocused').to(w.editing.view),C.editable.name=P.rootName,this.focusTracker.add(C.editableElement)}init(){const w=this.editor;return this.view.init().then(()=>{return this.view.toolbar.fillFromConfig(w.config.get('toolbar'),this.componentFactory)}).then(()=>{s.i(f.a)({origin:w.editing.view,originFocusTracker:this.focusTracker,originKeystrokeHandler:w.keystrokes,toolbar:this.view.toolbar})})}destroy(){return this.view.destroy()}}},function(o,r,s){'use strict';var d=s(367),u=s(366),f=s(375);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{constructor(w){super(w),this.toolbar=new f.a(w),this.editable=new u.a(w),this.top.add(this.toolbar),this.main.add(this.editable)}get editableElement(){return this.editable.element}}r.a=h},function(o,r,s){'use strict';var d=s(4),u=s(7),f=s(153),h=s(155),w=s(97),C=s(298),P=s(296),T=s(111),E=s(3),S=s(1),O=s(292),V=s(289),R=s(293),F=s(291);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class N{constructor(I,M){this.model=I,this.processor=M,this.mapper=new f.a,this.modelToView=new h.a(this.model,{mapper:this.mapper}),this.modelToView.on('insert:$text',s.i(w.j)(),{priority:'lowest'}),this.viewToModel=new C.a({schema:I.schema}),this.viewToModel.on('text',s.i(P.a)(),{priority:'lowest'}),this.viewToModel.on('element',s.i(P.b)(),{priority:'lowest'}),this.viewToModel.on('documentFragment',s.i(P.b)(),{priority:'lowest'}),this.on('insertContent',(D,L)=>s.i(O.a)(this,L.content,L.selection,L.batch)),this.on('deleteContent',(D,L)=>s.i(V.a)(L.selection,L.batch,L.options)),this.on('modifySelection',(D,L)=>s.i(R.a)(this,L.selection,L.options)),this.on('getSelectedContent',(D,L)=>{L.content=s.i(F.a)(L.selection)})}get(I='main'){return this.stringify(this.model.getRoot(I))}stringify(I){const M=this.toView(I);return this.processor.toData(M)}toView(I){const M=E.a.createIn(I),D=new T.a;return this.mapper.bindElements(I,D),this.modelToView.convertInsertion(M),this.mapper.clearBindings(),D}set(I,M='main'){const D=this.model.getRoot(M);this.model.enqueueChanges(()=>{this.model.selection.removeAllRanges(),this.model.selection.clearAttributes(),this.model.batch('transparent').remove(E.a.createIn(D)).insert(S.a.createAt(D,0),this.parse(I))})}parse(I,M='$root'){const D=this.processor.toView(I);return this.toModel(D,M)}toModel(I,M='$root'){return this.viewToModel.convert(I,{context:[M]})}destroy(){}insertContent(I,M,D){this.fire('insertContent',{content:I,selection:M,batch:D})}deleteContent(I,M,D){this.fire('deleteContent',{batch:M,selection:I,options:D})}modifySelection(I,M){this.fire('modifySelection',{selection:I,options:M})}getSelectedContent(I){const M={selection:I};return this.fire('getSelectedContent',M),M.content}}r.a=N,s.i(d.a)(N,u.a)},function(o,r,s){'use strict';function u(E,S,O){const V=O.path,R=_Mathmin(S.path.length-1,V.length-1);let F=s.i(T.a)(S.path,V);if('number'==typeof F)for(;F<R;F++){const N=S.path.slice(0,F);N.push(S.path[F]+1);const I=new C.a(O.root,N),M=I.nodeBefore,D=I.nodeAfter;if(!h(M)||!h(D))return;0<D.childCount?E.merge(I):E.remove(D)}}/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function f(E,S){const O=E.schema.check({name:'$text',inside:S}),V=E.schema.check({name:'paragraph',inside:S});return!O&&V}function h(E){const S=E.document.schema;return!S.objects.has(E.name)&&!S.limits.has(E.name)}var w=s(160),C=s(1),P=s(5),T=s(49);r.a=function(E,S,O={}){if(!E.isCollapsed){const V=E.getFirstRange(),R=V.start,F=w.a.createFromPosition(V.end);if(V.start.isTouching(V.end)||S.remove(V),O.merge&&u(S,R,F),E.collapse(R),f(S.document,R)){const N=new P.a('paragraph');S.insert(R,N),E.collapse(N)}F.detach()}}},function(o,r,s){'use strict';var d=s(311),u=s(153),f=s(155),h=s(97),w=s(295),C=s(154),P=s(7);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(E){this.model=E,this.view=new d.a,this.mapper=new u.a,this.modelToView=new f.a(this.model,{mapper:this.mapper,viewSelection:this.view.selection}),this._listener=Object.create(P.a),this._listener.listenTo(this.model,'change',(S,O,V)=>{this.modelToView.convertChange(O,V)},{priority:'low'}),this._listener.listenTo(this.model,'changesDone',()=>{const S=this.model.selection;this.modelToView.convertSelection(S),this.view.render()},{priority:'low'}),this._listener.listenTo(this.model.markers,'add',(S,O)=>{this.modelToView.convertMarker('addMarker',O.name,O.getRange())}),this._listener.listenTo(this.model.markers,'remove',(S,O)=>{this.modelToView.convertMarker('removeMarker',O.name,O.getRange())}),this._listener.listenTo(this.view,'selectionChange',s.i(w.a)(this.model,this.mapper)),this.modelToView.on('insert:$text',s.i(h.j)(),{priority:'lowest'}),this.modelToView.on('remove',s.i(h.k)(),{priority:'low'}),this.modelToView.on('selection',s.i(C.c)(),{priority:'low'}),this.modelToView.on('selection',s.i(C.d)(),{priority:'low'}),this.modelToView.on('selection',s.i(C.e)(),{priority:'low'}),this.modelToView.on('selection',s.i(C.f)(),{priority:'low'})}createRoot(E,S='main'){const O=this.view.createRoot(E,S),V=this.model.getRoot(S);return this.mapper.bindElements(V,O),O}destroy(){this.view.destroy(),this._listener.stopListening()}}},function(o,r,s){'use strict';function u(T){const E=[];Array.from(T.getItems({direction:'backward'})).map((S)=>h.a.createOn(S)).filter((S)=>{const O=(S.start.isAfter(T.start)||S.start.isEqual(T.start))&&(S.end.isBefore(T.end)||S.end.isEqual(T.end));return O}).forEach((S)=>{E.push(S.start.parent),s.i(P.c)(S)}),E.forEach((S)=>{for(let O=S;O.parent&&O.isEmpty;){const V=h.a.createOn(O);O=O.parent,s.i(P.c)(V)}})}/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */var f=s(47),h=s(3),w=s(1),C=s(24),P=s(20);r.a=function(T){const E=new f.a,S=T.getFirstRange();if(!S||S.isCollapsed)return E;const O=S.start.root,V=S.start.getCommonPath(S.end),R=O.getNodeByPath(V);let F=S.start.parent==S.end.parent?S:h.a.createFromParentsAndOffsets(R,S.start.path[V.length],R,S.end.path[V.length]+1);const N=F.end.offset-F.start.offset;for(const I of F.getItems({shallow:!0}))I.is('textProxy')?E.appendChildren(new C.a(I.data,I.getAttributes())):E.appendChildren(I.clone(!0));if(F!=S){const I=S._getTransformedByMove(F.start,w.a.createAt(E,0),N)[0],M=new h.a(w.a.createAt(E),I.start),D=new h.a(I.end,w.a.createAt(E,'end'));u(D),u(M)}return E}},function(o,r,s){'use strict';var u=s(1),f=s(160),h=s(5),w=s(3),C=s(55);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(T,E,S,O){O||(O=T.model.batch()),S.isCollapsed||T.deleteContent(S,O,{merge:!0});const V=new P(T,O,S.anchor);V.handleNodes(E.getChildren(),{isFirst:!0,isLast:!0});const R=V.getSelectionRange();R?S.setRanges([R]):C.a.warn('insertcontent-no-range: Cannot determine a proper selection range after insertion.')};class P{constructor(T,E,S){this.dataController=T,this.batch=E,this.position=S,this.canMergeWith=new Set([this.position.parent]),this.schema=T.model.schema}handleNodes(T,E){T=Array.from(T);for(let S=0;S<T.length;S++){const O=T[S].clone();this._handleNode(O,{isFirst:0===S&&E.isFirst,isLast:S===T.length-1&&E.isLast})}}getSelectionRange(){return this.nodeToSelect?w.a.createOn(this.nodeToSelect):this.dataController.model.getNearestSelectionRange(this.position)}_handleNode(T,E){if(this._checkIsObject(T))return void this._handleObject(T,E);const S=this._checkAndSplitToAllowedPosition(T,E);return S?void(this._insert(T),this._mergeSiblingsOf(T,E)):void this._handleDisallowedNode(T,E)}_handleObject(T,E){this._checkAndSplitToAllowedPosition(T)?this._insert(T):this._tryAutoparagraphing(T,E)}_handleDisallowedNode(T,E){T.is('element')?this.handleNodes(T.getChildren(),E):this._tryAutoparagraphing(T,E)}_insert(T){if(!this._checkIsAllowed(T,[this.position.parent]))return void C.a.error('insertcontent-wrong-position: The node cannot be inserted on the given position.',{node:T,position:this.position});const E=f.a.createFromPosition(this.position);this.batch.insert(this.position,T),this.position=u.a.createFromPosition(E),E.detach(),this.nodeToSelect=this._checkIsObject(T)&&!this.schema.check({name:'$text',inside:[this.position.parent]})?T:null}_mergeSiblingsOf(T,E){if(T instanceof h.a){const S=E.isFirst&&T.previousSibling instanceof h.a&&this.canMergeWith.has(T.previousSibling),O=E.isLast&&T.nextSibling instanceof h.a&&this.canMergeWith.has(T.nextSibling),V=f.a.createBefore(T),R=f.a.createAfter(T);if(S){const F=f.a.createFromPosition(this.position);this.batch.merge(V),this.position=u.a.createFromPosition(F),F.detach()}if(O){let F;this.position.isEqual(R)||C.a.error('insertcontent-wrong-position-on-merge: The insertion position should equal the merge position'),this.position=u.a.createAt(R.nodeBefore,'end'),F=new f.a(this.position.root,this.position.path,'sticksToPrevious'),this.batch.merge(R),this.position=u.a.createFromPosition(F),F.detach()}V.detach(),R.detach()}}_tryAutoparagraphing(T,E){const S=new h.a('paragraph');this._getAllowedIn(S,this.position.parent)&&this._checkIsAllowed(T,[S])&&(S.appendChildren(T),this._handleNode(S,E))}_checkAndSplitToAllowedPosition(T){const E=this._getAllowedIn(T,this.position.parent);if(!E)return!1;for(;E!=this.position.parent;){if(this.schema.limits.has(this.position.parent.name))return!1;if(this.position.isAtStart){const S=this.position.parent;this.position=u.a.createBefore(S),S.isEmpty&&this.batch.remove(S)}else if(this.position.isAtEnd)this.position=u.a.createAfter(this.position.parent);else{const S=u.a.createAfter(this.position.parent);this.batch.split(this.position),this.position=S,this.canMergeWith.add(this.position.nodeAfter)}}return!0}_getAllowedIn(T,E){return this._checkIsAllowed(T,[E])?E:E.parent?this._getAllowedIn(T,E.parent):null}_checkIsAllowed(T,E){return this.schema.check({name:this._getNodeSchemaName(T),attributes:Array.from(T.getAttributeKeys()),inside:E})}_checkIsObject(T){return this.schema.objects.has(this._getNodeSchemaName(T))}_getNodeSchemaName(T){return T.is('text')?'$text':T.name}}},function(o,r,s){'use strict';function u(E,S){if('text'==S.type)return f(E.walker,E.unit);if(S.type==(E.isForward?'elementStart':'elementEnd')){if(E.schema.objects.has(S.item.name))return w.a.createAt(S.item,E.isForward?'after':'before');if(E.schema.check({name:'$text',inside:S.nextPosition}))return S.nextPosition}else{if(E.schema.limits.has(S.item.name))return void E.walker.skip(()=>!0);if(E.schema.check({name:'$text',inside:S.nextPosition}))return S.nextPosition}}/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function f(E,S){const O=E.position.textNode;if(O){const V=O.data;for(let R=E.position.offset-O.startOffset;s.i(T.a)(V,R)||'character'==S&&s.i(T.b)(V,R);)E.next(),R=E.position.offset-O.startOffset}return E.position}function h(E,S){const O=E.root,V=w.a.createAt(O,S?'end':0);return S?new P.a(E,V):new P.a(V,E)}var w=s(1),C=s(33),P=s(3),T=s(269);r.a=function(E,S,O={}){const V=E.model.schema,R='backward'!=O.direction,F=O.unit?O.unit:'character',N=S.focus,I=new C.a({boundaries:h(N,R),singleCharacters:!0,direction:R?'forward':'backward'}),M={walker:I,schema:V,isForward:R,unit:F};for(let D;D=I.next();){if(D.done)return;const L=u(M,D.value);if(L)return void S.setFocus(L)}}},function(o,r,s){'use strict';var d=s(70);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(f,h){f instanceof d.a&&(f=this._getSymbolForTextProxy(f)),this._consumable.has(f)||this._consumable.set(f,new Map),this._consumable.get(f).set(h,!0)}consume(f,h){return f instanceof d.a&&(f=this._getSymbolForTextProxy(f)),!!this.test(f,h)&&(this._consumable.get(f).set(h,!1),!0)}test(f,h){f instanceof d.a&&(f=this._getSymbolForTextProxy(f));const w=this._consumable.get(f);if(w===void 0)return null;const C=w.get(h);return void 0===C?null:C}revert(f,h){f instanceof d.a&&(f=this._getSymbolForTextProxy(f));const w=this.test(f,h);return!1===w?(this._consumable.get(f).set(h,!0),!0):!0!==w&&null}_getSymbolForTextProxy(f){let h=null;const w=this._textProxyRegistry.get(f.startOffset);if(w){const C=w.get(f.endOffset);C&&(h=C.get(f.parent))}return h||(h=this._addSymbolForTextProxy(f.startOffset,f.endOffset,f.parent)),h}_addSymbolForTextProxy(f,h,w){const C=Symbol();let P,T;return P=this._textProxyRegistry.get(f),P||(P=new Map,this._textProxyRegistry.set(f,P)),T=P.get(h),T||(T=new Map,P.set(h,T)),T.set(w,C),C}}},function(o,r,s){'use strict';var u=s(57);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(f,h){return(w,C)=>{const P=C.newSelection,T=new u.a,E=[];for(let S of P.getRanges())E.push(h.toModelRange(S));T.setRanges(E,P.isBackward),T.isEqual(f.selection)||f.enqueueChanges(()=>{f.selection.setTo(T)})}}},function(o,r,s){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */var f=s(47),h=s(24),w=s(20);r.b=function(){return(C,P,T,E)=>{if(!P.output&&T.consume(P.input,{name:!0})){const S=E.convertChildren(P.input,T,P);P.output=new f.a(s.i(w.b)(S))}}},r.a=function(){return(C,P,T,E)=>{const S={name:'$text',inside:P.context};E.schema.check(S)&&T.consume(P.input)&&(P.output=new h.a(P.input.data))}}},function(o,r,s){'use strict';var d=s(11),u=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f{constructor(){this._consumables=new Map}add(w,C){let P;return w.is('text')||w.is('documentFragment')?void this._consumables.set(w,!0):void(this._consumables.has(w)?P=this._consumables.get(w):(P=new h,this._consumables.set(w,P)),P.add(C))}test(w,C){const P=this._consumables.get(w);return void 0===P?null:w.is('text')||w.is('documentFragment')?P:P.test(C)}consume(w,C){return!!this.test(w,C)&&(w.is('text')||w.is('documentFragment')?this._consumables.set(w,!1):this._consumables.get(w).consume(C),!0)}revert(w,C){const P=this._consumables.get(w);P!==void 0&&(w.is('text')||w.is('documentFragment')?this._consumables.set(w,!0):P.revert(C))}static consumablesFromElement(w){const C={name:!0,attribute:[],class:[],style:[]},P=w.getAttributeKeys();for(let S of P)'style'!=S&&'class'!=S&&C.attribute.push(S);const T=w.getClassNames();for(let S of T)C.class.push(S);const E=w.getStyleNames();for(let S of E)C.style.push(S);return C}static createFrom(w,C){if(C||(C=new f),w.is('text'))return C.add(w),C;w.is('element')&&C.add(w,f.consumablesFromElement(w)),w.is('documentFragment')&&C.add(w);for(let P of w.getChildren())C=f.createFrom(P,C);return C}}r.a=f;class h{constructor(){this._canConsumeName=null,this._consumables={attribute:new Map,style:new Map,class:new Map}}add(w){for(let C in w.name&&(this._canConsumeName=!0),this._consumables)C in w&&this._add(C,w[C])}test(w){if(w.name&&!this._canConsumeName)return this._canConsumeName;for(let C in this._consumables)if(C in w){const P=this._test(C,w[C]);if(!0!==P)return P}return!0}consume(w){for(let C in w.name&&(this._canConsumeName=!1),this._consumables)C in w&&this._consume(C,w[C])}revert(w){for(let C in w.name&&(this._canConsumeName=!0),this._consumables)C in w&&this._revert(C,w[C])}_add(w,C){const P=s.i(d.a)(C)?C:[C],T=this._consumables[w];for(let E of P){if('attribute'===w&&('class'===E||'style'===E))throw new u.a('viewconsumable-invalid-attribute: Classes and styles should be handled separately.');T.set(E,!0)}}_test(w,C){const P=s.i(d.a)(C)?C:[C],T=this._consumables[w];for(let E of P)if('attribute'===w&&('class'===E||'style'===E)){const S=this._test(E,[...this._consumables[E].keys()]);if(!0!==S)return S}else{const S=T.get(E);if(S===void 0)return null;if(!S)return!1}return!0}_consume(w,C){const P=s.i(d.a)(C)?C:[C],T=this._consumables[w];for(let E of P)'attribute'===w&&('class'===E||'style'===E)?this._consume(E,[...this._consumables[E].keys()]):T.set(E,!1)}_revert(w,C){const P=s.i(d.a)(C)?C:[C],T=this._consumables[w];for(let E of P)if('attribute'===w&&('class'===E||'style'===E))this._revert(E,[...this._consumables[E].keys()]);else{const S=T.get(E);!1===S&&T.set(E,!0)}}}},function(o,r,s){'use strict';function d(R){const F=new Set,N=new Map,I=new T.a({startPosition:P.a.createAt(R,0),ignoreElementEnd:!0});for(const M of I)'$marker'==M.item.name&&F.add(M.item);for(const M of F){const D=M.getAttribute('data-name'),L=P.a.createBefore(M);N.has(D)?N.get(D).end=P.a.createFromPosition(L):N.set(D,new C.a(P.a.createFromPosition(L))),s.i(O.c)(C.a.createOn(M))}return N}var u=s(297),f=s(7),h=s(4),w=s(54),C=s(3),P=s(1),T=s(33),E=s(56),S=s(47),O=s(20);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class V{constructor(R={}){this.conversionApi=s.i(w.a)({},R),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this)}convert(R,F={}){this.fire('viewCleanup',R);const N=u.a.createFrom(R),I=this._convertItem(R,N,F);if(!(I instanceof E.a||I instanceof S.a))return I;let M=I;return M.is('documentFragment')||(M=new S.a([M])),M.markers=d(M),M}_convertItem(R,F,N={}){const I=s.i(w.a)({},N,{input:R,output:null});return R.is('element')?this.fire('element:'+R.name,I,F,this.conversionApi):R.is('text')?this.fire('text',I,F,this.conversionApi):this.fire('documentFragment',I,F,this.conversionApi),I.output}_convertChildren(R,F,N={}){const I=Array.from(R.getChildren()),M=I.map((D)=>this._convertItem(D,F,N));return M.reduce((D,L)=>L?D.concat(L):D,[])}}r.a=V,s.i(h.a)(V,f.a)},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{getHtml(u){const f=document.implementation.createHTMLDocument(''),h=f.createElement('div');return h.appendChild(u),h.innerHTML}}},function(o,r,s){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */var d=s(157),u=s(98),f=s(99),h=s(100),w=s(101),C=s(158),P=s(102),T=s(104),E=s(159),S=s(105)},function(o,r,s){'use strict';function d(H,W){const U=H.clone(),J=U.operations[0];return J.oldRange=J.oldRange.getTransformedByDelta(W)[0],J.newRange=J.newRange.getTransformedByDelta(W)[0],[U]}function u(H,W){function U(){const Q=new w.a(H.position.getShiftedBy(X),H.position.getShiftedBy(Z)),ee=new T.a(Q,W.key,Y,W.value,0);J.addOperation(ee)}const J=new V.a,G=H.nodes;let Y=G.getNode(0).getAttribute(W.key),X=0,Z=G.getNode(0).offsetSize;for(let Q=1;Q<G.length;Q++){const ee=G.getNode(Q),te=ee.getAttribute(W.key);te!=Y&&(Y!=W.value&&U(),Y=te,X=Z),Z+=ee.offsetSize}return U(),J}function f(){let H=new O.a;return H.addOperation(new P.a(0)),H}var h=s(103),w=s(3),C=s(1),P=s(69),T=s(68),E=s(37),S=s(107),O=s(19),V=s(157),R=s(98),F=s(302),N=s(99),I=s(100),M=s(102),D=s(159),L=s(105),q=s(104),z=s(158),K=s(101),$=s(49);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */s.i(h.b)(V.a,D.a,(H,W,U)=>{const J=s.i(h.c)(H,W,U);return H.range.containsPosition(W.position)&&J.push(u(W,H)),J}),s.i(h.b)(V.a,M.a,(H,W,U)=>{const J=new C.a(W.position.root,W.position.path.slice(0,-1)),G=s.i(h.c)(H,W,U);for(let Y of H.operations)if(Y.range.containsPosition(J)||Y.range.start.isEqual(J)){const X=new V.a,Z=J.getShiftedBy(1),Q=C.a.createFromPosition(Z);Q.path.push(0);const ee=W._cloneOperation.nodes.getNode(0).getAttribute(Y.key);X.addOperation(new T.a(new w.a(Z,Q),Y.key,ee===void 0?null:ee,Y.newValue,0)),G.push(X);break}return G}),s.i(h.b)(R.a,N.a,(H,W,U)=>{return H.position.isEqual(W.position)?[W.getReversed(),H.clone()]:s.i(h.c)(H,W,U)}),s.i(h.b)(F.a,M.a,d),s.i(h.b)(F.a,N.a,d),s.i(h.b)(F.a,L.a,d),s.i(h.b)(F.a,q.a,d),s.i(h.b)(I.a,N.a,(H,W,U)=>{const J=H.sourcePosition.root==W.position.root&&'same'===s.i($.a)(H.sourcePosition.getParentPath(),W.position.getParentPath()),G=H.sourcePosition.offset<=W.position.offset&&H.sourcePosition.offset+H.howMany>W.position.offset;return J&&G?[W.getReversed(),H.clone()]:s.i(h.c)(H,W,U)}),s.i(h.b)(N.a,R.a,(H,W,U)=>{return H.position.isEqual(W.position)?[f()]:s.i(h.c)(H,W,U)}),s.i(h.b)(N.a,I.a,(H,W,U)=>{const J=H.position.root==W.sourcePosition.root&&'same'===s.i($.a)(H.position.getParentPath(),W.sourcePosition.getParentPath()),G=W.sourcePosition.offset<=H.position.offset&&W.sourcePosition.offset+W.howMany>H.position.offset;return J&&G?[f()]:s.i(h.c)(H,W,U)}),s.i(h.b)(M.a,M.a,(H,W,U)=>{const J=H.position.getParentPath(),G=W.position.getParentPath();if('same'==s.i($.a)(J,G)){if(H.position.offset==W.position.offset)return[f()];if(H.position.offset<W.position.offset){const Y=H.clone();return Y._moveOperation.howMany=W.position.offset-H.position.offset,H._cloneOperation instanceof S.a&&W._cloneOperation instanceof S.a&&H._cloneOperation.sourcePosition.offset>W._cloneOperation.sourcePosition.offset&&Y._cloneOperation.sourcePosition.offset--,[Y]}const Y=H.clone();return Y._cloneOperation.position.offset++,Y._moveOperation.sourcePosition.path[Y._moveOperation.sourcePosition.path.length-2]++,Y._moveOperation.targetPosition.path[Y._moveOperation.targetPosition.path.length-2]++,Y._moveOperation.sourcePosition.offset=H.position.offset-W.position.offset,H._cloneOperation instanceof S.a&&W._cloneOperation instanceof S.a&&H._cloneOperation.sourcePosition.offset>W._cloneOperation.sourcePosition.offset&&Y._cloneOperation.sourcePosition.offset--,[Y]}return s.i(h.c)(H,W,U)}),s.i(h.b)(M.a,q.a,(H,W,U)=>{return'same'===s.i($.a)(W.position.path,H.position.getParentPath())?[f()]:s.i(h.c)(H,W,U)}),s.i(h.b)(M.a,L.a,(H,W,U)=>{const J='same'===s.i($.a)(H.position.getParentPath(),W.range.start.getParentPath()),G=W.range.start.offset<H.position.offset&&W.range.end.offset>=H.position.offset;if(J&&G)return[f()];if('same'===s.i($.a)(H.position.getParentPath(),W.range.end.getShiftedBy(-1).path)){const Y=H.clone(),X=C.a.createFromPosition(W.range.start);X.path.push(W.howMany-1);const Z=X.getShiftedBy(1);Y._cloneOperation.position=Z;const Q=C.a.createFromPosition(X);Q.path.push(H.position.offset),Y._moveOperation.sourcePosition=Q;const ee=C.a.createFromPosition(Z);return ee.path.push(0),Y._moveOperation.targetPosition=ee,[Y]}return s.i(h.c)(H,W,U)}),s.i(h.b)(M.a,V.a,(H,W)=>{H=H.clone();const U=new C.a(H.position.root,H.position.path.slice(0,-1));if(H._cloneOperation instanceof E.a)for(let J of W.operations)if(J.range.containsPosition(U)||J.range.start.isEqual(U)){null===J.newValue?H._cloneOperation.nodes.getNode(0).removeAttribute(J.key):H._cloneOperation.nodes.getNode(0).setAttribute(J.key,J.newValue);break}return[H]}),s.i(h.b)(q.a,M.a,(H,W,U)=>{if('same'===s.i($.a)(H.position.path,W.position.getParentPath())){const J=[W.getReversed(),H.clone()];return J[1].operations[1].targetPosition.path[0]++,J}return s.i(h.c)(H,W,U)}),s.i(h.b)(D.a,V.a,(H,W)=>{const U=[H.clone()];return W.range.containsPosition(H.position)&&U.push(u(H,W)),U}),s.i(h.b)(L.a,M.a,(H,W,U)=>{const J='same'===s.i($.a)(H.range.start.getParentPath(),W.position.getParentPath()),G=H.range.start.offset<W.position.offset&&H.range.end.offset>=W.position.offset;if(J&&G)return[W.getReversed(),H.clone()];if('same'===s.i($.a)(W.position.getParentPath(),H.range.end.getShiftedBy(-1).path)){const Y=H.clone();return Y._insertOperation.position.offset++,Y._moveOperation.howMany++,Y._moveOperation.targetPosition.path[Y._moveOperation.targetPosition.path.length-2]++,[Y]}return s.i(h.c)(H,W,U)}),s.i(h.b)(z.a,M.a,(H,W,U)=>{const J=new C.a(W.position.root,W.position.path.slice(0,-1)),G=s.i(h.c)(H,W,U);if(H.operations[0].position.isEqual(J)){const Y=H.clone();Y.operations[0].position=H.operations[0].position.getShiftedBy(1),G.push(Y)}return G}),s.i(h.b)(M.a,z.a,(H,W)=>{H=H.clone();const U=new C.a(H.position.root,H.position.path.slice(0,-1));return H._cloneOperation instanceof E.a&&W.operations[0].position.isEqual(U)&&(H._cloneOperation.nodes.getNode(0).name=W.operations[0].newName),[H]}),s.i(h.b)(K.a,M.a,(H,W,U)=>{const J=s.i(h.c)(H,W,U),G=W._cloneOperation.position;for(let Y of J)for(let X of Y.operations){const Z=X.sourcePosition.getShiftedBy(X.howMany);Z.isEqual(G)&&(X.howMany+=1)}return J}),s.i(h.b)(M.a,K.a,(H,W,U)=>{W=W.clone();const J=H._cloneOperation.position;for(let G of W.operations){const Y=G.sourcePosition.getShiftedBy(G.howMany);Y.isEqual(J)&&(G.howMany+=1)}return s.i(h.c)(H,W,U)})},function(o,r,s){'use strict';function d(T,E,S,O){const V=T.document,R=new P,F=new w.a(E,S,O,V.markers,V.version);T.addDelta(R),R.addOperation(F),V.applyOperation(F)}var u=s(19),f=s(17),h=s(16),w=s(106),C=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P extends u.a{get type(){return'marker'}get _reverseDeltaClass(){return P}static get className(){return'engine.model.delta.MarkerDelta'}}r.a=P,s.i(h.b)('setMarker',function(T,E){const S='string'==typeof T?T:T.name,O=this.document.markers.get(S);if(!E&&!O)throw new C.a('batch-setMarker-no-range: Range parameter is required when adding a new marker.');const V=O?O.getRange():null;return E?d(this,S,V,E):d(this,S,null,V),this}),s.i(h.b)('removeMarker',function(T){const E='string'==typeof T?T:T.name;if(!this.document.markers.has(E))throw new C.a('batch-removeMarker-no-marker: Trying to remove marker that does not exist.');const S=this.document.markers.get(E).getRange();return d(this,E,S,null),this}),f.a.register(P)},function(o,r,s){'use strict';function d(z){const K=z.textNode;if(K){const $=K.data,H=z.offset-K.startOffset;return!s.i(D.a)($,H)&&!s.i(D.b)($,H)}return!0}function*u(z,K){for(let $=!1;!$;){if($=!0,z){const H=z.next();H.done||($=!1,yield{walker:z,value:H.value})}if(K){const H=K.next();H.done||($=!1,yield{walker:K,value:H.value})}}}var f=s(300),h=s(301),w=s(3),C=s(1),P=s(309),T=s(16),E=s(304),S=s(305),O=s(310),V=s(33),R=s(306),F=s(92),N=s(7),I=s(0),M=s(4),D=s(269);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const L='$graveyard';class q{constructor(){this.version=0,this.schema=new O.a,this.history=new E.a(this),this.markers=new R.a,this.selection=new S.a(this),this._pendingChanges=[],this.roots=new Map,this.selection.on('change:range',()=>{for(let z of this.selection.getRanges())if(!this._validateSelectionRange(z))throw new I.a('document-selection-wrong-position: Range from document selection starts or ends at incorrect position.',{range:z})}),this.createRoot('$root',L)}get graveyard(){return this.getRoot(L)}applyOperation(z){if(z.baseVersion!==this.version)throw new I.a('model-document-applyOperation-wrong-version: Only operations with matching versions can be applied.',{operation:z});let K=z._execute();this.version++,this.history.addDelta(z.delta),K&&this.fire('change',z.type,K,z.delta.batch,z.delta.type)}batch(z){return new T.a(this,z)}createRoot(z='$root',K='main'){if(this.roots.has(K))throw new I.a('model-document-createRoot-name-exists: Root with specified name already exists.',{name:K});const $=new P.a(this,z,K);return this.roots.set(K,$),$}destroy(){this.selection.destroy(),this.stopListening()}enqueueChanges(z){if(this._pendingChanges.push(z),1==this._pendingChanges.length){for(;this._pendingChanges.length;)this._pendingChanges[0](),this._pendingChanges.shift();this.fire('changesDone')}}getRoot(z='main'){if(!this.roots.has(z))throw new I.a('model-document-getRoot-root-not-exist: Root with specified name does not exist.',{name:z});return this.roots.get(z)}hasRoot(z){return this.roots.has(z)}getRootNames(){return Array.from(this.roots.keys()).filter((z)=>z!=L)}getNearestSelectionRange(z,K='both'){if(this.schema.check({name:'$text',inside:z}))return new w.a(z);let $,H;('both'==K||'backward'==K)&&($=new V.a({startPosition:z,direction:'backward'})),('both'==K||'forward'==K)&&(H=new V.a({startPosition:z}));for(let W of u($,H)){const U=W.walker==$?'elementEnd':'elementStart',J=W.value;if(J.type==U&&this.schema.objects.has(J.item.name))return w.a.createOn(J.item);if(this.schema.check({name:'$text',inside:J.nextPosition}))return new w.a(J.nextPosition)}return null}toJSON(){const z=s.i(F.a)(this);return z.selection='[engine.model.LiveSelection]',z}_getDefaultRoot(){for(let z of this.roots.values())if(z!==this.graveyard)return z;return this.graveyard}_getDefaultRange(){const z=this._getDefaultRoot(),K=new C.a(z,[0]),$=this.getNearestSelectionRange(K);return $||new w.a(K)}_validateSelectionRange(z){return d(z.start)&&d(z.end)}}r.a=q,s.i(M.a)(q,N.a)},function(o,r,s){'use strict';var d=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(){this._deltas=[],this._historyPoints=new Map}addDelta(f){if(0<f.operations.length&&!this._historyPoints.has(f.baseVersion)){const h=this._deltas.length;this._deltas[h]=f,this._historyPoints.set(f.baseVersion,h)}}*getDeltas(f=0,h=_NumberPOSITIVE_INFINITY){if(0!==this._deltas.length){let w=this._getIndex(f);if(-1!=w)for(;w<this._deltas.length;){const C=this._deltas[w++];if(C.baseVersion>=h)break;yield C}}}getDelta(f){let h=this._historyPoints.get(f);if(h===void 0)return null;const w=[];for(h;h<this._deltas.length;h++){const C=this._deltas[h];if(C.baseVersion!=f)break;w.push(C)}return 0===w.length?null:w}removeDelta(f){this.updateDelta(f,[])}updateDelta(f,h){const w=this.getDelta(f);if(null!==w){for(let P of h)P.baseVersion=f;this._deltas.splice(this._getIndex(f),w.length,...h);const C=h.length-w.length;for(let P of this._historyPoints.keys())P>f&&this._historyPoints.set(P,this._historyPoints.get(P)+C)}}_getIndex(f){let h=this._historyPoints.get(f);if(h===void 0){const w=this._deltas[this._deltas.length-1],C=w.baseVersion+w.operations.length;if(0>f||f>=C)return-1;throw new d.a('model-history-wrong-version: Given base version points to the middle of a delta.')}return h}}},function(o,r,s){'use strict';function d(F){return F instanceof C.a||F instanceof w.a?F.getAttributes():null}var u=s(1),f=s(3),h=s(161),w=s(24),C=s(70),P=s(148),T=s(0),E=s(55),S=s(57);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const O='selection:',V=new Set(['addAttribute','removeAttribute','changeAttribute','addRootAttribute','removeRootAttribute','changeRootAttribute']);class R extends S.a{constructor(F){super(),this._document=F,this._attributePriority=new Map,this.listenTo(this._document,'change',(N,I)=>{V.has(I)&&this._updateAttributes(!1)})}get isCollapsed(){const F=this._ranges.length;return!(0!==F)||super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().start}get rangeCount(){return this._ranges.length?this._ranges.length:1}destroy(){for(let F=0;F<this._ranges.length;F++)this._ranges[F].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}addRange(F,N=!1){super.addRange(F,N),this.refreshAttributes()}removeAllRanges(){super.removeAllRanges(),this.refreshAttributes()}setRanges(F,N=!1){super.setRanges(F,N),this.refreshAttributes()}setAttribute(F,N){if(this.isCollapsed&&0===this.anchor.parent.childCount&&this._storeAttribute(F,N),this._setAttribute(F,N)){this.fire('change:attribute',{attributeKeys:[F],directChange:!0})}}removeAttribute(F){if(this.isCollapsed&&0===this.anchor.parent.childCount&&this._removeStoredAttribute(F),this._removeAttribute(F)){this.fire('change:attribute',{attributeKeys:[F],directChange:!0})}}setAttributesTo(F){F=s.i(P.a)(F),this.isCollapsed&&0===this.anchor.parent.childCount&&this._setStoredAttributesTo(F);const N=this._setAttributesTo(F);if(0<N.size){const I=Array.from(N);this.fire('change:attribute',{attributeKeys:I,directChange:!0})}}clearAttributes(){this.setAttributesTo([])}refreshAttributes(){this._updateAttributes(!0)}static createFromSelection(F){const N=new this(F._document);return N.setTo(F),N}_popRange(){this._ranges.pop().detach()}_pushRange(F){const N=this._prepareRange(F);N&&this._ranges.push(N)}_prepareRange(F){if(!(F instanceof f.a))throw new T.a('model-selection-added-not-range: Trying to add an object that is not an instance of Range.');if(F.root==this._document.graveyard)return void E.a.warn('model-selection-range-in-graveyard: Trying to add a Range that is in the graveyard root. Range rejected.');this._checkRange(F);const N=h.a.createFromRange(F);return this.listenTo(N,'change',(I,M)=>{N.root==this._document.graveyard&&this._fixGraveyardSelection(N,M),this.fire('change:range',{directChange:!1})}),N}_updateAttributes(F){const N=s.i(P.a)(this._getSurroundingAttributes()),I=s.i(P.a)(this.getAttributes());if(F)this._attributePriority=new Map,this._attrs=new Map;else for(let[D,L]of this._attributePriority)'low'==L&&(this._attrs.delete(D),this._attributePriority.delete(D));this._setAttributesTo(N,!1);const M=[];for(let[D,L]of this.getAttributes())I.has(D)&&I.get(D)===L||M.push(D);for(let[D]of I)this.hasAttribute(D)||M.push(D);0<M.length&&this.fire('change:attribute',{attributeKeys:M,directChange:!1})}static _getStoreAttributeKey(F){return O+F}_setAttribute(F,N,I=!0){const M=I?'normal':'low';if('low'==M&&'normal'==this._attributePriority.get(F))return!1;const D=super.getAttribute(F);return D!==N&&(this._attrs.set(F,N),this._attributePriority.set(F,M),!0)}_removeAttribute(F,N=!0){const I=N?'normal':'low';return'low'==I&&'normal'==this._attributePriority.get(F)?!1:!!super.hasAttribute(F)&&(this._attrs.delete(F),this._attributePriority.set(F,I),!0)}_setAttributesTo(F,N=!0){const I=new Set;for(let[M,D]of this.getAttributes())F.get(M)!==D&&this._removeAttribute(M,N)&&I.add(M);for(let[M,D]of F){const L=this._setAttribute(M,D,N);L&&I.add(M)}return I}*_getStoredAttributes(){const F=this.getFirstPosition().parent;if(this.isCollapsed&&0===F.childCount)for(let N of F.getAttributeKeys())if(0===N.indexOf(O)){const I=N.substr(O.length);yield[I,F.getAttribute(N)]}}_removeStoredAttribute(F){const N=R._getStoreAttributeKey(F);this._document.batch().removeAttribute(this.anchor.parent,N)}_storeAttribute(F,N){const I=R._getStoreAttributeKey(F);this._document.batch().setAttribute(this.anchor.parent,I,N)}_setStoredAttributesTo(F){const N=this.anchor.parent,I=this._document.batch();for(let[M]of this._getStoredAttributes()){const D=R._getStoreAttributeKey(M);I.removeAttribute(N,D)}for(let[M,D]of F){const L=R._getStoreAttributeKey(M);I.setAttribute(N,L,D)}}_getSurroundingAttributes(){const F=this.getFirstPosition();let N=null;if(!this.isCollapsed){const I=this.getFirstRange();for(let M of I)'text'==M.type&&null==N&&(N=M.item.getAttributes())}else{const I=F.textNode?F.textNode:F.nodeBefore,M=F.textNode?F.textNode:F.nodeAfter;if(N=d(I),N||(N=d(M)),!N)for(let D=I;D&&!N;)D=D.previousSibling,N=d(D);if(!N)for(let D=M;D&&!N;)D=D.nextSibling,N=d(D);N||(N=this._getStoredAttributes())}return N}_fixGraveyardSelection(F,N){const I=F.start.path,M=N.start.path.length-(I.length-2),D=N.start.path.slice(0,M);D[D.length-1]-=I[1];const L=new u.a(N.root,D);let q=this._document.getNearestSelectionRange(L);q||(q=new f.a(new u.a(L.root,[0])));const z=this._prepareRange(q),K=this._ranges.indexOf(F);F.detach(),this._ranges.splice(K,1,z)}}r.a=R},function(o,r,s){'use strict';var d=s(161),u=s(1),f=s(3),h=s(7),w=s(0),C=s(4);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(E){return this._markers.has(E)}get(E){return this._markers.get(E)||null}set(E,S){const O=E instanceof T?E.name:E,V=this._markers.get(O);if(V){const N=V.getRange();if(N.isEqual(S))return V;this.remove(O)}const R=d.a.createFromRange(S),F=new T(O,R);return this._markers.set(O,F),this.fire('add',F),F}remove(E){const S=E instanceof T?E.name:E,O=this._markers.get(S);return!!O&&(this._markers.delete(S),this.fire('remove',O),this._destroyMarker(O),!0)}*getMarkersAtPosition(E){for(let S of this)S.getRange().containsPosition(E)&&(yield S)}destroy(){for(let E of this._markers.values())this._destroyMarker(E);this._markers=null,this.stopListening()}*getMarkersGroup(E){for(let S of this._markers.values())S.name.startsWith(E+':')&&(yield S)}_destroyMarker(E){E.stopListening(),E._liveRange.detach(),E._liveRange=null}}r.a=P,s.i(C.a)(P,h.a);class T{constructor(E,S){this.name=E,this._liveRange=S,this._liveRange.delegate('change').to(this)}getStart(){if(!this._liveRange)throw new w.a('marker-destroyed: Operating on destroyed marker instance.');return u.a.createFromPosition(this._liveRange.start)}getEnd(){if(!this._liveRange)throw new w.a('marker-destroyed: Operating on destroyed marker instance.');return u.a.createFromPosition(this._liveRange.end)}getRange(){if(!this._liveRange)throw new w.a('marker-destroyed: Operating on destroyed marker instance.');return f.a.createFromRange(this._liveRange)}}s.i(C.a)(T,h.a)},function(o,r,s){'use strict';var d=s(68),u=s(37),f=s(106),h=s(28),w=s(69),C=s(32),P=s(107),T=s(38),E=s(108),S=s(109);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const O={};O[d.a.className]=d.a,O[u.a.className]=u.a,O[f.a.className]=f.a,O[h.a.className]=h.a,O[w.a.className]=w.a,O[C.a.className]=C.a,O[P.a.className]=P.a,O[T.a.className]=T.a,O[E.a.className]=E.a,O[S.a.className]=S.a;r.a=class{static fromJSON(R,F){return O[R.__className].fromJSON(R,F)}}},function(o,r,s){'use strict';function u(M){return[M.clone()]}function f(M,D){for(let L=0;L<D.length;L++)D[L].baseVersion=M+L+1;return D}function h(M,D){return null===M.targetPosition._getTransformedByDeletion(D.sourcePosition,D.howMany)}function w(M){return 0===M.length?null:1==M.length?M[0]:(M[0].end=M[M.length-1].end,M[0])}var C=s(37),P=s(68),T=s(109),E=s(108),S=s(106),O=s(28),V=s(38),R=s(69),F=s(3),N=s(49);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(M,D,L){let q,z;M instanceof C.a?q=I.InsertOperation:M instanceof P.a?q=I.AttributeOperation:M instanceof T.a?q=I.RootAttributeOperation:M instanceof E.a?q=I.RenameOperation:M instanceof S.a?q=I.MarkerOperation:M instanceof O.a?q=I.MoveOperation:z=u,q&&(D instanceof C.a?z=q.InsertOperation:D instanceof P.a?z=q.AttributeOperation:D instanceof T.a?z=q.RootAttributeOperation:D instanceof E.a?z=q.RenameOperation:D instanceof S.a?z=q.MarkerOperation:D instanceof O.a?z=q.MoveOperation:z=u);let K=z(M,D,L);return f(M.baseVersion,K)};const I={InsertOperation:{InsertOperation(M,D,L){const q=M.clone();return q.position=q.position._getTransformedByInsertion(D.position,D.nodes.maxOffset,!L),[q]},AttributeOperation:u,RootAttributeOperation:u,RenameOperation:u,MarkerOperation:u,MoveOperation(M,D,L){const q=M.clone();return q.position=M.position._getTransformedByMove(D.sourcePosition,D.targetPosition,D.howMany,!L,D.isSticky),[q]}},AttributeOperation:{InsertOperation(M,D){const L=M.range._getTransformedByInsertion(D.position,D.nodes.maxOffset,!0,!1);return L.reverse().map((q)=>{return new P.a(q,M.key,M.oldValue,M.newValue,M.baseVersion)})},AttributeOperation(M,D,L){if(M.key===D.key){let q=M.range.getDifference(D.range).map((K)=>{return new P.a(K,M.key,M.oldValue,M.newValue,M.baseVersion)});const z=M.range.getIntersection(D.range);return z&&(L?q.push(new P.a(z,D.key,D.newValue,M.newValue,M.baseVersion)):0===q.length&&q.push(new R.a(0))),q}return[M.clone()]},RootAttributeOperation:u,RenameOperation:u,MarkerOperation:u,MoveOperation(M,D){const L=F.a.createFromPositionAndShift(D.sourcePosition,D.howMany);let q=[];D instanceof V.a&&D._needsHolderElement&&M.range.root==D.targetPosition.root&&M.range.start.path[0]>=D._holderElementOffset&&(M=M.clone(),M.range.start.path[0]++,M.range.end.path[0]++);const z=w(M.range.getDifference(L)),K=M.range.getIntersection(L);return null!==z&&(z.start=z.start._getTransformedByDeletion(D.sourcePosition,D.howMany),z.end=z.end._getTransformedByDeletion(D.sourcePosition,D.howMany),q=z._getTransformedByInsertion(D.getMovedRangeStart(),D.howMany,!0,!1).reverse()),null!==K&&(K.start=K.start._getCombined(D.sourcePosition,D.getMovedRangeStart()),K.end=K.end._getCombined(D.sourcePosition,D.getMovedRangeStart()),q.push(K)),q.map(($)=>{return new P.a($,M.key,M.oldValue,M.newValue,M.baseVersion)})}},RootAttributeOperation:{InsertOperation:u,AttributeOperation:u,RootAttributeOperation(M,D,L){return M.root!==D.root||M.key!==D.key||(M.newValue===D.newValue||L)&&M.newValue!==D.newValue?[M.clone()]:[new R.a(M.baseVersion)]},RenameOperation:u,MarkerOperation:u,MoveOperation:u},RenameOperation:{InsertOperation(M,D){const L=M.clone();return L.position=L.position._getTransformedByInsertion(D.position,D.nodes.maxOffset,!0),[L]},AttributeOperation:u,RootAttributeOperation:u,RenameOperation(M,D,L){const q=M.clone();if(M.position.isEqual(D.position))if(L)q.oldName=D.newName;else return[new R.a(M.baseVersion)];return[q]},MarkerOperation:u,MoveOperation(M,D){const L=M.clone(),q=L.position.isEqual(D.sourcePosition);return L.position=L.position._getTransformedByMove(D.sourcePosition,D.targetPosition,D.howMany,!0,q),[L]}},MarkerOperation:{InsertOperation(M,D){const L=M.clone();return L.oldRange&&(L.oldRange=L.oldRange._getTransformedByInsertion(D.position,D.nodes.maxOffset,!1,!1)[0]),L.newRange&&(L.newRange=L.newRange._getTransformedByInsertion(D.position,D.nodes.maxOffset,!1,!1)[0]),[L]},AttributeOperation:u,RootAttributeOperation:u,RenameOperation:u,MarkerOperation(M,D,L){const q=M.clone();if(M.name==D.name)if(L)q.oldRange=D.newRange;else return[new R.a(M.baseVersion)];return[q]},MoveOperation(M,D){const L=M.clone();if(L.oldRange){const q=L.oldRange._getTransformedByMove(D.sourcePosition,D.targetPosition,D.howMany);L.oldRange=F.a.createFromRanges(q)}if(L.newRange){const q=L.newRange._getTransformedByMove(D.sourcePosition,D.targetPosition,D.howMany);L.newRange=F.a.createFromRanges(q)}return[L]}},MoveOperation:{InsertOperation(M,D,L){let q=F.a.createFromPositionAndShift(M.sourcePosition,M.howMany);q=q._getTransformedByInsertion(D.position,D.nodes.maxOffset,!1,M.isSticky)[0];let z=new M.constructor(q.start,q.end.offset-q.start.offset,M instanceof V.a?M.baseVersion:M.targetPosition._getTransformedByInsertion(D.position,D.nodes.maxOffset,!L),M instanceof V.a?void 0:M.baseVersion);return z.isSticky=M.isSticky,z._holderElementOffset=M._holderElementOffset,[z]},AttributeOperation:u,RootAttributeOperation:u,RenameOperation:u,MarkerOperation:u,MoveOperation(M,D,L){if(h(M,D)&&h(D,M))return[D.getReversed()];if(M instanceof V.a&&D instanceof V.a){const Y=M.targetPosition.path[0],X=D.targetPosition.path[0];Y>=X&&L&&(M=M.clone(),M.targetPosition.path[0]++)}M instanceof V.a&&!(D instanceof V.a)?L=!0:!(M instanceof V.a)&&D instanceof V.a&&(L=!1);const q=F.a.createFromPositionAndShift(M.sourcePosition,M.howMany),z=F.a.createFromPositionAndShift(D.sourcePosition,D.howMany);let K=[],$=w(q.getDifference(z));$&&($.start=$.start._getTransformedByMove(D.sourcePosition,D.targetPosition,D.howMany,!M.isSticky,!1),$.end=$.end._getTransformedByMove(D.sourcePosition,D.targetPosition,D.howMany,M.isSticky,!1),K.push($));const H=q.getIntersection(z);let W=s.i(N.a)(M.sourcePosition.getParentPath(),D.sourcePosition.getParentPath()),U=q.containsPosition(D.targetPosition)||q.start.isEqual(D.targetPosition)&&M.isSticky||q.end.isEqual(D.targetPosition)&&M.isSticky,J=z.containsRange(q)&&(z.containsPosition(M.targetPosition)||z.start.isEqual(M.targetPosition)||z.end.isEqual(M.targetPosition));if(null!==H&&('extension'===W||'same'===W&&L||J)&&!U&&(H.start=H.start._getCombined(D.sourcePosition,D.getMovedRangeStart()),H.end=H.end._getCombined(D.sourcePosition,D.getMovedRangeStart()),$&&q.start.isBefore(z.start)?K.push(H):K.unshift(H)),0===K.length)return M instanceof V.a?(M=M.clone(),M.howMany=0,M.sourcePosition=D.targetPosition,[M]):[new R.a(M.baseVersion)];let G=M.targetPosition._getTransformedByMove(D.sourcePosition,D.targetPosition,D.howMany,!L,D.isSticky||J);return K.reverse().map((Y)=>{let X=new M.constructor(Y.start,Y.end.offset-Y.start.offset,M instanceof V.a?M.baseVersion:G,M instanceof V.a?void 0:M.baseVersion);return X.isSticky=M.isSticky,X._holderElementOffset=M._holderElementOffset,X})}}}},function(o,r,s){'use strict';var d=s(5);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{constructor(f,h,w='main'){super(h),this._doc=f,this.rootName=w}get document(){return this._doc}is(f,h){return h?'rootElement'==f&&h==this.name||super.is(f,h):'rootElement'==f||super.is(f)}toJSON(){return this.rootName}}r.a=u},function(o,r,s){'use strict';function d(S,O,V){for(let R=V.length-1,F=O.length-1;0<=R&&0<=F;){const N=O[F];if(!S.hasItem(N))return!1;const I=S._extensionChains.get(N);if(I.includes(V[R]))R--,F--;else return!1}return!0}var u=s(1),f=s(5),h=s(92),w=s(11),C=s(145),P=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class T{constructor(){this.objects=new Set,this.limits=new Set,this._items=new Map,this._extensionChains=new Map,this.registerItem('$root'),this.registerItem('$block'),this.registerItem('$inline'),this.registerItem('$text','$inline'),this.allow({name:'$block',inside:'$root'}),this.allow({name:'$inline',inside:'$block'}),this.registerItem('$clipboardHolder','$root'),this.allow({name:'$inline',inside:'$clipboardHolder'})}allow(S){this._getItem(S.name).allow(T._normalizeQueryPath(S.inside),S.attributes)}disallow(S){this._getItem(S.name).disallow(T._normalizeQueryPath(S.inside),S.attributes)}requireAttributes(S,O){this._getItem(S).requireAttributes(O)}check(S){if(!this.hasItem(S.name))return!1;s.i(w.a)(S.attributes)?0===S.attributes.length&&S.attributes.push(void 0):S.attributes=[S.attributes];const O=T._normalizeQueryPath(S.inside),V=this._extensionChains.get(S.name).map((R)=>{return this._getItem(R)});if(!this._getItem(S.name)._checkRequiredAttributes(S.attributes))return!1;for(let R of S.attributes)for(let F of V)if(F._hasMatchingPath('disallow',O,R))return!1;for(let R of S.attributes){let F=!1;for(let N of V)if(N._hasMatchingPath('allow',O,R)){F=!0;break}if(!F)return!1}return!0}hasItem(S){return this._items.has(S)}registerItem(S,O){if(this.hasItem(S))throw new P.a('model-schema-item-exists: Item with specified name already exists in schema.');if(!!O&&!this.hasItem(O))throw new P.a('model-schema-no-item: Item with specified name does not exist in schema.');this._items.set(S,new E(this));const V=this.hasItem(O)?this._extensionChains.get(O).concat(S):[S];this._extensionChains.set(S,V)}itemExtends(S,O){if(!this.hasItem(S)||!this.hasItem(O))throw new P.a('model-schema-no-item: Item with specified name does not exist in schema.');const V=this._extensionChains.get(S);return V.some((R)=>R==O)}_getItem(S){if(!this.hasItem(S))throw new P.a('model-schema-no-item: Item with specified name does not exist in schema.');return this._items.get(S)}static _normalizeQueryPath(S){let O=[];if(s.i(w.a)(S))for(let V of S)V instanceof f.a?O.push(V.name):s.i(C.a)(V)&&O.push(V);else if(S instanceof u.a){for(let V=S.parent;null!==V;)O.push(V.name),V=V.parent;O.reverse()}else s.i(C.a)(S)&&(O=S.split(' '));return O}}r.a=T;class E{constructor(S){this._schema=S,this._allowed=[],this._disallowed=[],this._requiredAttributes=[]}allow(S,O){this._addPath('_allowed',S,O)}disallow(S,O){this._addPath('_disallowed',S,O)}requireAttributes(S){this._requiredAttributes.push(S)}_addPath(S,O,V){O=O.slice(),s.i(w.a)(V)||(V=[V]);for(let R of V)this[S].push({path:O,attribute:R})}_getPaths(S,O){const V='allow'===S?this._allowed:this._disallowed,R=[];for(let F of V)F.attribute===O&&R.push(F.path);return R}_checkRequiredAttributes(S){let O=!0;for(let V of this._requiredAttributes){O=!0;for(let R of V)if(-1==S.indexOf(R)){O=!1;break}if(O)break}return O}_hasMatchingPath(S,O,V){const R=this._getPaths(S,V);for(const F of R)if(d(this._schema,O,F))return!0;return!1}toJSON(){const S=s.i(h.a)(this);return S._schema='[model.Schema]',S}}},function(o,r,s){'use strict';var d=s(73),u=s(318),f=s(162),h=s(166),w=s(58),C=s(55),P=s(165),T=s(317),E=s(314),S=s(315),O=s(313),V=s(4),R=s(31);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class F{constructor(){this.domRoots=new Map,this.selection=new d.a,this.domConverter=new f.a,this.roots=new Map,this.set('isFocused',!1),this.renderer=new u.a(this.domConverter,this.selection),this.renderer.bind('isFocused').to(this,'isFocused'),this._observers=new Map,this.addObserver(P.a),this.addObserver(T.a),this.addObserver(E.a),this.addObserver(S.a),this.addObserver(O.a),s.i(w.h)(this),this.on('render',()=>{this.disableObservers(),this.renderer.render(),this.enableObservers()})}addObserver(N){let I=this._observers.get(N);if(I)return I;I=new N(this),this._observers.set(N,I);for(let[M,D]of this.domRoots)I.observe(D,M);return I.enable(),I}getObserver(N){return this._observers.get(N)}createRoot(N,I='main'){const M='string'==typeof N?N:N.tagName,D=new h.a(M.toLowerCase(),I);return D.document=this,this.roots.set(I,D),D.on('change:children',(L,q)=>this.renderer.markToSync('children',q)),D.on('change:attributes',(L,q)=>this.renderer.markToSync('attributes',q)),D.on('change:text',(L,q)=>this.renderer.markToSync('text',q)),this.domConverter.isElement(N)&&this.attachDomRoot(N,I),D}attachDomRoot(N,I='main'){const M=this.getRoot(I);this.domRoots.set(I,N),this.domConverter.bindElements(N,M),this.renderer.markToSync('children',M),this.renderer.domDocuments.add(N.ownerDocument);for(let D of this._observers.values())D.observe(N,I)}getRoot(N='main'){return this.roots.get(N)}getDomRoot(N='main'){return this.domRoots.get(N)}render(){this.fire('render')}focus(){if(!this.isFocused){const N=this.selection.editableElement;N?(this.domConverter.focus(N),this.render()):C.a.warn('view-focus-no-selection: There is no selection in any editable to focus.')}}disableObservers(){for(let N of this._observers.values())N.disable()}enableObservers(){for(let N of this._observers.values())N.enable()}destroy(){for(let N of this._observers.values())N.destroy()}}r.a=F,s.i(V.a)(F,R.a)},function(o,r,s){'use strict';var d=s(59);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{constructor(f){super(f),this.domEventType='click'}onDomEvent(f){this.fire(f.type,f)}}r.a=u},function(o,r,s){'use strict';function d(P){return P==h.d.arrowright||P==h.d.arrowleft||P==h.d.arrowup||P==h.d.arrowdown}var u=s(48),f=s(73),h=s(22),w=s(139);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends u.a{constructor(P){super(P),this._fireSelectionChangeDoneDebounced=s.i(w.a)((T)=>this.document.fire('selectionChangeDone',T),200)}observe(){const P=this.document;P.on('keydown',(T,E)=>{const S=P.selection;S.isFake&&d(E.keyCode)&&this.isEnabled&&(E.preventDefault(),this._handleSelectionMove(E.keyCode))},{priority:'lowest'})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(P){const T=this.document.selection,E=f.a.createFromSelection(T);E.setFake(!1),(P==h.d.arrowleft||P==h.d.arrowup)&&E.collapseToStart(),(P==h.d.arrowright||P==h.d.arrowdown)&&E.collapseToEnd();const S={oldSelection:T,newSelection:E,domSelection:null};this.document.fire('selectionChange',S),this._fireSelectionChangeDoneDebounced(S)}}r.a=C},function(o,r,s){'use strict';var d=s(59);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{constructor(f){super(f),this.domEventType=['focus','blur'],this.useCapture=!0,f.on('focus',()=>{f.isFocused=!0}),f.on('blur',(h,w)=>{const C=f.selection.editableElement;(null===C||C===w.target)&&(f.isFocused=!1,f.render())})}onDomEvent(f){this.fire(f.type,f)}}r.a=u},function(o,r,s){'use strict';var d=s(59),u=s(22);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.domEventType='keydown'}onDomEvent(h){this.fire('keydown',h,{keyCode:h.keyCode,altKey:h.altKey,ctrlKey:h.ctrlKey||h.metaKey,shiftKey:h.shiftKey,get keystroke(){return s.i(u.c)(this)}})}}r.a=f},function(o,r,s){'use strict';var d=s(59);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{constructor(f){super(f),this.domEventType='mousedown'}onDomEvent(f){this.fire(f.type,f)}}r.a=u},function(o,r,s){'use strict';var d=s(48),u=s(165),f=s(55),h=s(139);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends d.a{constructor(C){super(C),this.mutationObserver=C.getObserver(u.a),this.document=C,this.selection=C.selection,this.domConverter=C.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=s.i(h.a)((P)=>this.document.fire('selectionChangeDone',P),200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),2e3)}observe(C){const P=C.ownerDocument;this._documents.has(P)||(this.listenTo(P,'selectionchange',()=>{this._handleSelectionChange(P)}),this._documents.add(P))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionChange(C){if(this.isEnabled&&this.document.isFocused){this.mutationObserver.flush();const P=C.defaultView.getSelection(),T=this.domConverter.domSelectionToView(P);if(!this.selection.isEqual(T)){if(this._isInfiniteLoop(T))return void f.a.warn('selectionchange-infinite-loop: Selection change observer detected an infinite rendering loop.');const E={oldSelection:this.selection,newSelection:T,domSelection:P};this.document.fire('selectionChange',E),this._fireSelectionChangeDoneDebounced(E)}}}_isInfiniteLoop(C){return this._lastSelection&&this._lastButOneSelection&&(C.isEqual(this._lastSelection)||C.isEqual(this._lastButOneSelection))?this._loopbackCounter++:(this._lastButOneSelection=this._lastSelection,this._lastSelection=C,this._loopbackCounter=0),!!(50<this._loopbackCounter)}_clearInfiniteLoop(){this._lastSelection=null,this._lastButOneSelection=null,this._loopbackCounter=0}}r.a=w},function(o,r,s){'use strict';var d=s(29),u=s(25),f=s(58),h=s(4),w=s(183),C=s(387),P=s(391),T=s(31),E=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class S{constructor(O,V){this.domDocuments=new Set,this.domConverter=O,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=V,this._inlineFiller=null,this.isFocused=!1,this._fakeSelectionContainer=null}markToSync(O,V){if('text'===O)this.domConverter.getCorrespondingDom(V.parent)&&this.markedTexts.add(V);else{if(!this.domConverter.getCorrespondingDom(V))return;if('attributes'===O)this.markedAttributes.add(V);else if('children'===O)this.markedChildren.add(V);else throw new E.a('view-renderer-unknown-type: Unknown type passed to Renderer.markToSync.')}}render(){let O;this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?O=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(O=this.selection.getFirstPosition(),this.markedChildren.add(O.parent));for(let V of this.markedTexts)!this.markedChildren.has(V.parent)&&this.domConverter.getCorrespondingDom(V.parent)&&this._updateText(V,{inlineFillerPosition:O});for(let V of this.markedAttributes)this._updateAttrs(V);for(let V of this.markedChildren)this._updateChildren(V,{inlineFillerPosition:O});this._updateSelection(),this._updateFocus(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear(),this._inlineFiller=this._getInlineFillerNode(O)}_getInlineFillerNode(O){if(!O)return void(this._inlineFiller=null);const V=this.domConverter.viewPositionToDom(O);if(!V||!s.i(f.c)(V.parent))throw new E.a('view-renderer-cannot-find-filler: Cannot find filler node by its position.');return V.parent}_getInlineFillerPosition(){const O=this.selection.getFirstPosition();return O.parent.is('text')?u.a.createBefore(this.selection.getFirstPosition().parent):O}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const O=this.selection.getFirstPosition(),V=this.domConverter.viewPositionToDom(O);return V&&this.domConverter.isText(V.parent)&&s.i(f.c)(V.parent)}_removeInlineFiller(){const O=this._inlineFiller;if(!s.i(f.c)(O))throw new E.a('view-renderer-filler-was-lost: The inline filler node was lost.');s.i(f.f)(O)?O.parentNode.removeChild(O):O.data=O.data.substr(f.d),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const O=this.selection.getFirstPosition(),V=O.parent,R=O.offset;if(!this.domConverter.getCorrespondingDomElement(V.root))return!1;if(!V.is('element'))return!1;if(R===V.getFillerOffset())return!1;const F=O.nodeBefore,N=O.nodeAfter;return F instanceof d.a||N instanceof d.a?!1:!0}_updateText(O,V){const R=this.domConverter.getCorrespondingDom(O),F=this.domConverter.viewToDom(O,R.ownerDocument),N=R.data;let I=F.data;const M=V.inlineFillerPosition;M&&M.parent==O.parent&&M.offset==O.index&&(I=f.i+I),N!=I&&(R.data=I)}_updateAttrs(O){const V=this.domConverter.getCorrespondingDom(O),R=Array.from(V.attributes).map((N)=>N.name),F=O.getAttributeKeys();for(let N of F)V.setAttribute(N,O.getAttribute(N));for(let N of R)O.hasAttribute(N)||V.removeAttribute(N)}_updateChildren(O,V){const F=this.domConverter,N=F.getCorrespondingDom(O),I=N.ownerDocument,M=V.inlineFillerPosition,D=N.childNodes,L=Array.from(F.viewChildrenToDom(O,I,{bind:!0}));if(M&&M.parent==O){const K=L[M.offset];this.domConverter.isText(K)?K.data=f.i+K.data:L.splice(M.offset,0,I.createTextNode(f.i))}const q=s.i(w.a)(D,L,function(K,$){if(K===$)return!0;return F.isText(K)&&F.isText($)?K.data===$.data:s.i(f.e)(K,F.blockFiller)&&s.i(f.e)($,F.blockFiller)});let z=0;for(let K of q)'insert'===K?(s.i(C.a)(N,z,L[z]),z++):'delete'===K?s.i(P.a)(D[z]):z++}_updateSelection(){if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const O=this.domConverter.getCorrespondingDomElement(this.selection.editableElement);this.isFocused&&O&&(this.selection.isFake?this._updateFakeSelection(O):(this._removeFakeSelection(),this._updateDomSelection(O)))}_updateFakeSelection(O){const V=O.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=V.createElement('div'),this._fakeSelectionContainer.style.position='fixed',this._fakeSelectionContainer.style.top=0,this._fakeSelectionContainer.style.left='-9999px',this._fakeSelectionContainer.appendChild(V.createTextNode('\\xA0'))),this._fakeSelectionContainer.parentElement||O.appendChild(this._fakeSelectionContainer);const R=this.selection.fakeSelectionLabel||'\\xA0';this._fakeSelectionContainer.firstChild.data=R;const F=V.getSelection();F.removeAllRanges();const N=new Range;N.selectNodeContents(this._fakeSelectionContainer),F.addRange(N),this.domConverter.bindFakeSelection(this._fakeSelectionContainer,this.selection)}_updateDomSelection(O){const V=O.ownerDocument.defaultView.getSelection(),R=V&&this.domConverter.domSelectionToView(V);if(!(R&&this.selection.isEqual(R))){const F=this.domConverter.viewPositionToDom(this.selection.anchor),N=this.domConverter.viewPositionToDom(this.selection.focus);V.collapse(F.parent,F.offset),V.extend(N.parent,N.offset)}}_removeDomSelection(){for(let O of this.domDocuments){const V=O.getSelection();if(V.rangeCount){const R=O.activeElement,F=this.domConverter.getCorrespondingViewElement(R);R&&F&&O.getSelection().removeAllRanges()}}}_removeFakeSelection(){const O=this._fakeSelectionContainer;O&&O.remove()}_updateFocus(){if(this.isFocused){const O=this.selection.editableElement;O&&this.domConverter.focus(O)}}}r.a=S,s.i(h.a)(S,T.a)},function(o,r,s){'use strict';var d=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u{constructor(f,h,w){if(this.textNode=f,0>h||h>f.data.length)throw new d.a('view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.');if(0>w||h+w>f.data.length)throw new d.a('view-textproxy-wrong-length: Given length value is incorrect.');this.data=f.data.substring(h,h+w),this.offsetInText=h}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(f){return'textProxy'==f}getAncestors(f={includeNode:!1,parentFirst:!1}){const h=[];for(let w=f.includeNode?this.textNode:this.parent;null!==w;)h[f.parentFirst?'push':'unshift'](w),w=w.parent;return h}}r.a=u},function(o,r,s){'use strict';var d=s(2),u=s(321),f=s(322);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{init(){const w=this.editor,C=w.editing.view;C.addObserver(f.a),w.commands.set('enter',new u.a(w)),this.listenTo(C,'enter',(P,T)=>{w.execute('enter'),T.preventDefault()},{priority:'low'})}}r.a=h},function(o,r,s){'use strict';function d(C,P,T,E){const S=T.isCollapsed,O=T.getFirstRange(),V=O.start.parent,R=O.end.parent;if(!(E.limits.has(V.name)||E.limits.has(R.name))){if(V.root==V)return void(S||C.deleteContent(T,P));if(S)u(P,T,O.start);else{const F=O.start.isAtStart&&O.end.isAtEnd;C.deleteContent(T,P,{merge:F}),F||(V==R?u(P,T,T.focus):T.collapse(R))}}}function u(C,P,T){if(T.isAtEnd){const E=T.parent,S=new E.constructor(E.name,E.getAttributes());C.insert(h.a.createAfter(T.parent),S)}else C.split(T);P.collapse(T.parent.nextSibling)}var f=s(12),h=s(1);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends f.a{_doExecute(){const C=this.editor.document,P=C.batch();C.enqueueChanges(()=>{d(this.editor.data,P,C.selection,C.schema),this.fire('afterExecute',{batch:P})})}}r.a=w},function(o,r,s){'use strict';var d=s(48),u=s(112),f=s(22);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{constructor(w){super(w),w.on('keydown',(C,P)=>{this.isEnabled&&P.keyCode==f.d.enter&&w.fire('enter',new u.a(w,P.domEvent))})}observe(){}}r.a=h},function(o,r,s){'use strict';function d(E,S){return Array.prototype.concat(...E.map((O)=>[O,S]))}var u=s(114),f=s(325),h=s(2),w=s(373),C=s(364),P=s(76);throw new Error('Cannot find module \"../theme/theme.scss\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(3),u=s(12),f=s(57);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends u.a{constructor(w,C){super(w),Object.assign(this,C),this.set('value',!1),this.listenTo(w.document,'changesDone',()=>this._updateValue())}_doExecute(w={}){const C=this.editor,P=C.document,T=this.value;P.enqueueChanges(()=>{const E=w.batch||P.batch();for(let S of P.selection.getSelectedBlocks())if(!T)S.is(this.modelElement)||E.rename(S,this.modelElement);else if(S.is(this.modelElement)){const O=new f.a;O.addRange(d.a.createIn(S)),C.execute('paragraph',{selection:O,batch:E})}})}_updateValue(){const w=this.editor.document.selection.getSelectedBlocks().next().value;w&&(this.value=w.is(this.modelElement))}}r.a=h},function(o,r,s){'use strict';var d=s(2),u=s(45),f=s(46),h=s(114),w=s(324);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const C='paragraph';class P extends d.a{constructor(T){super(T),T.config.define('heading',{options:[{modelElement:'paragraph',title:'Paragraph',class:'ck-heading_paragraph'},{modelElement:'heading1',viewElement:'h2',title:'Heading 1',class:'ck-heading_heading1'},{modelElement:'heading2',viewElement:'h3',title:'Heading 2',class:'ck-heading_heading2'},{modelElement:'heading3',viewElement:'h4',title:'Heading 3',class:'ck-heading_heading3'}]})}static get requires(){return[h.a]}init(){const T=this.editor,E=T.data,S=T.editing,O=T.config.get('heading.options');for(let V of O)V.modelElement!==C&&(T.document.schema.registerItem(V.modelElement,'$block'),s.i(u.a)().for(E.modelToView,S.modelToView).fromElement(V.modelElement).toElement(V.viewElement),s.i(f.a)().for(E.viewToModel).fromElement(V.viewElement).toElement(V.modelElement),T.commands.set(V.modelElement,new w.a(T,V)))}afterInit(){const T=this.editor,E=T.commands.get('enter'),S=T.config.get('heading.options');E&&this.listenTo(E,'afterExecute',(O,V)=>{const R=T.document.selection.getFirstPosition().parent,F=V.batch,N=S.some((I)=>R.is(I.modelElement));N&&!R.is(C)&&0===R.childCount&&F.rename(R,C)})}}r.a=P},function(o,r,s){'use strict';var d=s(2),u=s(168),f=s(339),h=s(335);throw new Error('Cannot find module \"../theme/theme.scss\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function f(P,T,E,S){const O=P.name.split(':'),V=O[0]+':'+O[1];if(E.consume(T.item,V)){const R=S.mapper.toViewElement(T.item),F=R.getChild(0);'removeAttribute'==O[0]?F.removeAttribute(T.attributeKey):F.setAttribute(T.attributeKey,T.attributeNewValue)}}var h=s(5),w=s(1),C=s(20);r.b=function(){return(P,T,E,S)=>{const O=T.input;if(E.test(O,{name:!0,class:'image'})&&S.schema.check({name:'image',inside:T.context,attributes:'src'})){const V=O.getChild(0);if(V&&'img'==V.name&&E.test(V,{name:!0,attribute:'src'})){E.consume(O,{name:!0,class:'image'}),E.consume(V,{name:!0,attribute:'src'});const R=new h.a('image',{src:V.getAttribute('src')});E.consume(V,{attribute:['alt']})&&R.setAttribute('alt',V.getAttribute('alt')),T.context.push(R);const F=S.convertChildren(O,E,T),N=w.a.createAt(R,'end');C.a.insert(N,F),T.context.pop(),T.output=R}}}},r.a=function(P,T){for(let E of P)E.on(`addAttribute:${T}:image`,f),E.on(`changeAttribute:${T}:image`,f),E.on(`removeAttribute:${T}:image`,f)}},function(o,r,s){'use strict';var d=s(2),u=s(329);throw new Error('Cannot find module \"../theme/imagecaption/theme.scss\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';function d(L,q,z,K){if('insert'===q){const $=new P.a({boundaries:z.range,ignoreElementEnd:!0});for(let H of $){const W=H.item;'elementStart'==H.type&&s.i(I.b)(W)&&!s.i(M.c)(W)&&K.document.enqueueChanges(()=>{K.insert(R.a.createAt(W,'end'),new T.a('caption'))})}}}function u(L,q){return(z,K)=>{if(h(K.item)){const $=K.item.parent,H=$.parent,W=q.toViewElement(H);let U=q.toViewElement($);W&&!U&&(U=L(),w(U,$,W,q))}}}function f(L){return(q,z,K,$)=>{const H=z.item;if(s.i(I.b)(H.parent)&&0<H.childCount){if(!K.consume(z.item,'insert'))return;const W=$.mapper.toViewElement(z.range.start.parent),U=L instanceof S.a?L.clone(!0):L();w(U,z.item,W,$.mapper)}}}function h(L){return!!(L.parent&&'caption'==L.parent.name&&L.parent.parent&&'image'==L.parent.parent.name)}function w(L,q,z,K){const $=F.a.createAt(z,'end');V.a.insert($,L),K.bindElements(q,L)}var C=s(2),P=s(33),T=s(5),E=s(39),S=s(21),O=s(34),V=s(75),R=s(1),F=s(25),N=s(46),I=s(40),M=s(330);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class D extends C.a{init(){const L=this.editor,q=L.document,z=L.editing.view,K=q.schema,$=L.data,H=L.editing,W=H.mapper;this._createCaption=s.i(M.a)(z),K.registerItem('caption'),K.allow({name:'$inline',inside:'caption'}),K.allow({name:'caption',inside:'image'}),K.limits.add('caption'),q.on('change',d),s.i(N.a)().for($.viewToModel).from(M.b).toElement('caption'),$.modelToView.on('insert:caption',f(new E.a('figcaption'))),H.modelToView.on('insert:caption',f(this._createCaption)),H.modelToView.on('insert',u(this._createCaption,W),{priority:'high'}),this.listenTo(z,'render',()=>this._updateView(),{priority:'high'})}_removeEmptyCaption(){const L=this.editor.editing.view.selection,q=this._lastSelectedEditable;if(!q)return;if(L.editableElement===q)return;const z=L.getSelectedElement();if(z&&s.i(I.a)(z)){const K=q.findAncestor(($)=>$==z);if(K)return}if(0===q.childCount){const K=this.editor.editing.mapper;V.a.remove(O.a.createOn(q)),K.unbindViewElement(q)}}_addCaptionWhenSelected(){const L=this.editor.editing,q=L.view.selection,z=q.getSelectedElement(),K=L.mapper;if(z&&s.i(I.a)(z)){const $=K.toModelElement(z),H=s.i(M.c)($);let W=K.toViewElement(H);W||(W=this._createCaption(),w(W,H,z,K)),this._lastSelectedEditable=W}}_updateView(){const L=this.editor.editing.view.selection;this._removeEmptyCaption(),this._addCaptionWhenSelected();const q=L.editableElement;q&&s.i(M.d)(L.editableElement)&&(this._lastSelectedEditable=L.editableElement)}}r.a=D},function(o,r,s){'use strict';var w=s(71),C=s(5);r.a=function(T){return()=>{const E=new w.a('figcaption',{contenteditable:!0});return E.document=T,E.setCustomProperty(P,!0),E.on('change:isFocused',(S,O,V)=>{V?E.addClass('focused'):E.removeClass('focused')}),E}},r.d=function(T){return!!T.getCustomProperty(P)},r.c=function(T){for(let E of T.getChildren())if(E instanceof C.a&&'caption'==E.name)return E;return null},r.b=function(T){const E=T.parent;return'figcaption'==T.name&&E&&'figure'==E.name&&E.hasClass('image')?{name:!0}:null};/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const P=Symbol('imageCaption')},function(o,r,s){'use strict';var d=s(2),u=s(334),f=s(26);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{static get requires(){return[u.a]}init(){const w=this.editor.config.get('image.styles');for(let P of w)this._createButton(P);const C=this.editor.config.get('image.defaultToolbar');C&&(C.length&&C.push('|'),w.forEach((P)=>C.push(P.name)))}_createButton(w){const C=this.editor,P=C.commands.get(w.name);C.ui.componentFactory.add(w.name,(T)=>{const E=new f.a(T);return E.set({label:w.title,icon:w.icon,tooltip:!0}),E.bind('isEnabled').to(P,'isEnabled'),E.bind('isOn').to(P,'value'),this.listenTo(E,'execute',()=>C.execute(w.name)),E})}}r.a=h},function(o,r,s){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function f(T,E,S,O){const V=E.input,R=E.output;if(S.test(V,{class:T.className})&&s.i(P.b)(R)){const F=[...R.getAttributeKeys(),'imageStyle'];O.schema.check({name:'image',inside:E.context,attributes:F})&&(S.consume(V,{class:T.className}),R.setAttribute('imageStyle',T.value))}}function h(T,E){for(let S of E)if(S.value===T)return S}function w(T,E,S){return E&&('changeAttribute'==T||'removeAttribute'==T)&&(S.removeClass(E.className),!0)}function C(T,E,S){return E&&('addAttribute'==T||'changeAttribute'==T)&&(S.addClass(E.className),!0)}var P=s(40);r.a=function(T){return(E,S,O,V)=>{const R=E.name.split(':')[0],F=R+':imageStyle';if(O.test(S.item,F)){const N=h(S.attributeNewValue,T),I=h(S.attributeOldValue,T),M=V.mapper.toViewElement(S.item);(w(R,I,M)||C(R,N,M))&&O.consume(S.item,F)}}},r.b=function(T){const E=T.filter((S)=>null!==S.value);return(S,O,V,R)=>{for(let F of E)f(F,O,V,R)}}},function(o,r,s){'use strict';var d=s(12),u=s(40);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h,w){super(h),this.set('value',!1),this.style=w,this.listenTo(h.document,'changesDone',()=>{this._updateValue(),this.refreshState()})}_updateValue(){const h=this.editor.document,w=h.selection.getSelectedElement();return w?void(null===this.style.value?this.value=!w.hasAttribute('imageStyle'):this.value=w.getAttribute('imageStyle')==this.style.value):void(this.value=!1)}_checkEnabled(){const h=this.editor.document.selection.getSelectedElement();return s.i(u.b)(h)}_doExecute(h={}){if(this.value)return;const w=this.editor,C=w.document,P=C.selection,T=P.getSelectedElement();C.enqueueChanges(()=>{const E=h.batch||C.batch();E.setAttribute(T,'imageStyle',this.style.value)})}}r.a=f},function(o,r,s){'use strict';var d=s(2),u=s(333),f=s(168),h=s(332);throw new Error('Cannot find module \"@ckeditor/ckeditor5-core/theme/icons/object-center.svg\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(2),u=s(26),f=s(337),h=s(359),w=s(176),C=s(170),P=s(338),T=s(169);throw new Error('Cannot find module \"@ckeditor/ckeditor5-core/theme/icons/low-vision.svg\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(12),u=s(40);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.set('value',!1),this.listenTo(h.document,'changesDone',()=>{this._updateValue(),this.refreshState()})}_updateValue(){const h=this.editor.document,w=h.selection.getSelectedElement();this.value=s.i(u.b)(w)&&w.hasAttribute('alt')&&w.getAttribute('alt')}_checkEnabled(){const h=this.editor.document.selection.getSelectedElement();return s.i(u.b)(h)}_doExecute(h){const w=this.editor,C=w.document,P=C.selection.getSelectedElement();C.enqueueChanges(()=>{const T=h.batch||C.batch();T.setAttribute(P,'alt',h.newValue)})}}r.a=f},function(o,r,s){'use strict';var d=s(336),u=s(2);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends u.a{init(){this.editor.commands.set('imageTextAlternative',new d.a(this.editor))}}r.a=f},function(o,r,s){'use strict';var d=s(9),u=s(26),f=s(6),h=s(179),w=s(178),C=s(177);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P extends d.a{constructor(T){super(T);const E=this.locale.t;this.lebeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(E('Save')),this.saveButtonView.type='submit',this.cancelButtonView=this._createButton(E('Cancel'),'cancel'),f.a.extend(this.saveButtonView.template,{attributes:{class:['ck-button-action']}}),this.template=new f.a({tag:'form',attributes:{class:['cke-text-alternative-form']},children:[this.lebeledInput,{tag:'div',attributes:{class:['cke-text-alternative-form__actions']},children:[this.saveButtonView,this.cancelButtonView]}]}),s.i(C.a)({view:this})}_createButton(T,E){const S=new u.a(this.locale);return S.label=T,S.withText=!0,E&&S.delegate('execute').to(this,E),S}_createLabeledInputView(){const T=this.locale.t,E=new h.a(this.locale,w.a);return E.label=T('Text alternative'),E}}r.a=P},function(o,r,s){'use strict';function d(N){return N==R.d.arrowright||N==R.d.arrowleft||N==R.d.arrowup||N==R.d.arrowdown}function u(N){return N==R.d.delete||N==R.d.backspace}function f(N){for(;N;){if(N instanceof S.a&&!(N instanceof O.a))return!0;N=N.parent}return!1}var h=s(2),w=s(171),C=s(316),P=s(3),T=s(57),E=s(5),S=s(71),O=s(166),V=s(113),R=s(22);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class F extends h.a{static get requires(){return[w.a]}init(){const N=this.editor.editing.view;N.addObserver(C.a),this.listenTo(N,'mousedown',(...I)=>this._onMousedown(...I)),this.listenTo(N,'keydown',(...I)=>this._onKeydown(...I),{priority:'high'})}_onMousedown(N,I){const M=this.editor,D=M.editing.view;let L=I.target;if(f(L))return;if(!s.i(V.b)(L)&&(L=L.findAncestor(V.b),!L))return;I.preventDefault(),D.isFocused||D.focus();const q=M.editing.mapper.toModelElement(L);M.document.enqueueChanges(()=>{this._setSelectionOverElement(q)})}_onKeydown(N,I){const M=I.keyCode,D=M==R.d.delete||M==R.d.arrowdown||M==R.d.arrowright;(u(M)&&this._handleDelete(D)||d(M)&&this._handleArrowKeys(D))&&(I.preventDefault(),N.stop())}_handleDelete(N){const I=this.editor.document,M=I.selection;if(!M.isCollapsed)return;const D=this._getObjectElementNextToSelection(N);if(D)return I.enqueueChanges(()=>{const L=M.anchor.parent;if(L.isEmpty){const q=I.batch();q.remove(L)}this._setSelectionOverElement(D)}),!0}_handleArrowKeys(N){const I=this.editor.document,M=I.schema,D=I.selection,L=D.getSelectedElement();if(L&&M.objects.has(L.name)){const z=N?D.getLastPosition():D.getFirstPosition(),K=I.getNearestSelectionRange(z,N?'forward':'backward');return K&&I.enqueueChanges(()=>{D.setRanges([K])}),!0}if(!D.isCollapsed)return;const q=this._getObjectElementNextToSelection(N);if(q instanceof E.a&&I.schema.objects.has(q.name))return I.enqueueChanges(()=>{this._setSelectionOverElement(q)}),!0}_setSelectionOverElement(N){this.editor.document.selection.setRanges([P.a.createOn(N)])}_getObjectElementNextToSelection(N){const I=this.editor.document,M=I.schema,D=I.selection,L=this.editor.data,q=T.a.createFromSelection(D);L.modifySelection(q,{direction:N?'forward':'backward'});const z=N?q.focus.nodeBefore:q.focus.nodeAfter;return z instanceof E.a&&M.objects.has(z.name)?z:null}}r.a=F},function(o,r,s){'use strict';function d(O){return O.parent.getAncestors().find((V)=>V instanceof w.a)}var u=s(2),f=s(312),h=s(342),w=s(173),C=s(176),P=s(26),T=s(180),E=s(343);throw new Error('Cannot find module \"../theme/icons/link.svg\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(12),u=s(24),f=s(3),h=s(150),w=s(151),C=s(172);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P extends d.a{constructor(T){super(T),this.set('value',void 0),this.listenTo(this.editor.document.selection,'change:attribute',()=>{this.value=this.editor.document.selection.getAttribute('linkHref')})}_checkEnabled(){const T=this.editor.document;return s.i(w.a)('linkHref',T.selection,T.schema)}_doExecute(T){const E=this.editor.document,S=E.selection;E.enqueueChanges(()=>{const O=E.batch();if(S.isCollapsed){const V=S.getFirstPosition(),R=V.parent;if(S.hasAttribute('linkHref')){const F=s.i(C.a)(S.getFirstPosition(),S.getAttribute('linkHref'));O.setAttribute(F,'linkHref',T),S.setRanges([F])}else if(E.schema.check({name:'$text',attributes:'linkHref',inside:R.name})){const F=new u.a(T,{linkHref:T});O.insert(V,F),S.setRanges([f.a.createOn(F)])}}else{const V=s.i(h.a)('linkHref',S.getRanges(),E.schema);for(let R of V)O.setAttribute(R,'linkHref',T)}})}}r.a=P},function(o,r,s){'use strict';var d=s(2),u=s(45),f=s(46),h=s(173),w=s(341),C=s(344);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class P extends d.a{init(){const T=this.editor,E=T.data,S=T.editing;T.document.schema.allow({name:'$inline',attributes:'linkHref'}),s.i(u.a)().for(E.modelToView,S.modelToView).fromAttribute('linkHref').toElement((O)=>new h.a('a',{href:O})),s.i(f.a)().for(E.viewToModel).fromElement('a').toAttribute((O)=>({key:'linkHref',value:O.getAttribute('href')})),T.commands.set('link',new w.a(T)),T.commands.set('unlink',new C.a(T))}}r.a=P},function(o,r,s){'use strict';var d=s(9),u=s(6),f=s(116),h=s(26),w=s(179),C=s(178),P=s(177),T=s(61),E=s(115),S=s(62);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class O extends d.a{constructor(V){super(V);const R=V.t;this.focusTracker=new T.a,this.keystrokes=new S.a,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(R('Save')),this.saveButtonView.type='submit',this.cancelButtonView=this._createButton(R('Cancel'),'cancel'),this.unlinkButtonView=this._createButton(R('Unlink'),'unlink'),this._focusables=new f.a,this._focusCycler=new E.a({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:'shift + tab',focusNext:'tab'}}),u.a.extend(this.saveButtonView.template,{attributes:{class:['ck-button-action']}}),this.template=new u.a({tag:'form',attributes:{class:['ck-link-form']},children:[this.urlInputView,{tag:'div',attributes:{class:['ck-link-form__actions']},children:[this.saveButtonView,this.cancelButtonView,this.unlinkButtonView]}]}),s.i(P.a)({view:this});const F=[this.urlInputView,this.saveButtonView,this.cancelButtonView,this.unlinkButtonView];F.forEach((N)=>{this._focusables.add(N),this.focusTracker.add(N.element)})}init(){return this.keystrokes.listenTo(this.element),super.init()}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const V=this.locale.t,R=new w.a(this.locale,C.a);return R.label=V('Link URL'),R}_createButton(V,R){const F=new h.a(this.locale);return F.label=V,F.withText=!0,R&&F.delegate('execute').to(this,R),F}}r.a=O},function(o,r,s){'use strict';var d=s(12),u=s(172);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.listenTo(h.document.selection,'change:attribute',()=>this.refreshState())}_doExecute(){const h=this.editor.document,w=h.selection;h.enqueueChanges(()=>{const C=w.isCollapsed?[s.i(u.a)(w.getFirstPosition(),w.getAttribute('linkHref'))]:w.getRanges(),P=h.batch();for(let T of C)P.removeAttribute(T,'linkHref')})}_checkEnabled(){return this.editor.document.selection.hasAttribute('linkHref')}}r.a=f},function(o,r,s){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function O(K,$){const H='numbered'==K.getAttribute('type')?'ol':'ul',W=new N.a,U=new D.a(H,null);return U.appendChildren(W),$.bindElements(K,W),W}function V(K,$){const H=$.getNext?'nextSibling':'previousSibling',W=!!$.checkAllSiblings,U=!!$.sameIndent,J=!!$.biggerIndent,G=K.getAttribute('indent');for(let Y=K[H],X;Y&&'listItem'==Y.name;){if(X=Y.getAttribute('indent'),U&&G==X||J&&G<X)return Y;if(!W||G>X)return null;Y=Y[H]}return null}function R(K,$){K&&$&&('ul'==K.name||'ol'==K.name)&&K.name==$.name&&z.a.mergeContainers(L.a.createAfter(K))}function F(K,$,H){const W=$.parent,U=V(K,{sameIndent:!0,biggerIndent:!0});if(U){let Z=H.toViewElement(U),Q=L.a.createAfter(Z);z.a.breakContainer(Q)}const J=V(K,{sameIndent:!0,checkAllSiblings:!0});let G;if(J){let Z=H.toViewElement(J),Q=L.a.createAfter(Z);G=z.a.breakContainer(Q)}else{const Z=K.previousSibling;G=Z&&'listItem'==Z.name?L.a.createAt(H.toViewElement(Z),'end'):H.toViewPosition(M.a.createBefore(K))}z.a.insert(G,W);const Y=V(K,{getNext:!0,biggerIndent:!0}),X=H.toViewElement(Y);if(X){let Z=q.a.createOn(X.parent),Q=L.a.createAt($,'end');z.a.move(Z,Q)}R(W,W.nextSibling),R(W.previousSibling,W)}var N=s(350),I=s(5),M=s(1),D=s(39),L=s(25),q=s(34),z=s(75);r.d=function(K,$,H,W){if(H.test($.item,'insert')&&H.test($.item,'addAttribute:type')&&H.test($.item,'addAttribute:indent')){H.consume($.item,'insert'),H.consume($.item,'addAttribute:type'),H.consume($.item,'addAttribute:indent');const U=$.item,J=O(U,W.mapper);F(U,J,W.mapper)}},r.e=function(K,$,H,W){if(!H.consume($.item,'changeAttribute:type'))return;const U=W.mapper.toViewElement($.item);z.a.breakContainer(L.a.createBefore(U)),z.a.breakContainer(L.a.createAfter(U));let J=U.parent;const G='numbered'==$.attributeNewValue?'ol':'ul';J=z.a.rename(J,G),R(J,J.nextSibling),R(J.previousSibling,J)},r.f=function(K,$,H,W){if(H.consume($.item,'remove')){const U=W.mapper.toViewElement($.item);z.a.breakContainer(L.a.createBefore(U)),z.a.breakContainer(L.a.createAfter(U));const J=U.parent;z.a.remove(q.a.createOn(J))}},r.h=function(K,$,H,W){if(H.consume($.item,'changeAttribute:indent')){const U=W.mapper.toViewElement($.item);z.a.breakContainer(L.a.createBefore(U)),z.a.breakContainer(L.a.createAfter(U));const J=U.parent,G=J.previousSibling;z.a.remove(q.a.createOn(J)),R(G,G.nextSibling),F($.item,U,W.mapper)}},r.c=function(K,$,H,W){if('listItem'!=$.item.name)for(let U=W.mapper.toViewPosition($.range.start);('ul'==U.parent.name||'ol'==U.parent.name)&&(U=z.a.breakContainer(U),null!==U.parent.parent);)U=L.a.createBefore(U.parent)},r.g=function(K,$,H,W){const U=W.mapper.toViewPosition($.sourcePosition),J=U.nodeBefore,G=U.nodeAfter;R(J,G)},r.i=function(K,$,H,W){if(H.consume($.input,{name:!0})){const U=new I.a('listItem');$.indent=$.indent?$.indent:0;const J='ul'==$.input.parent.name?'bulleted':'numbered';U.setAttribute('type',J),U.setAttribute('indent',$.indent),$.context.push(U),$.indent++;let G=[U];for(let Y of $.input.getChildren()){const X=W.convertItem(Y,H,$);'ul'==Y.name||'ol'==Y.name?G=G.concat(Array.from(X.getChildren())):U.appendChildren(X)}$.indent--,$.context.pop(),$.output=$.output?$.output.concat(G):G}},r.j=function(K,$,H){if(H.test($.input,{name:!0})){const W=Array.from($.input.getChildren());for(let U of W)U.name&&'li'==U.name||U.remove()}},r.a=function(K,$){'li'==$.viewPosition.parent.name&&'listItem'!=$.modelPosition.parent.name&&($.viewPosition=L.a.createBefore($.viewPosition.parent),K.stop())},r.b=function(K,$){const H=$.viewPosition,W=$.mapper,U=H.nodeAfter,J=H.nodeBefore;let G;if(U)'ul'==U.name||'ol'==U.name?G=W.toModelElement(U.getChild(0)):'li'==U.name&&(G=W.toModelElement(U)),G&&($.modelPosition=M.a.createBefore(G));else if(J){let Y;if('ul'==J.name||'ol'==J.name?Y=J.getChild(J.childCount-1):'li'==J.name&&(Y=J),Y){G=W.toModelElement(Y);const X=W.getModelLength(Y);$.modelPosition=M.a.createBefore(G).getShiftedBy(X)}}null!==$.modelPosition&&K.stop()}},function(o,r,s){'use strict';var d=s(12),u=s(174);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h,w){super(h),this._indentBy='forward'==w?1:-1,this.listenTo(h.document.selection,'change:range',()=>{this.refreshState()}),this.listenTo(h.document,'changesDone',()=>{this.refreshState()})}_doExecute(){const h=this.editor.document,w=h.batch(),C=s.i(u.a)(h.selection.getFirstPosition());h.enqueueChanges(()=>{const P=C.getAttribute('indent');let T=[C],E=C.nextSibling;for(;E&&'listItem'==E.name&&E.getAttribute('indent')>P;)T.push(E),E=E.nextSibling;0>this._indentBy&&(T=T.reverse());for(let S of T){const O=S.getAttribute('indent')+this._indentBy;0>O?w.rename(S,'paragraph').removeAttribute(S,'indent').removeAttribute(S,'type'):w.setAttribute(S,'indent',O)}})}_checkEnabled(){const h=s.i(u.a)(this.editor.document.selection.getFirstPosition());if(!h)return!1;const w=h.previousSibling,C=h.getAttribute('indent'),P=C+this._indentBy;if(0<this._indentBy){if(!w||'listItem'!=w.name)return!1;if(w.getAttribute('indent')+1<P)return!1}return!0}}r.a=f},function(o,r,s){'use strict';var d=s(2),u=s(349),f=s(26),h=s(22);throw new Error('Cannot find module \"../theme/icons/numberedlist.svg\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(12),u=s(1),f=s(174);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{constructor(w,C){super(w),this.type='bulleted'==C?'bulleted':'numbered',this.set('value',!1);const P=()=>{this.refreshValue(),this.refreshState()};this.listenTo(w.document.selection,'change:range',P),this.listenTo(w.document,'changesDone',P)}refreshValue(){const w=this.editor.document.selection.getFirstPosition(),C=s.i(f.a)(w);this.value=null!==C&&C.getAttribute('type')==this.type}_doExecute(w={}){const C=this.editor.document,P=Array.from(C.selection.getSelectedBlocks()),T=!0===this.value;C.enqueueChanges(()=>{const E=w.batch||C.batch();if(T){let S=P[P.length-1].nextSibling,O=_NumberPOSITIVE_INFINITY,V=[];for(;S&&'listItem'==S.name&&0!==S.getAttribute('indent');){const R=S.getAttribute('indent');R<O&&(O=R);const F=R-O;V.push({element:S,indent:F}),S=S.nextSibling}V=V.reverse();for(let R of V)E.setAttribute(R.element,'indent',R.indent)}for(let S of P)T&&'listItem'==S.name?E.rename(S,'paragraph').removeAttribute(S,'type').removeAttribute(S,'indent'):T||'listItem'==S.name?T||'listItem'!=S.name||S.getAttribute('type')==this.type||E.setAttribute(S,'type',this.type):E.setAttribute(S,'type',this.type).setAttribute(S,'indent',0).rename(S,'listItem')})}_checkEnabled(){if(this.value)return!0;const w=this.editor.document.selection,C=this.editor.document.schema,P=w.getSelectedBlocks().next().value;return!!P&&C.check({name:'listItem',attributes:['type','indent'],inside:u.a.createBefore(P)})}}r.a=h},function(o,r,s){'use strict';var d=s(2),u=s(348),f=s(346),h=s(345);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends d.a{init(){const C=this.editor,P=C.document.schema;P.registerItem('listItem','$block'),P.allow({name:'listItem',inside:'$root',attributes:['type','indent']}),P.requireAttributes('listItem',['type','indent']);const T=C.data,E=C.editing;E.mapper.on('modelToViewPosition',h.a),E.mapper.on('viewToModelPosition',h.b),T.mapper.on('modelToViewPosition',h.a),E.modelToView.on('insert',h.c,{priority:'high'}),E.modelToView.on('insert:listItem',h.d),T.modelToView.on('insert',h.c,{priority:'high'}),T.modelToView.on('insert:listItem',h.d),E.modelToView.on('changeAttribute:type:listItem',h.e),T.modelToView.on('changeAttribute:type:listItem',h.e),E.modelToView.on('remove:listItem',h.f),E.modelToView.on('remove',h.g,{priority:'low'}),T.modelToView.on('remove:listItem',h.f),T.modelToView.on('remove',h.g,{priority:'low'}),E.modelToView.on('changeAttribute:indent:listItem',h.h),T.modelToView.on('changeAttribute:indent:listItem',h.h),T.viewToModel.on('element:li',h.i),T.viewToModel.on('element:ul',h.j,{priority:'high'}),T.viewToModel.on('element:ol',h.j,{priority:'high'}),C.commands.set('numberedList',new u.a(C,'numbered')),C.commands.set('bulletedList',new u.a(C,'bulleted')),C.commands.set('indentList',new f.a(C,'forward')),C.commands.set('outdentList',new f.a(C,'backward'))}}r.a=w},function(o,r,s){'use strict';function d(){const h=!this.isEmpty&&('ul'==this.getChild(0).name||'ol'==this.getChild(0).name);return this.isEmpty||h?0:null}var u=s(39);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends u.a{constructor(h,w){super('li',h,w),this.getFillerOffset=d}}r.a=f},function(o,r,s){'use strict';var d=s(12);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class u extends d.a{constructor(f){super(f),this.set('value',!1),this.listenTo(f.document,'changesDone',()=>this._updateValue())}_doExecute(f={}){const h=this.editor.document;h.enqueueChanges(()=>{const w=f.batch||h.batch(),C=(f.selection||h.selection).getSelectedBlocks();for(let P of C)P.is('paragraph')||w.rename(P,'paragraph')})}_updateValue(){const f=this.editor.document.selection.getSelectedBlocks().next().value;f&&(this.value=f.is('paragraph'))}}r.a=u},function(o,r,s){'use strict';var d=s(2),u=s(277),f=s(320),h=s(358),w=s(378);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends d.a{static get requires(){return[u.a,f.a,h.a,w.a]}}r.a=C},function(o,r,s){'use strict';var d=s(2),u=s(354),f=s(355);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{init(){const w=this.editor,C=w.editing.view;C.addObserver(f.a),w.commands.set('forwardDelete',new u.a(w,'forward')),w.commands.set('delete',new u.a(w,'backward')),this.listenTo(C,'delete',(P,T)=>{w.execute('forward'==T.direction?'forwardDelete':'delete',{unit:T.unit}),T.preventDefault()})}}r.a=h},function(o,r,s){'use strict';var d=s(12),u=s(57),f=s(175),h=s(182);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends d.a{constructor(C,P){super(C),this.direction=P,this._buffer=new f.a(C.document,C.config.get('typing.undoStep'))}_doExecute(C={}){const P=this.editor.document,T=this.editor.data;P.enqueueChanges(()=>{this._buffer.lock();const E=u.a.createFromSelection(P.selection);if(E.isCollapsed&&T.modifySelection(E,{direction:this.direction,unit:C.unit}),E.isCollapsed)return;let S=0;E.getFirstRange().getMinimalFlatRanges().forEach((O)=>{S+=s.i(h.a)(O.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),T.deleteContent(E,this._buffer.batch,{merge:!0}),this._buffer.input(S),P.selection.setRanges(E.getRanges(),E.isBackward),this._buffer.unlock()})}}r.a=w},function(o,r,s){'use strict';var d=s(48),u=s(112),f=s(22);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{constructor(w){super(w),w.on('keydown',(C,P)=>{const T={};if(P.keyCode==f.d.delete)T.direction='forward',T.unit='character';else if(P.keyCode==f.d.backspace)T.direction='backward',T.unit='codePoint';else return;T.unit=P.altKey?'word':T.unit,w.fire('delete',new u.a(w,P.domEvent,T))})}observe(){}}r.a=h},function(o,r,s){'use strict';function d(F){return!!F.ctrlKey||R.includes(F.keyCode)}function u(F,N){return F instanceof C.a&&N instanceof C.a?F.data===N.data:F===N}var f=s(2),h=s(3),w=s(25),C=s(29),P=s(183),T=s(382),E=s(22),S=s(357);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class O extends f.a{init(){const F=this.editor,N=F.editing.view,I=new S.a(F,F.config.get('typing.undoStep')||20);F.commands.set('input',I),this.listenTo(N,'keydown',(M,D)=>{this._handleKeydown(D,I.buffer)},{priority:'lowest'}),this.listenTo(N,'mutations',(M,D,L)=>{this._handleMutations(D,L)})}_handleKeydown(F,N){const I=this.editor.document;d(F)||I.selection.isCollapsed||(N.lock(),I.enqueueChanges(()=>{this.editor.data.deleteContent(I.selection,N.batch)}),N.unlock())}_handleMutations(F,N){new V(this.editor).handle(F,N)}}r.a=O;class V{constructor(F){this.editor=F,this.editing=this.editor.editing}handle(F,N){for(let I of F)this._handleTextMutation(I,N),this._handleTextNodeInsertion(I)}_handleTextMutation(F,N){if('text'!=F.type)return;const I=F.newText.replace(/\\u00A0/g,' '),M=F.oldText.replace(/\\u00A0/g,' '),D=s.i(P.a)(M,I);let L=null,q=null;for(let G=0;G<D.length;G++){const Y=D[G];'equal'!=Y&&(L=null==L?G:L,q=G)}let z=0,K=0;for(let G=L;G<=q;G++)'insert'!=D[G]&&z++,'delete'!=D[G]&&K++;let $=null;N&&($=this.editing.mapper.toModelRange(N.getFirstRange()));const H=new w.a(F.node,L),W=this.editing.mapper.toModelPosition(H),U=h.a.createFromPositionAndShift(W,z),J=I.substr(L,K);this.editor.execute('input',{text:J,range:U,resultRange:$})}_handleTextNodeInsertion(F){if('children'==F.type&&1==F.newChildren.length-F.oldChildren.length){const N=s.i(P.a)(F.oldChildren,F.newChildren,u),I=s.i(T.a)(N,F.newChildren);if(!(1<I.length)){const M=I[0];if(M.values[0]instanceof C.a){const D=new w.a(F.node,M.index),L=this.editing.mapper.toModelPosition(D),q=M.values[0].data;this.editor.execute('input',{text:q.replace(/\\u00A0/g,' '),range:new h.a(L)})}}}}}const R=[s.i(E.c)('arrowUp'),s.i(E.c)('arrowRight'),s.i(E.c)('arrowDown'),s.i(E.c)('arrowLeft'),9,16,17,18,20,27,33,34,35,36,229];for(let F=112;135>=F;F++)R.push(F)},function(o,r,s){'use strict';var d=s(12),u=s(175);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h,w){super(h),this._buffer=new u.a(h.document,w)}destroy(){super.destroy(),this._buffer.destroy(),this._buffer=null}get buffer(){return this._buffer}_doExecute(h={}){const w=this.editor.document,C=h.text||'',P=C.length,T=h.range||w.selection.getFirstRange(),E=h.resultRange;w.enqueueChanges(()=>{const S=T.isCollapsed;this._buffer.lock(),S||this._buffer.batch.remove(T),this._buffer.batch.weakInsert(T.start,C),E?this.editor.data.model.selection.setRanges([E]):S&&this.editor.data.model.selection.collapse(T.start.getShiftedBy(P)),this._buffer.unlock(),this._buffer.input(P)})}}r.a=f},function(o,r,s){'use strict';var d=s(2),u=s(356),f=s(353);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{static get requires(){return[u.a,f.a]}}r.a=h},function(o,r,s){'use strict';var u=s(22);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function({emitter:f,activator:h,callback:w}){f.listenTo(document,'keydown',(C,{keyCode:P})=>{P==u.d.esc&&h()&&w()})}},function(o,r,s){'use strict';var d=s(0);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(f){this.editor=f,this._components=new Map}add(f,h){if(this._components.get(f))throw new d.a('componentfactory-item-exists: The item already exists in the component factory.',{name:f});this._components.set(f,h)}create(f){return this._components.get(f)(this.editor.locale)}}},function(o,r,s){'use strict';var u=s(26),f=s(363),h=s(362);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(w,C){const P=new u.a(C);P.bind('label','isOn','isEnabled','withText','keystroke','tooltip').to(w);const T=new h.a(C);return new f.a(C,P,T)}},function(o,r,s){'use strict';var d=s(9),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h);const w=this.bindTemplate;this.set('isVisible',!1),this.children=this.createCollection(),this.template=new u.a({tag:'div',attributes:{class:['ck-reset','ck-dropdown__panel',w.if('isVisible','ck-dropdown__panel-visible')]},children:this.children})}}r.a=f},function(o,r,s){'use strict';var d=s(9),u=s(6),f=s(61),h=s(62);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class w extends d.a{constructor(C,P,T){super(C),u.a.extend(P.template,{attributes:{class:['ck-dropdown__button']}}),this.buttonView=P,this.panelView=T,this.set('isOpen',!1),this.focusTracker=new f.a,this.keystrokes=new h.a,this.template=new u.a({tag:'div',attributes:{class:['ck-dropdown']},children:[P,T]}),this.listenTo(P,'execute',()=>this.isOpen=!this.isOpen),T.bind('isVisible').to(this,'isOpen')}init(){this.keystrokes.listenTo(this.element),this.focusTracker.add(this.element);const C=(P,T)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,T())};return this.keystrokes.set('arrowdown',(P,T)=>{this.isOpen||(this.isOpen=!0,T())}),this.keystrokes.set('arrowright',(P,T)=>{this.isOpen&&T()}),this.keystrokes.set('arrowleft',C),this.keystrokes.set('esc',C),super.init()}focus(){this.buttonView.focus()}}r.a=w},function(o,r,s){'use strict';function u(C){C.listenTo(document,'click',(P,{target:T})=>{C.element==T||C.element.contains(T)||(C.isOpen=!1)})}/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */var f=s(372),h=s(371),w=s(361);r.a=function(C,P){const T=s.i(w.a)(C,P),E=T.listView=new f.a(P);return E.items.bindTo(C.items).using((S)=>{const O=new h.a(P);return O.bind(...Object.keys(S)).to(S),O}),E.items.delegate('execute').to(T),T.panelView.children.add(E),T.on('change:isOpen',(S,O,V)=>{V?u(T):T.stopListening(document)}),T.on('execute',()=>{T.isOpen=!1}),T.keystrokes.set('arrowdown',(S,O)=>{T.isOpen&&(E.focus(),O())}),T.keystrokes.set('arrowup',(S,O)=>{T.isOpen&&(E.focusLast(),O())}),T}},function(o,r,s){'use strict';var d=s(9),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h,w){super(h);const C=this.bindTemplate;w&&(this.element=this.editableElement=w),this.template=new u.a({tag:'div',attributes:{class:[C.to('isFocused',(P)=>P?'ck-focused':'ck-blurred'),'ck-editor__editable'],contenteditable:C.to('isReadOnly',(P)=>!P)}}),this.set('isReadOnly',!1),this.set('isFocused',!1),this.externalElement=w}init(){return this.externalElement?this.template.apply(this.externalElement):this.editableElement=this.element,super.init()}destroy(){return this.externalElement&&this.template.revert(this.externalElement),super.destroy()}}r.a=f},function(o,r,s){'use strict';var d=s(365),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h,w){super(h,w);const C=this.bindTemplate,P=this.t;this.set('name',null);u.a.extend(this.template,{attributes:{role:'textbox','aria-label':C.to('name',(E)=>{return P('Rich Text Editor, %0',[E])}),class:'ck-editor__editable_inline'}})}}r.a=f},function(o,r,s){'use strict';var d=s(368),u=s(66),f=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{constructor(w){super(w);const C=this.t,P=s.i(u.a)();this.set('width',null),this.set('height',null),this.top=this.createCollection(),this.main=this.createCollection(),this.template=new f.a({tag:'div',attributes:{class:['ck-reset','ck-editor','ck-rounded-corners'],role:'application',dir:'ltr',lang:w.lang,'aria-labelledby':`cke-editor__aria-label_${P}`},children:[{tag:'span',attributes:{id:`cke-editor__aria-label_${P}`,class:'cke-voice-label'},children:[C('Rich Text Editor')]},{tag:'div',attributes:{class:'ck-editor__top ck-reset_all',role:'presentation'},children:this.top},{tag:'div',attributes:{class:'ck-editor__main',role:'presentation'},children:this.main}]})}}r.a=h},function(o,r,s){'use strict';var d=s(9),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.body=this.createCollection()}init(){return Promise.resolve().then(()=>this._renderBodyCollection()).then(()=>super.init())}destroy(){return this._bodyCollectionContainer.remove(),super.destroy()}_renderBodyCollection(){const h=this._bodyCollectionContainer=new u.a({tag:'div',attributes:{class:['ck-body','ck-rounded-corners','ck-reset_all']},children:this.body}).render();document.body.appendChild(h)}}r.a=f},function(o,r,s){'use strict';var d=s(9),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(){super();const h=this.bindTemplate;this.set('content'),this.set('viewBox','0 0 20 20'),this.template=new u.a({tag:'svg',ns:'http://www.w3.org/2000/svg',attributes:{class:'ck-icon',viewBox:h.to('viewBox')}}),this.on('change:content',(w,C,P)=>{for(const T=new DOMParser().parseFromString(P.trim(),'image/svg+xml').firstChild;0<T.childNodes.length;)this.element.appendChild(T.childNodes[0])})}}r.a=f},function(o,r,s){'use strict';var d=s(9),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.set('text'),this.set('for');const w=this.bindTemplate;this.template=new u.a({tag:'label',attributes:{class:['ck-label'],for:w.to('for')},children:[{text:w.to('text')}]})}}r.a=f},function(o,r,s){'use strict';var d=s(9),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(){super(),this.set('tabindex',-1);const h=this.bindTemplate;this.template=new u.a({tag:'li',attributes:{class:['ck-list__item',h.to('class'),h.if('isActive','ck-list__item_active')],style:h.to('style'),tabindex:h.to('tabindex')},children:[{text:h.to('label')}],on:{click:h.to('execute')}})}focus(){this.element.focus()}}r.a=f},function(o,r,s){'use strict';var d=s(9),u=s(6),f=s(61),h=s(115),w=s(62);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class C extends d.a{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new f.a,this.keystrokes=new w.a,this._focusCycler=new h.a({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:'arrowup',focusNext:'arrowdown'}}),this.template=new u.a({tag:'ul',attributes:{class:['ck-reset','ck-list']},children:this.items}),this.items.on('add',(P,T)=>{this.focusTracker.add(T.element)}),this.items.on('remove',(P,T)=>{this.focusTracker.remove(T.element)})}init(){return this.keystrokes.listenTo(this.element),super.init()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}r.a=C},function(o,r,s){'use strict';var d=s(54),u=s(4),f=s(31);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h{constructor(w,C){C&&s.i(d.a)(this,C),w&&this.set(w)}}r.a=h,s.i(u.a)(h,f.a)},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function({origin:u,originKeystrokeHandler:f,originFocusTracker:h,toolbar:w}){h.add(w.element),f.set('Alt+F10',(C,P)=>{h.isFocused&&!w.focusTracker.isFocused&&(w.focus(),P())}),w.keystrokes.set('Esc',(C,P)=>{w.focusTracker.isFocused&&(u.focus(),P())})}},function(o,r,s){'use strict';var d=s(60),u=s(6),f=s(181),h=s(185);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const w=s.i(h.a)('px');class C extends f.a{constructor(P){super(P);const T=this.bindTemplate;this.set('isActive',!1),this.set('isSticky',!1),this.set('limiterElement',null),this.set('limiterOffset',50),this.set('_marginLeft',null),this.set('_isStickyToTheLimiter',!1),u.a.extend(this.template,{attributes:{class:[T.if('isSticky','ck-toolbar_sticky'),T.if('_isStickyToTheLimiter','ck-toolbar_sticky_bottom-limit')],style:{width:T.to('isSticky',(E)=>{return E?w(this._elementPlaceholder.getBoundingClientRect().width):null}),bottom:T.to('_isStickyToTheLimiter',(E)=>{return E?w(this.limiterOffset):null}),marginLeft:T.to('_marginLeft')}}}),this._elementPlaceholder=new u.a({tag:'div',attributes:{class:['ck-toolbar__placeholder'],style:{display:T.to('isSticky',(E)=>E?'block':'none'),height:T.to('isSticky',(E)=>{return E?w(this._toolbarRect.height):null})}}}).render()}init(){super.init(),this.element.parentNode.insertBefore(this._elementPlaceholder,this.element),this.listenTo(d.a.window,'scroll',()=>{this._checkIfShouldBeSticky()}),this.listenTo(this,'change:isActive',()=>{this._checkIfShouldBeSticky()})}destroy(){return super.destroy().then(()=>{this._elementPlaceholder.remove()})}_checkIfShouldBeSticky(){const P=this._limiterRect=this.limiterElement.getBoundingClientRect(),T=this._toolbarRect=this.element.getBoundingClientRect();this.isSticky=this.isActive&&0>P.top&&this._toolbarRect.height+this.limiterOffset<P.height,this.isSticky?(this._isStickyToTheLimiter=P.bottom<T.height+this.limiterOffset,this._marginLeft=this._isStickyToTheLimiter?null:w(-d.a.window.scrollX)):(this._isStickyToTheLimiter=!1,this._marginLeft=null)}}r.a=C},function(o,r,s){'use strict';var d=s(9),u=s(6);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{constructor(h){super(h),this.template=new u.a({tag:'span',attributes:{class:['ck-toolbar__separator']}})}}r.a=f},function(o,r,s){'use strict';var d=s(117),u=s(103);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{_doExecute(){const h=this._stack.pop();this.editor.document.enqueueChanges(()=>{const w=h.batch.deltas[h.batch.deltas.length-1],C=w.baseVersion+w.operations.length,P=Array.from(this.editor.document.history.getDeltas(C)).filter((T)=>{return!this._createdBatches.has(T.batch)});this._restoreSelection(h.selection.ranges,h.selection.isBackward,P),this._redo(h.batch)}),this.refreshState()}_redo(h){const w=this.editor.document,C=w.batch();this._createdBatches.add(C);const P=h.deltas.slice();P.reverse();for(let T of P){const E=T.baseVersion+T.operations.length;let S=[T.getReversed()];for(let O of w.history.getDeltas(E))this._createdBatches.has(O.batch)||(S=s.i(u.a)(S,[O],!0).deltasA);for(let O of S){O.baseVersion=w.version,C.addDelta(O);for(let V of O.operations)w.applyOperation(V)}}}}r.a=f},function(o,r,s){'use strict';var d=s(2),u=s(380),f=s(26);throw new Error('Cannot find module \"../theme/icons/undo.svg\"');/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */},function(o,r,s){'use strict';var d=s(117),u=s(103);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{_doExecute(h=null){let w=h?this._stack.findIndex((P)=>P.batch==h):this._stack.length-1;const C=this._stack.splice(w,1)[0];this.editor.document.enqueueChanges(()=>{const P=this._undo(C.batch),T=this.editor.document.history.getDeltas(C.batch.baseVersion);this._restoreSelection(C.selection.ranges,C.selection.isBackward,T),this.fire('revert',C.batch,P)}),this.refreshState()}_getItemIndexFromBaseVersion(h){for(let w=0;w<this._stack.length;w++)if(this._stack[w].batch.baseVersion==h)return w;return null}_undo(h){const w=this.editor.document,C=w.batch();this._createdBatches.add(C);const P=w.history,T=h.deltas.slice();T.reverse();for(let E of T){const S=E.baseVersion,O=S+E.operations.length,V=P.getDelta(S);if(null===V)continue;V.reverse();let R=[];for(let N of V)R.push(N.getReversed());const F={};for(let N of P.getDeltas(O)){const I=this._getItemIndexFromBaseVersion(N.baseVersion);null!==I&&(this._stack[I].selection.ranges=s.i(d.b)(this._stack[I].selection.ranges,R));const M=s.i(u.a)(R,[N],!0);R=M.deltasA;const D=M.deltasB;F[N.baseVersion]||(F[N.baseVersion]=[]),F[N.baseVersion]=F[N.baseVersion].concat(D)}for(let N of R){N.baseVersion=w.version,C.addDelta(N);for(let I of N.operations)w.applyOperation(I)}P.removeDelta(S);for(let N of R)P.removeDelta(N.baseVersion);for(let N in F)P.updateDelta(+N,F[N])}return C}}r.a=f},function(o,r,s){'use strict';var d=s(2),u=s(379),f=s(377);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class h extends d.a{constructor(w){super(w),this._batchRegistry=new WeakSet}init(){this._undoCommand=new u.a(this.editor),this._redoCommand=new f.a(this.editor),this.editor.commands.set('undo',this._undoCommand),this.editor.commands.set('redo',this._redoCommand),this.listenTo(this.editor.document,'change',(w,C,P,T)=>{this._batchRegistry.has(T)||'transparent'==T.type||(this._redoCommand._createdBatches.has(T)?this._undoCommand.addBatch(T):!this._undoCommand._createdBatches.has(T)&&(this._undoCommand.addBatch(T),this._redoCommand.clearStack()),this._batchRegistry.add(T))},{priority:'highest'}),this.listenTo(this._undoCommand,'revert',(w,C,P)=>{this._redoCommand.addBatch(P)})}}r.a=h},function(o,r,s){'use strict';var d=s(95);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(f,h){this._config={},h&&this.define(h),f&&this._setObjectToTarget(this._config,f)}set(f,h){this._setToTarget(this._config,f,h)}define(f,h){this._setToTarget(this._config,f,h,!0)}get(f){return this._getFromSource(this._config,f)}_setToTarget(f,h,w,C=!1){if(s.i(d.a)(h))return void this._setObjectToTarget(f,h,C);const P=h.split('.');h=P.pop();for(let T of P)s.i(d.a)(f[T])||(f[T]={}),f=f[T];return s.i(d.a)(w)?(s.i(d.a)(f[h])||(f[h]={}),f=f[h],void this._setObjectToTarget(f,w,C)):void(C&&'undefined'!=typeof f[h]||(f[h]=w))}_getFromSource(f,h){const w=h.split('.');h=w.pop();for(let C of w){if(!s.i(d.a)(f[C])){f=null;break}f=f[C]}return f?f[h]:void 0}_setObjectToTarget(f,h,w){Object.keys(h).forEach((C)=>{this._setToTarget(f,C,h[C],w)})}}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u,f){function h(){T&&(C.push(T),T=null)}function w(E){return T&&T.type==E}const C=[];let P=0,T;return u.forEach((E)=>{'equal'==E?(h(),P++):'insert'==E?(w('insert')?T.values.push(f[P]):(h(),T={type:'insert',index:P,values:[f[P]]}),P++):w('delete')?T.howMany++:(h(),T={type:'delete',index:P,howMany:1})}),h(),C}},function(o,r,s){'use strict';var u=s(184);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(f,h){const w=s.i(u.a)(f),C=s.i(u.a)(h);let P=0;for(;w[P]==C[P]&&w[P];)P++;return 0==P?null:w[P-1]}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){return u instanceof HTMLTextAreaElement?u.value:u.innerHTML}},function(o,r,s){'use strict';var u=s(60);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(f){for(;f&&'html'!=f.tagName.toLowerCase();){if('static'!=u.a.window.getComputedStyle(f).position)return f;f=f.parentElement}return null}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){let f=0;for(;u.previousSibling;)u=u.previousSibling,f++;return f}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u,f,h){u.insertBefore(h,u.childNodes[f]||null)}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){return'[object Range]'==Object.prototype.toString.apply(u)}},function(o,r,s){'use strict';function u(T,E,S){const{left:O,top:V,name:R}=T(E,S);return[R,S.clone().moveTo(O,V)]}/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function f(T,E,S,O,V){let R=0,F=0,N,I;const M=S.getArea();return T.some((D)=>{function L(){F=$,R=K,N=z,I=q}const[q,z]=u(D,E,S);let K,$;if(O)if(V){const H=O.getIntersection(V);K=H?H.getIntersectionArea(z):0}else K=O.getIntersectionArea(z);return V&&($=V.getIntersectionArea(z)),V&&!O?$>F&&L():!V&&O?K>R&&L():$>F&&K>=R?L():$>=F&&K>R&&L(),K===M}),N?[I,N]:null}function h({left:T,top:E}){const{scrollX:S,scrollY:O}=w.a.window;return{left:T+S,top:E+O}}var w=s(60),C=s(390),P=s(385);r.a=function({element:T,target:E,positions:S,limiter:O,fitInViewport:V}){const R=s.i(P.a)(T.parentElement),F=new C.a(T),N=new C.a(E);let I,M;if(!O&&!V)[M,I]=u(S[0],N,F);else{const q=O&&new C.a(O),z=V&&C.a.getViewportRect();[M,I]=f(S,N,F,q,z)||u(S[0],N,F)}let{left:D,top:L}=h(I);if(R){const q=h(new C.a(R));D-=q.left,L-=q.top}return{left:D,top:L,name:M}}},function(o,r,s){'use strict';var d=s(60),u=s(388),f=s(481);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const h=['top','right','bottom','left','width','height'];class w{constructor(C){(s.i(f.a)(C)||s.i(u.a)(C))&&(C=C.getBoundingClientRect()),h.forEach((P)=>this[P]=C[P])}clone(){return new w(this)}moveTo(C,P){return this.top=P,this.right=C+this.width,this.bottom=P+this.height,this.left=C,this}moveBy(C,P){return this.top+=P,this.right+=C,this.left+=C,this.bottom+=P,this}getIntersection(C){const P={top:_Mathmax(this.top,C.top),right:_Mathmin(this.right,C.right),bottom:_Mathmin(this.bottom,C.bottom),left:_Mathmax(this.left,C.left)};return P.width=P.right-P.left,P.height=P.bottom-P.top,0>P.width||0>P.height?null:new w(P)}getIntersectionArea(C){const P=this.getIntersection(C);return P?P.getArea():0}getArea(){return this.width*this.height}static getViewportRect(){const{innerWidth:C,innerHeight:P}=d.a.window;return new w({top:0,right:C,bottom:P,left:0,width:C,height:P})}}r.a=w},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u){const f=u.parentNode;f&&f.removeChild(u)}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u,f){u instanceof HTMLTextAreaElement&&(u.value=f),u.innerHTML=f}},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(){this._replacedElements=[]}replace(u,f){this._replacedElements.push({element:u,newElement:f}),u.style.display='none',f&&u.parentNode.insertBefore(f,u.nextSibling)}restore(){this._replacedElements.forEach(({element:u,newElement:f})=>{u.style.display='',f&&f.remove()}),this._replacedElements=[]}}},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const u=navigator.userAgent.toLowerCase(),f={mac:function(h){return-1<h.indexOf('macintosh')}(u)};r.a=f},function(o,r,s){'use strict';var d=s(497);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(f,h){this.source=f,this.name=h,this.path=[],this.stop=s.i(d.a)(),this.off=s.i(d.a)()}}},function(o,r,s){'use strict';var d=s(50),u=s(30),f=s.i(d.a)(u.a,'DataView');r.a=f},function(o,r,s){'use strict';function d(P){var T=-1,E=P?P.length:0;for(this.clear();++T<E;){var S=P[T];this.set(S[0],S[1])}}var u=s(443),f=s(444),h=s(445),w=s(446),C=s(447);d.prototype.clear=u.a,d.prototype['delete']=f.a,d.prototype.get=h.a,d.prototype.has=w.a,d.prototype.set=C.a,r.a=d},function(o,r,s){'use strict';var d=s(50),u=s(30),f=s.i(d.a)(u.a,'Promise');r.a=f},function(o,r,s){'use strict';var d=s(30),u=d.a.Reflect;r.a=u},function(o,r,s){'use strict';var d=s(50),u=s(30),f=s.i(d.a)(u.a,'WeakMap');r.a=f},function(o,r){'use strict';r.a=function(u,f){return u.set(f[0],f[1]),u}},function(o,r){'use strict';r.a=function(u,f){return u.add(f),u}},function(o,r){'use strict';r.a=function(u,f){for(var h=-1,w=u.length;++h<w&&!(!1===f(u[h],h,u)););return u}},function(o,r){'use strict';r.a=function(u,f){for(var h=-1,w=u.length;++h<w;)if(f(u[h],h,u))return!0;return!1}},function(o,r,s){'use strict';var u=s(135),f=s(65);r.a=function(h,w){return h&&s.i(u.a)(w,s.i(f.a)(w),h)}},function(o,r,s){'use strict';var u=s(222);r.a=function(f,h){for(var w=-1,P=h.length,T=Array(P);++w<P;)T[w]=null==f?void 0:s.i(u.a)(f,h[w]);return T}},function(o,r){'use strict';r.a=function(u,f,h){return u===u&&(void 0!==h&&(u=u<=h?u:h),void 0!==f&&(u=u>=f?u:f)),u}},function(o,r,s){'use strict';var u=s(14),f=Object.create;r.a=function(h){return s.i(u.a)(h)?f(h):{}}},function(o,r,s){'use strict';var u=s(15),f=s(491);r.a=function(h,w,C,P){var T=h.length;for(C=s.i(u.a)(C),0>C&&(C=-C>T?0:T+C),P=void 0===P||P>T?T:s.i(u.a)(P),0>P&&(P+=T),P=C>P?0:s.i(f.a)(P);C<P;)h[C++]=w;return h}},function(o,r,s){'use strict';var u=s(81),f=s(11);r.a=function(h,w,C){var P=w(h);return s.i(f.a)(h)?P:s.i(u.a)(P,C(h))}},function(o,r){'use strict';r.a=function(u,f){return f in Object(u)}},function(o,r){'use strict';r.a=function(u,f,h,w){for(var C=h-1,P=u.length;++C<P;)if(w(u[C],f))return C;return-1}},function(o,r,s){'use strict';var u=s(119),f=s(199),h=s(437),w=s(438),C=s(137),P=s(11),T=s(87),E=s(483),O='[object Arguments]',V='[object Array]',R='[object Object]',F=Object.prototype,N=F.hasOwnProperty;r.a=function(I,M,D,L,q,z){var K=s.i(P.a)(I),$=s.i(P.a)(M),H=V,W=V;K||(H=s.i(C.a)(I),H=H==O?R:H),$||(W=s.i(C.a)(M),W=W==O?R:W);var U=H==R&&!s.i(T.a)(I),J=W==R&&!s.i(T.a)(M),G=H==W;if(G&&!U)return z||(z=new u.a),K||s.i(E.a)(I)?s.i(f.a)(I,M,D,L,q,z):s.i(h.a)(I,M,H,D,L,q,z);if(!(q&2)){var Y=U&&N.call(I,'__wrapped__'),X=J&&N.call(M,'__wrapped__');if(Y||X){var Z=Y?I.value():I,Q=X?M.value():M;return z||(z=new u.a),D(Z,Q,L,q,z)}}return!!G&&(z||(z=new u.a),s.i(w.a)(I,M,D,L,q,z))}},function(o,r,s){'use strict';var u=s(119),f=s(126);r.a=function(C,P,T,E){var S=T.length,O=S,V=!E;if(null==C)return!O;for(C=Object(C);S--;){var R=T[S];if(V&&R[2]?R[1]!==C[R[0]]:!(R[0]in C))return!1}for(;++S<O;){R=T[S];var F=R[0],N=C[F],I=R[1];if(!(V&&R[2])){var M=new u.a;if(E)var D=E(N,I,F,C,P,M);if(void 0===D?!s.i(f.a)(I,N,E,1|2,M):!D)return!1}else if(void 0===N&&!(F in C))return!1}return!0}},function(o,r){'use strict';var u=Object.keys;r.a=function(f){return u(Object(f))}},function(o,r,s){'use strict';function d(P){P=null==P?P:Object(P);var T=[];for(var E in P)T.push(E);return T}var u=s(399),f=s(453),h=Object.prototype,w=u.a?u.a.enumerate:void 0,C=h.propertyIsEnumerable;w&&!C.call({valueOf:1},'valueOf')&&(d=function(P){return s.i(f.a)(w(P))}),r.a=d},function(o,r,s){'use strict';var u=s(414),f=s(441),h=s(204);r.a=function(w){var C=s.i(f.a)(w);return 1==C.length&&C[0][2]?s.i(h.a)(C[0][0],C[0][1]):function(P){return P===w||s.i(u.a)(P,w,C)}}},function(o,r,s){'use strict';var u=s(126),f=s(222),h=s(479),w=s(51),C=s(203),P=s(204),T=s(52);r.a=function(O,V){return s.i(w.a)(O)&&s.i(C.a)(V)?s.i(P.a)(s.i(T.a)(O),V):function(R){var F=s.i(f.a)(R,O);return F===void 0&&F===V?s.i(h.a)(R,O):s.i(u.a)(V,F,void 0,1|2)}}},function(o,r,s){'use strict';var u=s(36);r.a=function(f,h){var w=f.length;if(w)return h+=0>h?w:0,s.i(u.a)(h,w)?f[h]:void 0}},function(o,r,s){'use strict';var u=s(123);r.a=function(f){return function(h){return s.i(u.a)(h,f)}}},function(o,r,s){'use strict';var u=s(63),f=s(85),h=s(36),w=s(51),C=s(14),P=s(52);r.a=function(T,E,S,O){E=s.i(w.a)(E,T)?[E]:s.i(f.a)(E);for(var V=-1,R=E.length,N=T,I;null!=N&&++V<R;){if(I=s.i(P.a)(E[V]),s.i(C.a)(N)){var M=S;if(V!=R-1){var D=N[I];M=O?O(D,I,N):void 0,void 0===M&&(M=null==D?s.i(h.a)(E[V+1])?[]:{}:D)}s.i(u.a)(N,I,M)}N=N[I]}return T}},function(o,r,s){'use strict';var u=s(27);r.a=function(f,h){return s.i(u.a)(h,function(w){return[w,f[w]]})}},function(o,r,s){'use strict';var u=s(120),f=s(44),w=u.a?u.a.prototype:void 0,C=w?w.toString:void 0;r.a=function(P){if('string'==typeof P)return P;if(s.i(f.a)(P))return C?C.call(P):'';var T=P+'';return'0'==T&&1/P==-(1/0)?'-0':T}},function(o,r){'use strict';r.a=function(u){return u&&u.Object===Object?u:null}},function(o,r){'use strict';r.a=function(u,f){if(f)return u.slice();var h=new u.constructor(u.length);return u.copy(h),h}},function(o,r,s){'use strict';var u=s(134);r.a=function(f,h){var w=h?s.i(u.a)(f.buffer):f.buffer;return new f.constructor(w,f.byteOffset,f.byteLength)}},function(o,r,s){'use strict';var u=s(401),f=s(190),h=s(138);r.a=function(w,C,P){var T=C?P(s.i(h.a)(w),!0):s.i(h.a)(w);return s.i(f.a)(T,u.a,new w.constructor)}},function(o,r){'use strict';var u=/\\w*$/;r.a=function(f){var h=new f.constructor(f.source,u.exec(f));return h.lastIndex=f.lastIndex,h}},function(o,r,s){'use strict';var u=s(402),f=s(190),h=s(91);r.a=function(w,C,P){var T=C?P(s.i(h.a)(w),!0):s.i(h.a)(w);return s.i(f.a)(T,u.a,new w.constructor)}},function(o,r,s){'use strict';var u=s(120),f=u.a?u.a.prototype:void 0,h=f?f.valueOf:void 0;r.a=function(w){return h?Object(h.call(w)):{}}},function(o,r,s){'use strict';var u=s(134);r.a=function(f,h){var w=h?s.i(u.a)(f.buffer):f.buffer;return new f.constructor(w,f.byteOffset,f.length)}},function(o,r,s){'use strict';var u=s(44);r.a=function(f,h){if(f!==h){var w=f!==void 0,C=null===f,P=f===f,T=s.i(u.a)(f),E=h!==void 0,S=null===h,O=h===h,V=s.i(u.a)(h);if(!S&&!V&&!T&&f>h||T&&E&&O&&!S&&!V||C&&E&&O||!w&&O||!P)return 1;if(!C&&!T&&!V&&f<h||V&&w&&P&&!C&&!T||S&&w&&P||!E&&P||!O)return-1}return 0}},function(o,r,s){'use strict';var u=s(135),f=s(200);r.a=function(h,w){return s.i(u.a)(h,s.i(f.a)(h),w)}},function(o,r,s){'use strict';var u=s(88),f=s(8);r.a=function(h){return s.i(f.a)(function(w,C){var P=-1,T=C.length,E=1<T?C[T-1]:void 0,S=2<T?C[2]:void 0;for(E=3<h.length&&'function'==typeof E?(T--,E):void 0,S&&s.i(u.a)(C[0],C[1],S)&&(E=3>T?void 0:E,T=1),w=Object(w);++P<T;){var O=C[P];O&&h(w,O,P,E)}return w})}},function(o,r,s){'use strict';var d=s(187),u=s(486),f=s(91),w=d.a&&1/s.i(f.a)(new d.a([,-0]))[1]==1/0?function(C){return new d.a(C)}:u.a;r.a=w},function(o,r,s){'use strict';var u=s(422),f=s(137),h=s(138),w=s(467);r.a=function(T){return function(E){var S=s.i(f.a)(E);return S=='[object Map]'?s.i(h.a)(E):S=='[object Set]'?s.i(w.a)(E):s.i(u.a)(E,T(E))}}},function(o,r,s){'use strict';var u=s(120),f=s(188),h=s(199),w=s(138),C=s(91),q=u.a?u.a.prototype:void 0,z=q?q.valueOf:void 0;r.a=function(K,$,H,W,U,J,G){switch(H){case'[object DataView]':if(K.byteLength!=$.byteLength||K.byteOffset!=$.byteOffset)return!1;K=K.buffer,$=$.buffer;case'[object ArrayBuffer]':return K.byteLength==$.byteLength&&W(new f.a(K),new f.a($));case'[object Boolean]':case'[object Date]':return+K==+$;case'[object Error]':return K.name==$.name&&K.message==$.message;case'[object Number]':return K==+K?K==+$:$!=+$;case'[object RegExp]':case'[object String]':return K==$+'';case'[object Map]':var Y=w.a;case'[object Set]':var X=J&2;if(Y||(Y=C.a),K.size!=$.size&&!X)return!1;var Z=G.get(K);return Z?Z==$:(J|=1,G.set(K,$),s.i(h.a)(Y(K),Y($),W,U,J,G));case'[object Symbol]':if(z)return z.call(K)==z.call($);}return!1}},function(o,r,s){'use strict';var u=s(193),f=s(65);r.a=function(w,C,P,T,E,S){var O=E&2,V=s.i(f.a)(w),R=V.length,F=s.i(f.a)(C),N=F.length;if(R!=N&&!O)return!1;for(var I=R,M;I--;)if(M=V[I],O?!(M in C):!s.i(u.a)(C,M))return!1;var D=S.get(w);if(D)return D==C;var L=!0;S.set(w,C);for(var q=O;++I<R;){M=V[I];var z=w[M],K=C[M];if(T)var $=O?T(K,z,M,C,w,S):T(z,K,M,w,C,S);if(void 0===$?!(z===K||P(z,K,T,E,S)):!$){L=!1;break}q||(q='constructor'==M)}if(L&&!q){var H=w.constructor,W=C.constructor;H!=W&&'constructor'in w&&'constructor'in C&&!('function'==typeof H&&H instanceof H&&'function'==typeof W&&W instanceof W)&&(L=!1)}return S['delete'](w),L}},function(o,r,s){'use strict';var u=s(410),f=s(200),h=s(65);r.a=function(w){return s.i(u.a)(w,h.a,f.a)}},function(o,r,s){'use strict';var d=s(127),u=s.i(d.a)('length');r.a=u},function(o,r,s){'use strict';var u=s(203),f=s(492);r.a=function(h){for(var w=s.i(f.a)(h),C=w.length;C--;)w[C][2]=s.i(u.a)(w[C][1]);return w}},function(o,r,s){'use strict';var u=s(85),f=s(143),h=s(11),w=s(36),C=s(51),P=s(94),T=s(145),E=s(52);r.a=function(S,O,V){O=s.i(C.a)(O,S)?[O]:s.i(u.a)(O);for(var F=-1,N=O.length,R,I;++F<N&&(I=s.i(E.a)(O[F]),!!(R=null!=S&&V(S,I)));)S=S[I];if(R)return R;var N=S?S.length:0;return!!N&&s.i(P.a)(N)&&s.i(w.a)(I,N)&&(s.i(h.a)(S)||s.i(T.a)(S)||s.i(f.a)(S))}},function(o,r,s){'use strict';var u=s(90);r.a=function(){this.__data__=u.a?s.i(u.a)(null):{}}},function(o,r){'use strict';r.a=function(u){return this.has(u)&&delete this.__data__[u]}},function(o,r,s){'use strict';var u=s(90),h=Object.prototype,w=h.hasOwnProperty;r.a=function(C){var P=this.__data__;if(u.a){var T=P[C];return T==='__lodash_hash_undefined__'?void 0:T}return w.call(P,C)?P[C]:void 0}},function(o,r,s){'use strict';var u=s(90),f=Object.prototype,h=f.hasOwnProperty;r.a=function(w){var C=this.__data__;return u.a?C[w]!==void 0:h.call(C,w)}},function(o,r,s){'use strict';var u=s(90);r.a=function(h,w){var C=this.__data__;return C[h]=u.a&&void 0===w?'__lodash_hash_undefined__':w,this}},function(o,r){'use strict';var u=Object.prototype,f=u.hasOwnProperty;r.a=function(h){var w=h.length,C=h.constructor(w);return w&&'string'==typeof h[0]&&f.call(h,'index')&&(C.index=h.index,C.input=h.input),C}},function(o,r,s){'use strict';var u=s(134),f=s(426),h=s(427),w=s(428),C=s(429),P=s(430),T=s(431);r.a=function(G,Y,X,Z){var Q=G.constructor;return Y==='[object ArrayBuffer]'?s.i(u.a)(G):Y==='[object Boolean]'||Y==='[object Date]'?new Q(+G):Y==='[object DataView]'?s.i(f.a)(G,Z):Y==='[object Float32Array]'||Y==='[object Float64Array]'||Y==='[object Int8Array]'||Y==='[object Int16Array]'||Y==='[object Int32Array]'||Y==='[object Uint8Array]'||Y==='[object Uint8ClampedArray]'||Y==='[object Uint16Array]'||Y==='[object Uint32Array]'?s.i(T.a)(G,Z):Y==='[object Map]'?s.i(h.a)(G,Z,X):Y==='[object Number]'||Y==='[object String]'?new Q(G):Y==='[object RegExp]'?s.i(w.a)(G):Y==='[object Set]'?s.i(C.a)(G,Z,X):Y==='[object Symbol]'?s.i(P.a)(G):void 0}},function(o,r,s){'use strict';var u=s(408),f=s(136),h=s(89);r.a=function(w){return'function'!=typeof w.constructor||s.i(h.a)(w)?{}:s.i(u.a)(s.i(f.a)(w))}},function(o,r,s){'use strict';var u=s(143),f=s(11);r.a=function(h){return s.i(f.a)(h)||s.i(u.a)(h)}},function(o,r){'use strict';r.a=function(u){var f=typeof u;return'string'==f||'number'==f||'symbol'==f||'boolean'==f?'__proto__'!==u:null===u}},function(o,r){'use strict';r.a=function(u){for(var h=[],f;!(f=u.next()).done;)h.push(f.value);return h}},function(o,r){'use strict';r.a=function(){this.__data__=[]}},function(o,r,s){'use strict';var u=s(82),f=Array.prototype,h=f.splice;r.a=function(w){var C=this.__data__,P=s.i(u.a)(C,w);if(0>P)return!1;var T=C.length-1;return P==T?C.pop():h.call(C,P,1),!0}},function(o,r,s){'use strict';var u=s(82);r.a=function(f){var h=this.__data__,w=s.i(u.a)(h,f);return 0>w?void 0:h[w][1]}},function(o,r,s){'use strict';var u=s(82);r.a=function(f){return-1<s.i(u.a)(this.__data__,f)}},function(o,r,s){'use strict';var u=s(82);r.a=function(f,h){var w=this.__data__,C=s.i(u.a)(w,f);return 0>C?w.push([f,h]):w[C][1]=h,this}},function(o,r,s){'use strict';var u=s(397),f=s(78),h=s(186);r.a=function(){this.__data__={hash:new u.a,map:new(h.a||f.a),string:new u.a}}},function(o,r,s){'use strict';var u=s(86);r.a=function(f){return s.i(u.a)(this,f)['delete'](f)}},function(o,r,s){'use strict';var u=s(86);r.a=function(f){return s.i(u.a)(this,f).get(f)}},function(o,r,s){'use strict';var u=s(86);r.a=function(f){return s.i(u.a)(this,f).has(f)}},function(o,r,s){'use strict';var u=s(86);r.a=function(f,h){return s.i(u.a)(this,f).set(f,h),this}},function(o,r,s){'use strict';var u=s(123),f=s(35);r.a=function(h,w){return 1==w.length?h:s.i(u.a)(h,s.i(f.a)(w,0,-1))}},function(o,r){'use strict';r.a=function(f){return this.__data__.set(f,'__lodash_hash_undefined__'),this}},function(o,r){'use strict';r.a=function(u){return this.__data__.has(u)}},function(o,r){'use strict';r.a=function(u){var f=-1,h=Array(u.size);return u.forEach(function(w){h[++f]=[w,w]}),h}},function(o,r,s){'use strict';var u=s(78);r.a=function(){this.__data__=new u.a}},function(o,r){'use strict';r.a=function(u){return this.__data__['delete'](u)}},function(o,r){'use strict';r.a=function(u){return this.__data__.get(u)}},function(o,r){'use strict';r.a=function(u){return this.__data__.has(u)}},function(o,r,s){'use strict';var u=s(78),f=s(118);r.a=function(w,C){var P=this.__data__;return P instanceof u.a&&P.__data__.length==200&&(P=this.__data__=new f.a(P.__data__)),P.set(w,C),this}},function(o,r,s){'use strict';var d=s(485),u=s(493),f=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]/g,h=/\\\\(\\\\)?/g,w=s.i(d.a)(function(C){var P=[];return s.i(u.a)(C).replace(f,function(T,E,S,O){P.push(S?O.replace(h,'$1'):E||T)}),P});r.a=w},function(o,r,s){'use strict';var d=s(206),u=s(207),f=s(208),h=s(209),w=s(210),C=s(211),P=s(140),T=s(141),E=s(212),S=s(213),O=s(214),V=s(215),R=s(216),F=s(217),N=s(218),I=s(219),M=s(220),D=s(221),L=s(142),q=s(224),z=s(225),K=s(226),$=s(227),H=s(228),W=s(230),U=s(18),J=s(231),G=s(232),Y=s(233),X=s(146),Z=s(234),Q=s(235),ee=s(236),te=s(237),ae=s(238),ne=s(239),ie=s(240),oe=s(241),re=s(242),se=s(243),le=s(244),de=s(245),ce=s(246),ue=s(247),me=s(248),ge=s(249),pe=s(250),fe=s(251),he=s(252),be=s(254),_e=s(255),ye=s(256),ve=s(257),we=s(258),ke=s(259),xe=s(96),Ce=s(147),Pe=s(260),Te=s(261),Ae=s(262),Ee=s(263),Se=s(264),Oe=s(265),Ve=s(266),Re=s(267);r.a={chunk:d.a,compact:u.a,concat:f.a,difference:h.a,differenceBy:w.a,differenceWith:C.a,drop:P.a,dropRight:T.a,dropRightWhile:E.a,dropWhile:S.a,fill:O.a,findIndex:V.a,findLastIndex:R.a,first:F.a,flatten:N.a,flattenDeep:I.a,flattenDepth:M.a,fromPairs:D.a,head:L.a,indexOf:q.a,initial:z.a,intersection:K.a,intersectionBy:$.a,intersectionWith:H.a,join:W.a,last:U.a,lastIndexOf:J.a,nth:G.a,pull:Y.a,pullAll:X.a,pullAllBy:Z.a,pullAllWith:Q.a,pullAt:ee.a,remove:te.a,reverse:ae.a,slice:ne.a,sortedIndex:ie.a,sortedIndexBy:oe.a,sortedIndexOf:re.a,sortedLastIndex:se.a,sortedLastIndexBy:le.a,sortedLastIndexOf:de.a,sortedUniq:ce.a,sortedUniqBy:ue.a,tail:me.a,take:ge.a,takeRight:pe.a,takeRightWhile:fe.a,takeWhile:he.a,union:be.a,unionBy:_e.a,unionWith:ye.a,uniq:ve.a,uniqBy:we.a,uniqWith:ke.a,unzip:xe.a,unzipWith:Ce.a,without:Pe.a,xor:Te.a,xorBy:Ae.a,xorWith:Ee.a,zip:Se.a,zipObject:Oe.a,zipObjectDeep:Ve.a,zipWith:Re.a}},function(o,r,s){'use strict';var d=s(206),u=s(207),f=s(208),h=s(209),w=s(210),C=s(211),P=s(140),T=s(141),E=s(212),S=s(213),O=s(214),V=s(215),R=s(216),F=s(217),N=s(218),I=s(219),M=s(220),D=s(221),L=s(142),q=s(224),z=s(225),K=s(226),$=s(227),H=s(228),W=s(230),U=s(18),J=s(231),G=s(232),Y=s(233),X=s(146),Z=s(234),Q=s(235),ee=s(236),te=s(237),ae=s(238),ne=s(239),ie=s(240),oe=s(241),re=s(242),se=s(243),le=s(244),de=s(245),ce=s(246),ue=s(247),me=s(248),ge=s(249),pe=s(250),fe=s(251),he=s(252),be=s(254),_e=s(255),ye=s(256),ve=s(257),we=s(258),ke=s(259),xe=s(96),Ce=s(147),Pe=s(260),Te=s(261),Ae=s(262),Ee=s(263),Se=s(264),Oe=s(265),Ve=s(266),Re=s(267),Fe=s(474);s.d(r,'a',function(){return Fe.a})},function(o,r,s){'use strict';var d=s(63),u=s(135),f=s(434),h=s(93),w=s(89),C=s(484),P=Object.prototype,T=P.propertyIsEnumerable,E=!T.call({valueOf:1},'valueOf'),S=s.i(f.a)(function(O,V){if(E||s.i(w.a)(V)||s.i(h.a)(V))return void s.i(u.a)(V,s.i(C.a)(V),O);for(var R in V)s.i(d.a)(O,R,V[R])});r.a=S},function(o,r,s){'use strict';var u=s(191);r.a=function(f,h){return s.i(u.a)(f,!0,!0,h)}},function(o,r){'use strict';r.a=function(u){return function(){return u}}},function(o,r,s){'use strict';var u=s(411),f=s(442);r.a=function(h,w){return null!=h&&s.i(f.a)(h,w,u.a)}},function(o,r,s){'use strict';(function(d){var u=s(478),f=s(30),h={'function':!0,object:!0},w=h[typeof exports]&&exports&&!exports.nodeType?exports:void 0,C=h[typeof d]&&d&&!d.nodeType?d:void 0,P=C&&C.exports===w?w:void 0,T=P?f.a.Buffer:void 0,E=T?function(S){return S instanceof T}:s.i(u.a)(!1);r.a=E}).call(r,s(149)(o))},function(o,r,s){'use strict';var u=s(43),f=s(95);r.a=function(h){return!!h&&1===h.nodeType&&s.i(u.a)(h)&&!s.i(f.a)(h)}},function(o,r,s){'use strict';var u=s(126);r.a=function(f,h){return s.i(u.a)(f,h)}},function(o,r,s){'use strict';var u=s(94),f=s(43),G={};G['[object Float32Array]']=G['[object Float64Array]']=G['[object Int8Array]']=G['[object Int16Array]']=G['[object Int32Array]']=G['[object Uint8Array]']=G['[object Uint8ClampedArray]']=G['[object Uint16Array]']=G['[object Uint32Array]']=!0,G['[object Arguments]']=G['[object Array]']=G['[object ArrayBuffer]']=G['[object Boolean]']=G['[object DataView]']=G['[object Date]']=G['[object Error]']=G['[object Function]']=G['[object Map]']=G['[object Number]']=G['[object Object]']=G['[object RegExp]']=G['[object Set]']=G['[object String]']=G['[object WeakMap]']=!1;var Y=Object.prototype,X=Y.toString;r.a=function(Z){return s.i(f.a)(Z)&&s.i(u.a)(Z.length)&&!!G[X.call(Z)]}},function(o,r,s){'use strict';var u=s(416),f=s(201),h=s(36),w=s(89),C=Object.prototype,P=C.hasOwnProperty;r.a=function(T){for(var E=-1,S=s.i(w.a)(T),O=s.i(u.a)(T),V=O.length,R=s.i(f.a)(T),N=R||[],I=N.length,M;++E<V;)M=O[E],!!R&&('length'==M||s.i(h.a)(M,I))||'constructor'==M&&(S||!P.call(T,M))||N.push(M);return N}},function(o,r,s){'use strict';function d(h,w){if('function'!=typeof h||w&&'function'!=typeof w)throw new TypeError(f);var C=function(){var P=arguments,T=w?w.apply(this,P):P[0],E=C.cache;if(E.has(T))return E.get(T);var S=h.apply(this,P);return C.cache=E.set(T,S),S};return C.cache=new(d.Cache||u.a),C}var u=s(118),f='Expected a function';d.Cache=u.a,r.a=d},function(o,r){'use strict';r.a=function(){}},function(o,r){'use strict';var d=Date.now;r.a=d},function(o,r,s){'use strict';var u=s(127),f=s(420),h=s(51),w=s(52);r.a=function(C){return s.i(h.a)(C)?s.i(u.a)(s.i(w.a)(C)):s.i(f.a)(C)}},function(o,r,s){'use strict';var u=s(139),f=s(14);r.a=function(w,C,P){var T=!0,E=!0;if('function'!=typeof w)throw new TypeError('Expected a function');return s.i(f.a)(P)&&(T='leading'in P?!!P.leading:T,E='trailing'in P?!!P.trailing:E),s.i(u.a)(w,C,{leading:T,maxWait:C,trailing:E})}},function(o,r,s){'use strict';var u=s(253),f=1/0;r.a=function(w){if(!w)return 0===w?w:0;if(w=s.i(u.a)(w),w===f||w===-f){var C=0>w?-1:1;return C*1.7976931348623157e308}return w===w?w:0}},function(o,r,s){'use strict';var u=s(407),f=s(15);r.a=function(w){return w?s.i(u.a)(s.i(f.a)(w),0,4294967295):0}},function(o,r,s){'use strict';var d=s(436),u=s(65),f=s.i(d.a)(u.a);r.a=f},function(o,r,s){'use strict';var u=s(423);r.a=function(f){return null==f?'':s.i(u.a)(f)}},function(o,r,s){'use strict';var d=s(498);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=class{constructor(f){this.lang=f||'en',this.t=(...h)=>this._t(...h)}_t(f,h){let w=s.i(d.a)(this.lang,f);return h&&(w=w.replace(/\\%(\\d+)/g,(C,P)=>{return P<h.length?h[P]:C})),w}}},function(o,r){'use strict';r.a=/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */function(u,f){if(u.size!=f.size)return!1;for(let h of u.entries()){let w=JSON.stringify(h[1]),C=JSON.stringify(f.get(h[0]));if(w!==C)return!1}return!0}},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */const d={get(u){return'number'==typeof u?u:this[u]||this.normal},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};r.a=d},function(o,r){'use strict';/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */r.a=function(){return function u(){u.called=!0}}},function(o,r){'use strict';function f(C,P){return C in w&&P in w[C]}r.a=function(C,P){return f(C,P)?w[C][P]:P.replace(/ \\[context: [^\\]]+\\]$/,'')};/**\n * @license Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */let w={}},function(o,r,s){'use strict';Object.defineProperty(r,'__esModule',{value:!0});var d=s(270),u=s(271);/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md.\n */class f extends d.a{}r['default']=f,f.build={plugins:[u.a],config:{toolbar:['image','headings']}}}])});\n\n\n// WEBPACK FOOTER //\n// ckeditor.es6.js"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourceRoot":""}